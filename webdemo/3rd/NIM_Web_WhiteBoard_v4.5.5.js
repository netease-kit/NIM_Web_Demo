!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.WhiteBoard=t():e.WhiteBoard=t()}(this,function(){return function(e){function t(i){if(n[i])return n[i].exports;var o=n[i]={exports:{},id:i,loaded:!1};return e[i].call(o.exports,o,o.exports,t),o.loaded=!0,o.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}({0:function(e,t,n){"use strict";var i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},o=n(85),r=n(192),s=n(205),a=n(209),c=n(206),u=n(172),l=n(179),p=i({},o.constantBB,{install:function(e,t){r.install(e,t),s.install(e,t),e.parser.mixin({configMap:c,serializeMap:u,unserializeMap:l})},getInstance:function(e){return new a(e)},destroy:function(e){e&&(e.destroy(),e=null)}});e.exports=p},1:function(e,t,n){"use strict";var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=n(9),r=n(19),s=n(28),a=n(22);n(44);var c=n(4),u=n(17),l=u.getGlobal(),p=/\s+/;u.shouldDisplayInstallFlashHint=function(){var e=o.name.toLowerCase();if("ie"===e){var t=+o.version||0;return t=Math.floor(t),7===t&&!r.Transport.flashsocket.check()}return!1},u.deduplicate=function(e){var t=[];return e.forEach(function(e){t.indexOf(e)===-1&&t.push(e)}),t},u.capFirstLetter=function(e){return e?(e=""+e,e.slice(0,1).toUpperCase()+e.slice(1)):""},u.guid=function(){var e=function(){return(65536*(1+Math.random())|0).toString(16).substring(1)};return function(){return e()+e()+e()+e()+e()+e()+e()+e()}}(),u.extend=function(e,t,n){for(var i in t)"undefined"!=typeof e[i]&&n!==!0||(e[i]=t[i])},u.filterObj=function(e,t){var n={};return u.isString(t)&&(t=t.split(p)),t.forEach(function(t){e.hasOwnProperty(t)&&(n[t]=e[t])}),n},u.simpleClone=function(e){return JSON.parse(JSON.stringify(e))},u.copy=function(e,t){return t=t||{},e?(Object.keys(e).forEach(function(n){u.exist(e[n])&&(t[n]=e[n])}),t):t},u.copyWithNull=function(e,t){return t=t||{},e?(Object.keys(e).forEach(function(n){(u.exist(e[n])||u.isnull(e[n]))&&(t[n]=e[n])}),t):t},u.findObjIndexInArray=function(e,t){e=e||[];var n=t.keyPath||"id",i=-1;return e.some(function(e,o){if(a(e,n)===t.value)return i=o,!0}),i},u.findObjInArray=function(e,t){var n=u.findObjIndexInArray(e,t);return n===-1?null:e[n]},u.mergeObjArray=function(){var e=[],t=[].slice.call(arguments,0,-1),n=arguments[arguments.length-1];u.isArray(n)&&(t.push(n),n={});var i=n.keyPath=n.keyPath||"id";for(n.sortPath=n.sortPath||i;!e.length&&t.length;)e=t.shift()||[],e=e.slice(0);var o;return t.forEach(function(t){t&&t.forEach(function(t){o=u.findObjIndexInArray(e,{keyPath:i,value:a(t,i)}),o!==-1?e[o]=u.merge({},e[o],t):e.push(t)})}),n.notSort||(e=u.sortObjArray(e,n)),e},u.cutObjArray=function(e){var t=e.slice(0),n=arguments.length,i=[].slice.call(arguments,1,n-1),o=arguments[n-1];u.isObject(o)||(i.push(o),o={});var r,s=o.keyPath=o.keyPath||"id";return i.forEach(function(e){u.isArray(e)||(e=[e]),e.forEach(function(e){e&&(o.value=a(e,s),r=u.findObjIndexInArray(t,o),r!==-1&&t.splice(r,1))})}),t},u.sortObjArray=function(e,t){t=t||{};var n=t.sortPath||"id";s.insensitive=!!t.insensitive;var i,o,r,c=!!t.desc;return r=u.isFunction(t.compare)?t.compare:function(e,t){return i=a(e,n),o=a(t,n),c?s(o,i):s(i,o)},e.sort(r)},u.emptyFunc=function(){},u.isEmptyFunc=function(e){return e===u.emptyFunc},u.notEmptyFunc=function(e){return e!==u.emptyFunc},u.splice=function(e,t,n){return[].splice.call(e,t,n)},u.reshape2d=function(e,t){if(Array.isArray(e)){u.verifyParamType("type",t,"number");var n=e.length;if(n<=t)return[e];for(var i=Math.ceil(n/t),o=[],r=0;r<i;r++)o.push(e.slice(r*t,(r+1)*t));return o}return e},u.flatten2d=function(e){if(Array.isArray(e)){var t=function(){var t=[];return e.forEach(function(e){t=t.concat(e)}),{v:t}}();if("object"===("undefined"==typeof t?"undefined":i(t)))return t.v}return e},u.dropArrayDuplicates=function(e){if(Array.isArray(e)){for(var t={},n=[];e.length>0;){var i=e.shift();t[i]=!0}for(var o in t)t[o]===!0&&n.push(o);return n}return e},u.onError=function(e){throw new c(e)},u.verifyParamPresent=function(e,t,n){n=n||"";var i=!1;switch(u.typeOf(t)){case"undefined":case"null":i=!0;break;case"string":""===t&&(i=!0);break;case"object":Object.keys(t).length||(i=!0);break;case"array":t.length?t.some(function(e){if(u.notexist(e))return i=!0,!0}):i=!0}i&&u.onParamAbsent(n+e)},u.onParamAbsent=function(e){u.onParamError('缺少参数"'+e+'", 请确保参数不是 空字符串、空对象、空数组、null或undefined, 或者数组的内容不是 null/undefined')},u.verifyParamAbsent=function(e,t,n){n=n||"",void 0!==t&&u.onParamPresent(n+e)},u.onParamPresent=function(e){u.onParamError('多余的参数"'+e+'"')},u.verifyParamType=function(e,t,n){var i=u.typeOf(t).toLowerCase();u.isArray(n)||(n=[n]),n=n.map(function(e){return e.toLowerCase()});var o=!0;switch(n.indexOf(i)===-1&&(o=!1),i){case"number":isNaN(t)&&(o=!1)}o||u.onParamInvalidType(e,n)},u.onParamInvalidType=function(e,t,n){n=n||"",u.isArray(t)?(t=t.map(function(e){return'"'+e+'"'}),t=t.join(", ")):t='"'+t+'"',u.onParamError('参数"'+n+e+'"类型错误, 合法的类型包括: ['+t+"]")},u.verifyParamValid=function(e,t,n){u.isArray(n)||(n=[n]),n.indexOf(t)===-1&&u.onParamInvalidValue(e,n)},u.onParamInvalidValue=function(e,t){u.isArray(t)||(t=[t]),t=t.map(function(e){return'"'+e+'"'}),u.isArray(t)&&(t=t.join(", ")),u.onParamError('参数"'+e+'"值错误, 合法的值包括: ['+t+"]")},u.verifyParamMin=function(e,t,n){t<n&&u.onParamError("参数"+e+"的值不能小于"+n)},u.verifyParamMax=function(e,t,n){t>n&&u.onParamError("参数"+e+"的值不能大于"+n)},u.verifyArrayMax=function(e,t,n){t.length>n&&u.onParamError("参数"+e+"的长度不能大于"+n)},u.verifyEmail=function(){var e=/^\S+@\S+$/;return function(t,n){e.test(n)||u.onParamError("参数"+t+"邮箱格式错误, 合法格式必须包含@符号, @符号前后至少要各有一个字符")}}(),u.verifyTel=function(){var e=/^[+\-()\d]+$/;return function(t,n){e.test(n)||u.onParamError("参数"+t+"电话号码格式错误, 合法字符包括+、-、英文括号和数字")}}(),u.verifyBirth=function(){var e=/^(\d{4})-(0[1-9]|1[012])-(0[1-9]|[12][0-9]|3[01])$/;return function(t,n){e.test(n)||u.onParamError("参数"+t+'生日格式错误, 合法为"yyyy-MM-dd"')}}(),u.onParamError=function(e){u.onError(e)},u.verifyOptions=function(e,t,n,i){if(e=e||{},t&&(u.isString(t)&&(t=t.split(p)),u.isArray(t))){n=void 0===n||!!n;var o=n?u.verifyParamPresent:u.verifyParamAbsent;t.forEach(function(t){o.call(u,t,e[t],i)})}return e},u.verifyParamAtLeastPresentOne=function(e,t){if(t&&(u.isString(t)&&(t=t.split(p)),u.isArray(t))){var n=t.some(function(t){return u.exist(e[t])});n||u.onParamError("以下参数["+t.join(", ")+"]至少需要传入一个")}},u.verifyParamPresentJustOne=function(e,t){if(t&&(u.isString(t)&&(t=t.split(p)),u.isArray(t))){var n=t.reduce(function(t,n){return u.exist(e[n])&&t++,t},0);1!==n&&u.onParamError("以下参数["+t.join(", ")+"]必须且只能传入一个")}},u.verifyBooleanWithDefault=function(e,t,n,i){u.undef(n)&&(n=!0),p.test(t)&&(t=t.split(p)),u.isArray(t)?t.forEach(function(t){u.verifyBooleanWithDefault(e,t,n,i)}):"undefined"==typeof e[t]?e[t]=n:u.isBoolean(e[t])||u.onParamInvalidType(t,"boolean",i)},u.verifyFileInput=function(e){return u.verifyParamPresent("fileInput",e),u.isString(e)&&(e=document.getElementById(e),e||u.onParamError("找不到要上传的文件对应的input, 请检查fileInput id")),e.tagName&&"input"===e.tagName.toLowerCase()&&"file"===e.type.toLowerCase()||u.onParamError("请提供正确的 fileInput, 必须为 file 类型的 input 节点"),e},u.verifyFileType=function(e){u.verifyParamValid("type",e,u.validFileTypes)},u.verifyCallback=function(e,t){p.test(t)&&(t=t.split(p)),u.isArray(t)?t.forEach(function(t){u.verifyCallback(e,t)}):e[t]?u.isFunction(e[t])||u.onParamInvalidType(t,"function"):e[t]=u.emptyFunc},u.verifyFileUploadCallback=function(e){u.verifyCallback(e,"uploadprogress uploaddone uploaderror uploadcancel")},u.validFileTypes=["image","audio","video","file"],u.validFileExts={image:["bmp","gif","jpg","jpeg","jng","png","webp"],audio:["mp3","wav","aac","wma","wmv","amr","mp2","flac","vorbis","ac3"],video:["mp4","rm","rmvb","wmv","avi","mpg","mpeg"]},u.filterFiles=function(e,t){t=t.toLowerCase();var n,i,o,r="file"===t,s=[];return[].forEach.call(e,function(e){if(r)s.push(e);else if(n=e.name.slice(e.name.lastIndexOf(".")+1),i=e.type.split("/"),i[0]&&i[1]){o=i[0].toLowerCase();var a=!1;a=o===t||u.validFileExts[t].indexOf(n)!==-1,a&&s.push(e)}}),s};var f=u.supportFormData=u.notundef(l.FormData);u.getFileName=function(){return function(e){return e=u.verifyFileInput(e),f?e.files[0].name:e.value.slice(e.value.lastIndexOf("\\")+1)}}(),u.sizeText=function(){var e=["B","KB","MB","GB","TB","PB","EB","ZB","BB"];return function(t){var n,i=0;do{t=Math.floor(100*t)/100;var o=e[i];n=t+o,t/=1024,i++}while(t>1);return n}}(),u.promises2cmds=function(e){return e.map(function(e){return e.cmd})},u.objs2accounts=function(e){return e.map(function(e){return e.account})},u.teams2ids=function(e){return e.map(function(e){return e.teamId})},u.objs2ids=function(e){return e.map(function(e){return e.id})},u.getMaxUpdateTime=function(e){var t=e.map(function(e){return+e.updateTime});return Math.max.apply(Math,t)},u.genCheckUniqueFunc=function(e,t){var n=[],i={};return e=e||"id",t=t||1e3,function(o){var r;return n.length>=t&&(r=n.shift(),delete i[r]),r=a(o,e),!i[r]&&(i[r]=!0,n.push(r),!0)}},e.exports=u,n(45)},2:function(e,t,n){(function(t,i){/*!
	 * @overview es6-promise - a tiny implementation of Promises/A+.
	 * @copyright Copyright (c) 2014 Yehuda Katz, Tom Dale, Stefan Penner and contributors (Conversion to ES6 API by Jake Archibald)
	 * @license   Licensed under MIT license
	 *            See https://raw.githubusercontent.com/stefanpenner/es6-promise/master/LICENSE
	 * @version   4.0.5
	 */
!function(t,n){e.exports=n()}(this,function(){"use strict";function e(e){return"function"==typeof e||"object"==typeof e&&null!==e}function o(e){return"function"==typeof e}function r(e){X=e}function s(e){z=e}function a(){return function(){return t.nextTick(f)}}function c(){return"undefined"!=typeof K?function(){K(f)}:p()}function u(){var e=0,t=new Z(f),n=document.createTextNode("");return t.observe(n,{characterData:!0}),function(){n.data=e=++e%2}}function l(){var e=new MessageChannel;return e.port1.onmessage=f,function(){return e.port2.postMessage(0)}}function p(){var e=setTimeout;return function(){return e(f,1)}}function f(){for(var e=0;e<J;e+=2){var t=ne[e],n=ne[e+1];t(n),ne[e]=void 0,ne[e+1]=void 0}J=0}function h(){try{var e=n(47);return K=e.runOnLoop||e.runOnContext,c()}catch(e){return p()}}function d(e,t){var n=arguments,i=this,o=new this.constructor(m);void 0===o[oe]&&R(o);var r=i._state;return r?!function(){var e=n[r-1];z(function(){return D(r,o,e,i._result)})}():k(i,o,e,t),o}function v(e){var t=this;if(e&&"object"==typeof e&&e.constructor===t)return e;var n=new t(m);return T(n,e),n}function m(){}function y(){return new TypeError("You cannot resolve a promise with itself")}function g(){return new TypeError("A promises callback cannot return that same promise.")}function b(e){try{return e.then}catch(error){return ce.error=error,ce}}function _(e,t,n,i){try{e.call(t,n,i)}catch(e){return e}}function w(e,t,n){z(function(e){var i=!1,o=_(n,t,function(n){i||(i=!0,t!==n?T(e,n):x(e,n))},function(t){i||(i=!0,I(e,t))},"Settle: "+(e._label||" unknown promise"));!i&&o&&(i=!0,I(e,o))},e)}function C(e,t){t._state===se?x(e,t._result):t._state===ae?I(e,t._result):k(t,void 0,function(t){return T(e,t)},function(t){return I(e,t)})}function S(e,t,n){t.constructor===e.constructor&&n===d&&t.constructor.resolve===v?C(e,t):n===ce?I(e,ce.error):void 0===n?x(e,t):o(n)?w(e,t,n):x(e,t)}function T(t,n){t===n?I(t,y()):e(n)?S(t,n,b(n)):x(t,n)}function E(e){e._onerror&&e._onerror(e._result),O(e)}function x(e,t){e._state===re&&(e._result=t,e._state=se,0!==e._subscribers.length&&z(O,e))}function I(e,t){e._state===re&&(e._state=ae,e._result=t,z(E,e))}function k(e,t,n,i){var o=e._subscribers,r=o.length;e._onerror=null,o[r]=t,o[r+se]=n,o[r+ae]=i,0===r&&e._state&&z(O,e)}function O(e){var t=e._subscribers,n=e._state;if(0!==t.length){for(var i=void 0,o=void 0,r=e._result,s=0;s<t.length;s+=3)i=t[s],o=t[s+n],i?D(n,i,o,r):o(r);e._subscribers.length=0}}function A(){this.error=null}function M(e,t){try{return e(t)}catch(e){return ue.error=e,ue}}function D(e,t,n,i){var r=o(n),s=void 0,a=void 0,c=void 0,u=void 0;if(r){if(s=M(n,i),s===ue?(u=!0,a=s.error,s=null):c=!0,t===s)return void I(t,g())}else s=i,c=!0;t._state!==re||(r&&c?T(t,s):u?I(t,a):e===se?x(t,s):e===ae&&I(t,s))}function N(e,t){try{t(function(t){T(e,t)},function(t){I(e,t)})}catch(e){I(e,e)}}function P(){return le++}function R(e){e[oe]=le++,e._state=void 0,e._result=void 0,e._subscribers=[]}function U(e,t){this._instanceConstructor=e,this.promise=new e(m),this.promise[oe]||R(this.promise),Y(t)?(this._input=t,this.length=t.length,this._remaining=t.length,this._result=new Array(this.length),0===this.length?x(this.promise,this._result):(this.length=this.length||0,this._enumerate(),0===this._remaining&&x(this.promise,this._result))):I(this.promise,L())}function L(){return new Error("Array Methods must be provided an Array")}function W(e){return new U(this,e).promise}function j(e){var t=this;return new t(Y(e)?function(n,i){for(var o=e.length,r=0;r<o;r++)t.resolve(e[r]).then(n,i)}:function(e,t){return t(new TypeError("You must pass an array to race."))})}function B(e){var t=this,n=new t(m);return I(n,e),n}function F(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}function H(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}function V(e){this[oe]=P(),this._result=this._state=void 0,this._subscribers=[],m!==e&&("function"!=typeof e&&F(),this instanceof V?N(this,e):H())}function $(){var e=void 0;if("undefined"!=typeof i)e=i;else if("undefined"!=typeof self)e=self;else try{e=Function("return this")()}catch(e){throw new Error("polyfill failed because global object is unavailable in this environment")}var t=e.Promise;if(t){var n=null;try{n=Object.prototype.toString.call(t.resolve())}catch(e){}if("[object Promise]"===n&&!t.cast)return}e.Promise=V}var q=void 0;q=Array.isArray?Array.isArray:function(e){return"[object Array]"===Object.prototype.toString.call(e)};var Y=q,J=0,K=void 0,X=void 0,z=function(e,t){ne[J]=e,ne[J+1]=t,J+=2,2===J&&(X?X(f):ie())},G="undefined"!=typeof window?window:void 0,Q=G||{},Z=Q.MutationObserver||Q.WebKitMutationObserver,ee="undefined"==typeof self&&"undefined"!=typeof t&&"[object process]"==={}.toString.call(t),te="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel,ne=new Array(1e3),ie=void 0;ie=ee?a():Z?u():te?l():void 0===G?h():p();var oe=Math.random().toString(36).substring(16),re=void 0,se=1,ae=2,ce=new A,ue=new A,le=0;return U.prototype._enumerate=function(){for(var e=this.length,t=this._input,n=0;this._state===re&&n<e;n++)this._eachEntry(t[n],n)},U.prototype._eachEntry=function(e,t){var n=this._instanceConstructor,i=n.resolve;if(i===v){var o=b(e);if(o===d&&e._state!==re)this._settledAt(e._state,t,e._result);else if("function"!=typeof o)this._remaining--,this._result[t]=e;else if(n===V){var r=new n(m);S(r,e,o),this._willSettleAt(r,t)}else this._willSettleAt(new n(function(t){return t(e)}),t)}else this._willSettleAt(i(e),t)},U.prototype._settledAt=function(e,t,n){var i=this.promise;i._state===re&&(this._remaining--,e===ae?I(i,n):this._result[t]=n),0===this._remaining&&x(i,this._result)},U.prototype._willSettleAt=function(e,t){var n=this;k(e,void 0,function(e){return n._settledAt(se,t,e)},function(e){return n._settledAt(ae,t,e)})},V.all=W,V.race=j,V.resolve=v,V.reject=B,V._setScheduler=r,V._setAsap=s,V._asap=z,V.prototype={constructor:V,then:d,"catch":function(e){return this.then(null,e)}},V.polyfill=$,V.Promise=V,V})}).call(t,n(7),function(){return this}())},3:function(e,t,n){(function(t){"use strict";var n="'b57b9cf99bd46cbc86add4729cf3f5c179fd3968",i="b57b9cf'",o="4.5.5",r="2.2.0.1013",s="3.5.0",a="40",c=1,u="https://lbs.netease.im/lbs/webconf.jsp",l="development"===t.env.NODE_ENV?6e3:42e3,p={info:{hash:n,shortHash:i,version:o,sdkVersion:a,nrtcVersion:s,protocolVersion:c},agentVersion:r,lbsUrl:u,connectTimeout:l,xhrTimeout:l,socketTimeout:l,reconnectionDelay:656.25,reconnectionDelayMax:l,reconnectionJitter:.1,heartbeatInterval:18e4,cmdTimeout:l};p.formatSocketUrl=function(e){var t=e.url,n=e.secure,i=n?"https":"http";return t.indexOf("http")===-1?i+"://"+t:t},p.fileServerUrl="https://nos.netease.com",p.replaceUrl="http://nos.netease.im",p.genUploadUrl=function(e){return p.uploadUrl?p.uploadUrl+"/"+e:p.fileServerUrl+"/"+e},p.genDownloadUrl=function(e,t){return p.downloadUrl?p.replaceUrl+"/"+e+"/"+t:p.fileServerUrl+"/"+e+"/"+t},e.exports=p}).call(t,n(7))},4:function(e,t){"use strict";function n(e,t){var n=this;n.message=e,n.code=t,n.time=new Date,n.timetag=+n.time}n.prototype=Object.create(Error.prototype),n.prototype.name="NIMError",n.prototype.appendMessage=function(e){var t=this;t.message?e&&(t.message+="("+e+")"):t.message=e};var i={201:"客户端版本不对, 需升级sdk",302:"用户名或密码错误, 请检查appKey和token是否有效, account和token是否匹配",403:"非法操作或没有权限",404:"对象(用户/群/聊天室)不存在",405:"参数长度过长",408:"客户端请求超时",414:"参数错误",415:"服务不可用/没有聊天室服务器可分配",416:"频率控制",417:"重复操作",422:"帐号被禁用",500:"服务器内部错误",501:"数据库操作失败",503:"服务器繁忙",508:"删除有效期过了",509:"已失效",7101:"被拉黑",801:"群人数达到上限",802:"没有权限",803:"群不存在或未发生变化",804:"用户不在群里面",805:"群类型不匹配",806:"创建群数量达到限制",807:"群成员状态不对",809:"已经在群里",813:"因群数量限制，部分拉人成功",997:"协议已失效",998:"解包错误",999:"打包错误",9102:"通道失效",9103:"已经在其他端接听/拒绝过这通电话",11001:"对方离线, 通话不可送达",13002:"聊天室状态异常",13003:"在黑名单中",13004:"在禁言名单中",13006:"聊天室处于整体禁言状态,只有管理员能发言",Connect_Failed:"无法建立连接, 请确保能 ping/telnet 到云信服务器; 如果是IE8/9, 请确保项目部署在 HTTPS 环境下",Error_Internet_Disconnected:"网断了",Error_Connection_is_not_Established:"连接未建立",Error_Connection_Socket_State_not_Match:"socket状态不对",Error_Timeout:"超时",Param_Error:"参数错误",No_File_Selected:"请选择文件",Wrong_File_Type:"文件类型错误",File_Too_Large:"文件过大",Cross_Origin_Iframe:"不能获取跨域Iframe的内容",Not_Support:"不支持",NO_DB:"无数据库",DB:"数据库错误",Still_In_Team:"还在群里",Session_Exist:"会话已存在",Session_Not_Exist:"会话不存在",Error_Unknown:"未知错误",Operation_Canceled:"操作取消"};[200,406,808,810].forEach(function(e){i[e]=null}),n.genError=function(e){var t=i[e];return void 0===t&&(t="操作失败"),null===t?null:new n(t,e)},n.multiInstance=function(){return new n("不允许初始化多个实例","Not_Allow_Multi_Instance")},n.newNetworkError=function(){var e="Error_Internet_Disconnected";return new n(i[e],e)},n.newConnectError=function(e){var t="Connect_Failed";return new n(i[t]||e,t)},n.newConnectionError=function(){var e="Error_Connection_is_not_Established";return new n(i[e],e)},n.newSocketStateError=function(){var e="Error_Connection_Socket_State_not_Match";return new n(i[e],e)},n.newTimeoutError=function(){var e="Error_Timeout";return new n(i[e],e)},n.newFrequencyControlError=function(){var e=416,t=new n(i[e],e);return t.from="local",t},n.newParamError=function(e){var t="Param_Error";return new n(e||i[t],t)},n.newNoFileError=function(e){var t="No_File_Selected";return new n(e||i[t],t)},n.newWrongFileTypeError=function(e){var t="Wrong_File_Type";return new n(e||i[t],t)},n.newFileTooLargeError=function(e){var t="File_Too_Large";return new n(e||i[t],t)},n.newCORSIframeError=function(){var e="Cross_Origin_Iframe";return new n(i[e],e)},n.newSupportError=function(e,t){return new n("不支持"+e,"Not_Support_"+t)},n.newSupportDBError=function(){return n.newSupportError("数据库","DB")},n.noDBError=function(){var e="NO_DB";return new n(i[e],e)},n.newDBError=function(){var e="DB";return new n(i[e],e)},n.newUnknownError=function(){var e="Error_Unknown";return new n(i[e],e)},n.stillInTeamError=function(){var e="Still_In_Team";return new n(i[e],e)},n.sessionExist=function(){var e="Session_Exist";return new n(i[e],e)},n.sessionNotExist=function(){var e="Session_Not_Exist";return new n(i[e],e)},n.cancel=function(){var e="Operation_Canceled";return new n(i[e],e)},n.customError=function(e,t){return t=t||"Other_Error",new n(e,t)},e.exports=n},7:function(e,t){function n(){throw new Error("setTimeout has not been defined")}function i(){throw new Error("clearTimeout has not been defined")}function o(e){if(l===setTimeout)return setTimeout(e,0);if((l===n||!l)&&setTimeout)return l=setTimeout,setTimeout(e,0);try{return l(e,0)}catch(e){try{return l.call(null,e,0)}catch(e){return l.call(this,e,0)}}}function r(e){if(p===clearTimeout)return clearTimeout(e);if((p===i||!p)&&clearTimeout)return p=clearTimeout,clearTimeout(e);try{return p(e)}catch(e){try{return p.call(null,e)}catch(e){return p.call(this,e)}}}function s(){v&&h&&(v=!1,h.length?d=h.concat(d):m=-1,d.length&&a())}function a(){if(!v){var e=o(s);v=!0;for(var t=d.length;t;){for(h=d,d=[];++m<t;)h&&h[m].run();m=-1,t=d.length}h=null,v=!1,r(e)}}function c(e,t){this.fun=e,this.array=t}function u(){}var l,p,f=e.exports={};!function(){try{l="function"==typeof setTimeout?setTimeout:n}catch(e){l=n}try{p="function"==typeof clearTimeout?clearTimeout:i}catch(e){p=i}}();var h,d=[],v=!1,m=-1;f.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];d.push(new c(e,t)),1!==d.length||v||o(a)},c.prototype.run=function(){this.fun.apply(null,this.array)},f.title="browser",f.browser=!0,f.env={},f.argv=[],f.version="",f.versions={},f.on=u,f.addListener=u,f.once=u,f.off=u,f.removeListener=u,f.removeAllListeners=u,f.emit=u,f.binding=function(e){throw new Error("process.binding is not supported")},f.cwd=function(){return"/"},f.chdir=function(e){throw new Error("process.chdir is not supported")},f.umask=function(){return 0}},8:function(e,t,n){"use strict";function i(){}function o(e,t,n){this.fn=e,this.context=t,this.once=n||!1}function r(){this._events=new i,this._eventsCount=0}var s=Object.prototype.hasOwnProperty,a="~";Object.create&&(i.prototype=Object.create(null),(new i).__proto__||(a=!1)),r.prototype.eventNames=function(){var e,t,n=[];if(0===this._eventsCount)return n;for(t in e=this._events)s.call(e,t)&&n.push(a?t.slice(1):t);return Object.getOwnPropertySymbols?n.concat(Object.getOwnPropertySymbols(e)):n},r.prototype.listeners=function(e,t){var n=a?a+e:e,i=this._events[n];if(t)return!!i;if(!i)return[];if(i.fn)return[i.fn];for(var o=0,r=i.length,s=new Array(r);o<r;o++)s[o]=i[o].fn;return s},r.prototype.emit=function(e,t,n,i,o,r){var s=a?a+e:e;if(!this._events[s])return!1;var c,u,l=this._events[s],p=arguments.length;if(l.fn){switch(l.once&&this.removeListener(e,l.fn,void 0,!0),p){case 1:return l.fn.call(l.context),!0;case 2:return l.fn.call(l.context,t),!0;case 3:return l.fn.call(l.context,t,n),!0;case 4:return l.fn.call(l.context,t,n,i),!0;case 5:return l.fn.call(l.context,t,n,i,o),!0;case 6:return l.fn.call(l.context,t,n,i,o,r),!0}for(u=1,c=new Array(p-1);u<p;u++)c[u-1]=arguments[u];l.fn.apply(l.context,c)}else{var f,h=l.length;for(u=0;u<h;u++)switch(l[u].once&&this.removeListener(e,l[u].fn,void 0,!0),p){case 1:l[u].fn.call(l[u].context);break;case 2:l[u].fn.call(l[u].context,t);break;case 3:l[u].fn.call(l[u].context,t,n);break;case 4:l[u].fn.call(l[u].context,t,n,i);break;default:if(!c)for(f=1,c=new Array(p-1);f<p;f++)c[f-1]=arguments[f];l[u].fn.apply(l[u].context,c)}}return!0},r.prototype.on=function(e,t,n){var i=new o(t,n||this),r=a?a+e:e;return this._events[r]?this._events[r].fn?this._events[r]=[this._events[r],i]:this._events[r].push(i):(this._events[r]=i,this._eventsCount++),this},r.prototype.once=function(e,t,n){var i=new o(t,n||this,!0),r=a?a+e:e;return this._events[r]?this._events[r].fn?this._events[r]=[this._events[r],i]:this._events[r].push(i):(this._events[r]=i,this._eventsCount++),this},r.prototype.removeListener=function(e,t,n,o){var r=a?a+e:e;if(!this._events[r])return this;if(!t)return 0===--this._eventsCount?this._events=new i:delete this._events[r],this;var s=this._events[r];if(s.fn)s.fn!==t||o&&!s.once||n&&s.context!==n||(0===--this._eventsCount?this._events=new i:delete this._events[r]);else{for(var c=0,u=[],l=s.length;c<l;c++)(s[c].fn!==t||o&&!s[c].once||n&&s[c].context!==n)&&u.push(s[c]);u.length?this._events[r]=1===u.length?u[0]:u:0===--this._eventsCount?this._events=new i:delete this._events[r]}return this},r.prototype.removeAllListeners=function(e){var t;return e?(t=a?a+e:e,this._events[t]&&(0===--this._eventsCount?this._events=new i:delete this._events[t])):(this._events=new i,this._eventsCount=0),this},r.prototype.off=r.prototype.removeListener,r.prototype.addListener=r.prototype.on,r.prototype.setMaxListeners=function(){return this},r.prefixed=a,r.EventEmitter=r,e.exports=r},9:function(e,t,n){var i;(function(e,o){(function(){"use strict";function r(e){return e=String(e),e.charAt(0).toUpperCase()+e.slice(1)}function s(e,t,n){var i={"10.0":"10",6.4:"10 Technical Preview",6.3:"8.1",6.2:"8",6.1:"Server 2008 R2 / 7","6.0":"Server 2008 / Vista",5.2:"Server 2003 / XP 64-bit",5.1:"XP",5.01:"2000 SP1","5.0":"2000","4.0":"NT","4.90":"ME"};return t&&n&&/^Win/i.test(e)&&!/^Windows Phone /i.test(e)&&(i=i[/[\d.]+$/.exec(e)])&&(e="Windows "+i),e=String(e),t&&n&&(e=e.replace(RegExp(t,"i"),n)),e=c(e.replace(/ ce$/i," CE").replace(/\bhpw/i,"web").replace(/\bMacintosh\b/,"Mac OS").replace(/_PowerPC\b/i," OS").replace(/\b(OS X) [^ \d]+/i,"$1").replace(/\bMac (OS X)\b/,"$1").replace(/\/(\d)/," $1").replace(/_/g,".").replace(/(?: BePC|[ .]*fc[ \d.]+)$/i,"").replace(/\bx86\.64\b/gi,"x86_64").replace(/\b(Windows Phone) OS\b/,"$1").replace(/\b(Chrome OS \w+) [\d.]+\b/,"$1").split(" on ")[0])}function a(e,t){var n=-1,i=e?e.length:0;if("number"==typeof i&&i>-1&&i<=C)for(;++n<i;)t(e[n],n,e);else u(e,t)}function c(e){return e=d(e),/^(?:webOS|i(?:OS|P))/.test(e)?e:r(e)}function u(e,t){for(var n in e)x.call(e,n)&&t(e[n],n,e)}function l(e){return null==e?r(e):I.call(e).slice(8,-1)}function p(e,t){var n=null!=e?typeof e[t]:"number";return!(/^(?:boolean|number|string|undefined)$/.test(n)||"object"==n&&!e[t])}function f(e){return String(e).replace(/([ -])(?!$)/g,"$1?")}function h(e,t){var n=null;return a(e,function(i,o){n=t(n,i,o,e)}),n}function d(e){return String(e).replace(/^ +| +$/g,"")}function v(e){function t(t){return h(t,function(t,n){return t||RegExp("\\b"+(n.pattern||f(n))+"\\b","i").exec(e)&&(n.label||n)})}function n(t){return h(t,function(t,n,i){return t||(n[X]||n[/^[a-z]+(?: +[a-z]+\b)*/i.exec(X)]||RegExp("\\b"+f(i)+"(?:\\b|\\w*\\d)","i").exec(e))&&i})}function i(t){return h(t,function(t,n){return t||RegExp("\\b"+(n.pattern||f(n))+"\\b","i").exec(e)&&(n.label||n)})}function o(t){return h(t,function(t,n){var i=n.pattern||f(n);return!t&&(t=RegExp("\\b"+i+"(?:/[\\d.]+|[ \\w.]*)","i").exec(e))&&(t=s(t,i,n.label||n)),t})}function r(t){return h(t,function(t,n){var i=n.pattern||f(n);return!t&&(t=RegExp("\\b"+i+" *\\d+[.\\w_]*","i").exec(e)||RegExp("\\b"+i+"(?:; *(?:[a-z]+[_-])?[a-z]+\\d+|[^ ();-]*)","i").exec(e))&&((t=String(n.label&&!RegExp(i,"i").test(n.label)?n.label:t).split("/"))[1]&&!/[\d.]+/.test(t[0])&&(t[0]+=" "+t[1]),n=n.label||n,t=c(t[0].replace(RegExp(i,"i"),n).replace(RegExp("; *(?:"+n+"[_-])?","i")," ").replace(RegExp("("+n+")[-_.]?(\\w)","i"),"$1 $2"))),t})}function a(t){return h(t,function(t,n){return t||(RegExp(n+"(?:-[\\d.]+/|(?: for [\\w-]+)?[ /-])([\\d.]+[^ ();/_-]*)","i").exec(e)||0)[1]||null})}function m(){return this.description||""}var b=y,_=e&&"object"==typeof e&&"String"!=l(e);_&&(b=e,e=null);var w=b.navigator||{},C=w.userAgent||"";e||(e=C);var E,x,k=_||T==g,O=_?!!w.likeChrome:/\bChrome\b/.test(e)&&!/internal|\n/i.test(I.toString()),A="Object",M=_?A:"ScriptBridgingProxyObject",D=_?A:"Environment",N=_&&b.java?"JavaPackage":l(b.java),P=_?A:"RuntimeObject",R=/\bJava/.test(N)&&b.java,U=R&&l(b.environment)==D,L=R?"a":"α",W=R?"b":"β",j=b.document||{},B=b.operamini||b.opera,F=S.test(F=_&&B?B["[[Class]]"]:l(B))?F:B=null,H=e,V=[],$=null,q=e==C,Y=q&&B&&"function"==typeof B.version&&B.version(),J=t([{label:"EdgeHTML",pattern:"Edge"},"Trident",{label:"WebKit",pattern:"AppleWebKit"},"iCab","Presto","NetFront","Tasman","KHTML","Gecko"]),K=i(["Adobe AIR","Arora","Avant Browser","Breach","Camino","Epiphany","Fennec","Flock","Galeon","GreenBrowser","iCab","Iceweasel","K-Meleon","Konqueror","Lunascape","Maxthon",{label:"Microsoft Edge",pattern:"Edge"},"Midori","Nook Browser","PaleMoon","PhantomJS","Raven","Rekonq","RockMelt","SeaMonkey",{label:"Silk",pattern:"(?:Cloud9|Silk-Accelerated)"},"Sleipnir","SlimBrowser",{label:"SRWare Iron",pattern:"Iron"},"Sunrise","Swiftfox","WebPositive","Opera Mini",{label:"Opera Mini",pattern:"OPiOS"},"Opera",{label:"Opera",pattern:"OPR"},"Chrome",{label:"Chrome Mobile",pattern:"(?:CriOS|CrMo)"},{label:"Firefox",pattern:"(?:Firefox|Minefield)"},{label:"Firefox for iOS",pattern:"FxiOS"},{label:"IE",pattern:"IEMobile"},{label:"IE",pattern:"MSIE"},"Safari"]),X=r([{label:"BlackBerry",pattern:"BB10"},"BlackBerry",{label:"Galaxy S",pattern:"GT-I9000"},{label:"Galaxy S2",pattern:"GT-I9100"},{label:"Galaxy S3",pattern:"GT-I9300"},{label:"Galaxy S4",pattern:"GT-I9500"},"Google TV","Lumia","iPad","iPod","iPhone","Kindle",{label:"Kindle Fire",pattern:"(?:Cloud9|Silk-Accelerated)"},"Nexus","Nook","PlayBook","PlayStation 3","PlayStation 4","PlayStation Vita","TouchPad","Transformer",{label:"Wii U",pattern:"WiiU"},"Wii","Xbox One",{label:"Xbox 360",pattern:"Xbox"},"Xoom"]),z=n({Apple:{iPad:1,iPhone:1,iPod:1},Archos:{},Amazon:{Kindle:1,"Kindle Fire":1},Asus:{Transformer:1},"Barnes & Noble":{Nook:1},BlackBerry:{PlayBook:1},Google:{"Google TV":1,Nexus:1},HP:{TouchPad:1},HTC:{},LG:{},Microsoft:{Xbox:1,"Xbox One":1},Motorola:{Xoom:1},Nintendo:{"Wii U":1,Wii:1},Nokia:{Lumia:1},Samsung:{"Galaxy S":1,"Galaxy S2":1,"Galaxy S3":1,"Galaxy S4":1},Sony:{"PlayStation 4":1,"PlayStation 3":1,"PlayStation Vita":1}}),G=o(["Windows Phone","Android","CentOS",{label:"Chrome OS",pattern:"CrOS"},"Debian","Fedora","FreeBSD","Gentoo","Haiku","Kubuntu","Linux Mint","OpenBSD","Red Hat","SuSE","Ubuntu","Xubuntu","Cygwin","Symbian OS","hpwOS","webOS ","webOS","Tablet OS","Linux","Mac OS X","Macintosh","Mac","Windows 98;","Windows "]);if(J&&(J=[J]),z&&!X&&(X=r([z])),(E=/\bGoogle TV\b/.exec(X))&&(X=E[0]),/\bSimulator\b/i.test(e)&&(X=(X?X+" ":"")+"Simulator"),"Opera Mini"==K&&/\bOPiOS\b/.test(e)&&V.push("running in Turbo/Uncompressed mode"),"IE"==K&&/\blike iPhone OS\b/.test(e)?(E=v(e.replace(/like iPhone OS/,"")),z=E.manufacturer,X=E.product):/^iP/.test(X)?(K||(K="Safari"),G="iOS"+((E=/ OS ([\d_]+)/i.exec(e))?" "+E[1].replace(/_/g,"."):"")):"Konqueror"!=K||/buntu/i.test(G)?z&&"Google"!=z&&(/Chrome/.test(K)&&!/\bMobile Safari\b/i.test(e)||/\bVita\b/.test(X))||/\bAndroid\b/.test(G)&&/^Chrome/.test(K)&&/\bVersion\//i.test(e)?(K="Android Browser",G=/\bAndroid\b/.test(G)?G:"Android"):"Silk"==K?(/\bMobi/i.test(e)||(G="Android",V.unshift("desktop mode")),/Accelerated *= *true/i.test(e)&&V.unshift("accelerated")):"PaleMoon"==K&&(E=/\bFirefox\/([\d.]+)\b/.exec(e))?V.push("identifying as Firefox "+E[1]):"Firefox"==K&&(E=/\b(Mobile|Tablet|TV)\b/i.exec(e))?(G||(G="Firefox OS"),X||(X=E[1])):K&&!(E=!/\bMinefield\b/i.test(e)&&/\b(?:Firefox|Safari)\b/.exec(K))||(K&&!X&&/[\/,]|^[^(]+?\)/.test(e.slice(e.indexOf(E+"/")+8))&&(K=null),(E=X||z||G)&&(X||z||/\b(?:Android|Symbian OS|Tablet OS|webOS)\b/.test(G))&&(K=/[a-z]+(?: Hat)?/i.exec(/\bAndroid\b/.test(G)?G:E)+" Browser")):G="Kubuntu",Y||(Y=a(["(?:Cloud9|CriOS|CrMo|Edge|FxiOS|IEMobile|Iron|Opera ?Mini|OPiOS|OPR|Raven|Silk(?!/[\\d.]+$))","Version",f(K),"(?:Firefox|Minefield|NetFront)"])),(E="iCab"==J&&parseFloat(Y)>3&&"WebKit"||/\bOpera\b/.test(K)&&(/\bOPR\b/.test(e)?"Blink":"Presto")||/\b(?:Midori|Nook|Safari)\b/i.test(e)&&!/^(?:Trident|EdgeHTML)$/.test(J)&&"WebKit"||!J&&/\bMSIE\b/i.test(e)&&("Mac OS"==G?"Tasman":"Trident")||"WebKit"==J&&/\bPlayStation\b(?! Vita\b)/i.test(K)&&"NetFront")&&(J=[E]),"IE"==K&&(E=(/; *(?:XBLWP|ZuneWP)(\d+)/i.exec(e)||0)[1])?(K+=" Mobile",G="Windows Phone "+(/\+$/.test(E)?E:E+".x"),V.unshift("desktop mode")):/\bWPDesktop\b/i.test(e)?(K="IE Mobile",G="Windows Phone 8.x",V.unshift("desktop mode"),Y||(Y=(/\brv:([\d.]+)/.exec(e)||0)[1])):"IE"!=K&&"Trident"==J&&(E=/\brv:([\d.]+)/.exec(e))&&(K&&V.push("identifying as "+K+(Y?" "+Y:"")),K="IE",Y=E[1]),q){if(p(b,"global"))if(R&&(E=R.lang.System,H=E.getProperty("os.arch"),G=G||E.getProperty("os.name")+" "+E.getProperty("os.version")),k&&p(b,"system")&&(E=[b.system])[0]){G||(G=E[0].os||null);try{E[1]=b.require("ringo/engine").version,Y=E[1].join("."),K="RingoJS"}catch(e){E[0].global.system==b.system&&(K="Narwhal")}}else"object"==typeof b.process&&!b.process.browser&&(E=b.process)?(K="Node.js",H=E.arch,G=E.platform,Y=/[\d.]+/.exec(E.version)[0]):U&&(K="Rhino");else l(E=b.runtime)==M?(K="Adobe AIR",G=E.flash.system.Capabilities.os):l(E=b.phantom)==P?(K="PhantomJS",Y=(E=E.version||null)&&E.major+"."+E.minor+"."+E.patch):"number"==typeof j.documentMode&&(E=/\bTrident\/(\d+)/i.exec(e))&&(Y=[Y,j.documentMode],(E=+E[1]+4)!=Y[1]&&(V.push("IE "+Y[1]+" mode"),J&&(J[1]=""),Y[1]=E),Y="IE"==K?String(Y[1].toFixed(1)):Y[0]);G=G&&c(G)}Y&&(E=/(?:[ab]|dp|pre|[ab]\d+pre)(?:\d+\+?)?$/i.exec(Y)||/(?:alpha|beta)(?: ?\d)?/i.exec(e+";"+(q&&w.appMinorVersion))||/\bMinefield\b/i.test(e)&&"a")&&($=/b/i.test(E)?"beta":"alpha",Y=Y.replace(RegExp(E+"\\+?$"),"")+("beta"==$?W:L)+(/\d+\+?/.exec(E)||"")),"Fennec"==K||"Firefox"==K&&/\b(?:Android|Firefox OS)\b/.test(G)?K="Firefox Mobile":"Maxthon"==K&&Y?Y=Y.replace(/\.[\d.]+/,".x"):/\bXbox\b/i.test(X)?(G=null,"Xbox 360"==X&&/\bIEMobile\b/.test(e)&&V.unshift("mobile mode")):!/^(?:Chrome|IE|Opera)$/.test(K)&&(!K||X||/Browser|Mobi/.test(K))||"Windows CE"!=G&&!/Mobi/i.test(e)?"IE"==K&&q&&null===b.external?V.unshift("platform preview"):(/\bBlackBerry\b/.test(X)||/\bBB10\b/.test(e))&&(E=(RegExp(X.replace(/ +/g," *")+"/([.\\d]+)","i").exec(e)||0)[1]||Y)?(E=[E,/BB10/.test(e)],G=(E[1]?(X=null,z="BlackBerry"):"Device Software")+" "+E[0],Y=null):this!=u&&"Wii"!=X&&(q&&B||/Opera/.test(K)&&/\b(?:MSIE|Firefox)\b/i.test(e)||"Firefox"==K&&/\bOS X (?:\d+\.){2,}/.test(G)||"IE"==K&&(G&&!/^Win/.test(G)&&Y>5.5||/\bWindows XP\b/.test(G)&&Y>8||8==Y&&!/\bTrident\b/.test(e)))&&!S.test(E=v.call(u,e.replace(S,"")+";"))&&E.name&&(E="ing as "+E.name+((E=E.version)?" "+E:""),S.test(K)?(/\bIE\b/.test(E)&&"Mac OS"==G&&(G=null),E="identify"+E):(E="mask"+E,K=F?c(F.replace(/([a-z])([A-Z])/g,"$1 $2")):"Opera",/\bIE\b/.test(E)&&(G=null),q||(Y=null)),J=["Presto"],V.push(E)):K+=" Mobile",(E=(/\bAppleWebKit\/([\d.]+\+?)/i.exec(e)||0)[1])&&(E=[parseFloat(E.replace(/\.(\d)$/,".0$1")),E],"Safari"==K&&"+"==E[1].slice(-1)?(K="WebKit Nightly",$="alpha",Y=E[1].slice(0,-1)):Y!=E[1]&&Y!=(E[2]=(/\bSafari\/([\d.]+\+?)/i.exec(e)||0)[1])||(Y=null),E[1]=(/\bChrome\/([\d.]+)/i.exec(e)||0)[1],537.36==E[0]&&537.36==E[2]&&parseFloat(E[1])>=28&&"WebKit"==J&&(J=["Blink"]),q&&(O||E[1])?(J&&(J[1]="like Chrome"),E=E[1]||(E=E[0],E<530?1:E<532?2:E<532.05?3:E<533?4:E<534.03?5:E<534.07?6:E<534.1?7:E<534.13?8:E<534.16?9:E<534.24?10:E<534.3?11:E<535.01?12:E<535.02?"13+":E<535.07?15:E<535.11?16:E<535.19?17:E<536.05?18:E<536.1?19:E<537.01?20:E<537.11?"21+":E<537.13?23:E<537.18?24:E<537.24?25:E<537.36?26:"Blink"!=J?"27":"28")):(J&&(J[1]="like Safari"),E=E[0],E=E<400?1:E<500?2:E<526?3:E<533?4:E<534?"4+":E<535?5:E<537?6:E<538?7:E<601?8:"8"),J&&(J[1]+=" "+(E+="number"==typeof E?".x":/[.+]/.test(E)?"":"+")),"Safari"==K&&(!Y||parseInt(Y)>45)&&(Y=E)),"Opera"==K&&(E=/\bzbov|zvav$/.exec(G))?(K+=" ",V.unshift("desktop mode"),"zvav"==E?(K+="Mini",Y=null):K+="Mobile",G=G.replace(RegExp(" *"+E+"$"),"")):"Safari"==K&&/\bChrome\b/.exec(J&&J[1])&&(V.unshift("desktop mode"),K="Chrome Mobile",Y=null,/\bOS X\b/.test(G)?(z="Apple",G="iOS 4.3+"):G=null),Y&&0==Y.indexOf(E=/[\d.]+$/.exec(G))&&e.indexOf("/"+E+"-")>-1&&(G=d(G.replace(E,""))),J&&!/\b(?:Avant|Nook)\b/.test(K)&&(/Browser|Lunascape|Maxthon/.test(K)||"Safari"!=K&&/^iOS/.test(G)&&/\bSafari\b/.test(J[1])||/^(?:Adobe|Arora|Breach|Midori|Opera|Phantom|Rekonq|Rock|Sleipnir|Web)/.test(K)&&J[1])&&(E=J[J.length-1])&&V.push(E),V.length&&(V=["("+V.join("; ")+")"]),z&&X&&X.indexOf(z)<0&&V.push("on "+z),X&&V.push((/^on /.test(V[V.length-1])?"":"on ")+X),G&&(E=/ ([\d.+]+)$/.exec(G),x=E&&"/"==G.charAt(G.length-E[0].length-1),G={architecture:32,family:E&&!x?G.replace(E[0],""):G,version:E?E[1]:null,toString:function(){var e=this.version;return this.family+(e&&!x?" "+e:"")+(64==this.architecture?" 64-bit":"")}}),(E=/\b(?:AMD|IA|Win|WOW|x86_|x)64\b/i.exec(H))&&!/\bi686\b/i.test(H)?(G&&(G.architecture=64,G.family=G.family.replace(RegExp(" *"+E),"")),K&&(/\bWOW64\b/i.test(e)||q&&/\w(?:86|32)$/.test(w.cpuClass||w.platform)&&!/\bWin64; x64\b/i.test(e))&&V.unshift("32-bit")):G&&/^OS X/.test(G.family)&&"Chrome"==K&&parseFloat(Y)>=39&&(G.architecture=64),e||(e=null);var Q={};return Q.description=e,Q.layout=J&&J[0],Q.manufacturer=z,Q.name=K,Q.prerelease=$,Q.product=X,Q.ua=e,Q.version=K&&Y,Q.os=G||{architecture:null,family:null,version:null,toString:function(){return"null"}},Q.parse=v,Q.toString=m,Q.version&&V.unshift(Y),Q.name&&V.unshift(K),G&&K&&(G!=String(G).split(" ")[0]||G!=K.split(" ")[0]&&!X)&&V.push(X?"("+G+")":"on "+G),V.length&&(Q.description=V.join(" ")),Q}var m={"function":!0,object:!0},y=m[typeof window]&&window||this,g=y,b=m[typeof t]&&t,_=m[typeof e]&&e&&!e.nodeType&&e,w=b&&_&&"object"==typeof o&&o;!w||w.global!==w&&w.window!==w&&w.self!==w||(y=w);var C=Math.pow(2,53)-1,S=/\bOpera/,T=this,E=Object.prototype,x=E.hasOwnProperty,I=E.toString,k=v();y.platform=k,i=function(){return k}.call(t,n,t,e),!(void 0!==i&&(e.exports=i))}).call(this)}).call(t,n(14)(e),function(){return this}())},14:function(e,t){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children=[],e.webpackPolyfill=1),e}},17:function(e,t,n){!function(t,n){e.exports=n()}(this,function(){return function(e){function t(i){if(n[i])return n[i].exports;var o=n[i]={exports:{},id:i,loaded:!1};return e[i].call(o.exports,o,o.exports,t),o.loaded=!0,o.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function o(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}t.__esModule=!0;var r=n(1),s=o(r),a=n(3),c=o(a),u=n(4),l=o(u),p=n(5),f=o(p),h=n(6),d=o(h),v=n(8),m=i(v),y=n(2),g=i(y),b=n(9),_=o(b),w=n(10),C=o(w),S=n(11),T=i(S),E=n(12),x=o(E),I=n(7),k=o(I),O=n(13),A=o(O),M=x.merge({},s,c,l,f,d,{forOwn:m["default"],getGlobal:g["default"]},_,C,{mixin:T["default"]},x,k,A);delete M.__esModule,t["default"]=M,e.exports=t["default"]},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function o(e){var t=(0,a["default"])(),n=void 0;n=e.split(",")[0].indexOf("base64")>=0?t.atob(e.split(",")[1]):t.decodeURIComponent(e.split(",")[1]);for(var i=e.split(",")[0].split(":")[1].split(";")[0],o=new Uint8Array(n.length),r=0;r<n.length;r++)o[r]=n.charCodeAt(r);return new t.Blob([o],{type:i})}function r(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"image/jpeg",i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;if(e.toBlob)e.toBlob(t,n,i);else{var r=e.toDataURL(n,i);t(o(r))}}t.__esModule=!0,t.blobFromDataURL=o,t.blobFromCanvas=r;var s=n(2),a=i(s)},function(e,t){(function(n){"use strict";t.__esModule=!0,t["default"]=function(){return"undefined"!=typeof window?window:"undefined"!=typeof self?self:"undefined"!=typeof n?n:{}},e.exports=t["default"]}).call(t,function(){return this}())},function(e,t){"use strict";function n(e){var t=!1,n="Webkit Moz ms O".split(" "),i=document.createElement("div"),o=null;if(e=e.toLowerCase(),void 0!==i.style[e]&&(t=!0),t===!1){o=e.charAt(0).toUpperCase()+e.substr(1);for(var r=0;r<n.length;r++)if(void 0!==i.style[n[r]+o]){t=!0;break}}return t}t.__esModule=!0,t.detectCSSFeature=n},function(e,t){"use strict";t.__esModule=!0;t.o={},t.emptyObj={},t.f=function(){},t.emptyFunc=function(){},t.regBlank=/\s+/gi,t.regWhiteSpace=/\s+/gi},function(e,t){"use strict";function n(e,t){t=t||2;for(var n=""+e;n.length<t;)n="0"+n;return n}function i(e){return""+e.getFullYear()}function o(e){return n(e.getMonth()+1)}function r(e){return n(e.getDate())}function s(e){return n(e.getHours())}function a(e){return n(e.getMinutes())}function c(e){return n(e.getSeconds())}function u(e){return n(e.getMilliseconds(),3)}function l(e){return e=""+e,new Date(e.replace(/-/g,"/").replace("T"," "))}t.__esModule=!0,t.fix=n,t.getYearStr=i,t.getMonthStr=o,t.getDayStr=r,t.getHourStr=s,t.getMinuteStr=a,t.getSecondStr=c,t.getMillisecondStr=u,t.dateFromDateTimeLocal=l;t.format=function(){var e=/yyyy|MM|dd|hh|mm|ss|SSS/g,t={yyyy:i,MM:o,dd:r,hh:s,mm:a,ss:c,SSS:u};return function(n,i){return n=new Date(n),isNaN(+n)?"invalid date":(i=i||"yyyy-MM-dd",i.replace(e,function(e){return t[e](n)}))}}()},function(e,t,n){"use strict";function i(e,t){if(e===t)return!0;for(;t.parentNode;){if(t.parentNode===e)return!0;t=t.parentNode}return!1}function o(e){var t=e.parentNode||document.body;e=e.cloneNode(!0),e.style.display="block",e.style.opacity=0,e.style.height="auto",t.appendChild(e);var n=e.offsetHeight;return t.removeChild(e),n}function r(e){e.parentNode&&e.parentNode.removeChild(e)}function s(e,t,n){return(0,p.exist)(n)?void e.setAttribute("data-"+t,n):e.getAttribute("data-"+t)}function a(e){return e.target||e.srcElement}function c(e){function t(i){n.src&&(e.multi||v(n,"load",t),e.onload(i))}e=e||{};var n;if(e.name)try{n=document.createElement('<iframe name="'+e.name+'"></iframe>'),n.frameBorder=0}catch(error){n=document.createElement("iframe"),n.name=e.name}else n=document.createElement("iframe");e.visible||(n.style.display="none"),(0,p.isFunction)(e.onload)&&h(n,"load",t);var i=e.parent;(i||document.body).appendChild(n);var o=e.src||"about:blank";
return setTimeout(function(){n.src=o},0),n}function u(e){var t=document.createElement("div");t.innerHTML=e;var n=[],i=void 0,o=void 0;if(t.children)for(i=0,o=t.children.length;i<o;i++)n.push(t.children[i]);else for(i=0,o=t.childNodes.length;i<o;i++){var r=t.childNodes[i];1===r.nodeType&&n.push(r)}return n.length>1?t:n[0]}function l(e){return(0,p.exist)(e)&&(document.documentElement.scrollTop=document.body.scrollTop=e),window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop||0}t.__esModule=!0,t.off=t.removeEventListener=t.on=t.addEventListener=void 0,t.containsNode=i,t.calcHeight=o,t.remove=r,t.dataset=s,t.target=a,t.createIframe=c,t.html2node=u,t.scrollTop=l;var p=n(7),f=t.addEventListener=function(e,t,n){e.addEventListener?e.addEventListener(t,n,!1):e.attachEvent&&e.attachEvent("on"+t,n)},h=t.on=f,d=t.removeEventListener=function(e,t,n){e.removeEventListener?e.removeEventListener(t,n,!1):e.detachEvent&&e.detachEvent("on"+t,n)},v=t.off=d},function(e,t){"use strict";function n(e){return Object.prototype.toString.call(e).slice(8,-1)}function i(e){return n(e).toLowerCase()}function o(e){return"string"===i(e)}function r(e){return"number"===i(e)}function s(e){return"boolean"===i(e)}function a(e){return"array"===i(e)}function c(e){return"function"===i(e)}function u(e){return"date"===i(e)}function l(e){return"regexp"===i(e)}function p(e){return"error"===i(e)}function f(e){return null===e}function h(e){return null!==e}function d(e){return"undefined"==typeof e}function v(e){return"undefined"!=typeof e}function m(e){return v(e)&&h(e)}function y(e){return d(e)||f(e)}function g(e){return m(e)&&"object"===i(e)}function b(e){return y(e)||(o(e)||a(e))&&0===e.length}t.__esModule=!0,t.getClass=n,t.typeOf=i,t.isString=o,t.isNumber=r,t.isBoolean=s,t.isArray=a,t.isFunction=c,t.isDate=u,t.isRegExp=l,t.isError=p,t.isnull=f,t.notnull=h,t.undef=d,t.notundef=v,t.exist=m,t.notexist=y,t.isObject=g,t.isEmpty=b},function(e,t){"use strict";t.__esModule=!0,t["default"]=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){},n=arguments[2];for(var i in e)e.hasOwnProperty(i)&&t.call(n,i,e[i])},e.exports=t["default"]},function(e,t){"use strict";t.__esModule=!0;t.uniqueID=function(){var e=0;return function(){return""+e++}}()},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function o(e){return(0,c.isString)(e)&&0===e.indexOf("{")&&e.lastIndexOf("}")===e.length-1}function r(e){try{o(e)&&(e=JSON.parse(e)),(0,c.isObject)(e)&&(0,a["default"])(e,function(t,n){switch((0,c.typeOf)(n)){case"string":case"object":e[t]=r(n)}})}catch(error){console.error(error)}return e}t.__esModule=!0,t.isJSON=o,t.parseJSON=r;var s=n(8),a=i(s),c=n(7)},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}t.__esModule=!0;var o=n(8),r=i(o);t["default"]=function(e,t){(0,r["default"])(t,function(t,n){e[t]=n})},e.exports=t["default"]},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function o(e){return JSON.parse(JSON.stringify(e))}function r(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length,n=Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];return n.forEach(function(t){(0,f["default"])(e,t)}),e}function s(e,t){return(0,d["default"])(t,function(t,n){(0,v.undef)(e[t])&&(e[t]=n)}),e}function a(e,t,n){var i=e[t]||e[t.toLowerCase()];return(0,v.notexist)(i)&&(i=n,e[t]=i),i}function c(e,t){return(0,d["default"])(e,function(n,i){(0,v.exist)(t[n])&&(e[n]=t[n])}),e}function u(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:",",n={};return e.split(t).forEach(function(e){var t=e.split("="),i=t.shift();i&&(n[decodeURIComponent(i)]=decodeURIComponent(t.join("=")))}),n}function l(e,t,n){if(!e)return"";var i=[];return(0,d["default"])(e,function(e,t){(0,v.isFunction)(t)||((0,v.isDate)(t)?t=t.getTime():(0,v.isArray)(t)?t=t.join(","):(0,v.isObject)(t)&&(t=JSON.stringify(t)),n&&(t=encodeURIComponent(t)),i.push(encodeURIComponent(e)+"="+t))}),i.join(t||",")}t.__esModule=!0,t.simpleClone=o,t.merge=r,t.fillUndef=s,t.checkWithDefault=a,t.fetch=c,t.string2object=u,t.object2string=l;var p=n(11),f=i(p),h=n(8),d=i(h),v=n(7)},function(e,t,n){"use strict";function i(e){return e.indexOf("?")<0?"?":"&"}function o(e){return(0,r.object2string)(e,"&",!0)}t.__esModule=!0,t.url2origin=void 0,t.genUrlSep=i,t.object2query=o;var r=n(12);t.url2origin=function(){var e=/^([\w]+?:\/\/.*?(?=\/|$))/i;return function(t){return e.test(t||"")?RegExp.$1.toLowerCase():""}}()}])})},19:function(module,exports,__webpack_require__){var __WEBPACK_AMD_DEFINE_ARRAY__,__WEBPACK_AMD_DEFINE_RESULT__;(function(module){/*! Socket.IO.js build:0.9.11, development. Copyright(c) 2011 LearnBoost <dev@learnboost.com> MIT Licensed */
var io=module.exports;window.io?module&&(module.exports=io=window.io):window.io=io,function(){if(function(e,t){var n=e;n.version="0.9.11",n.protocol=1,n.transports=[],n.j=[],n.sockets={},n.connect=function(e,i){var o,r,s=n.util.parseUri(e);t&&t.location&&(s.protocol=s.protocol||t.location.protocol.slice(0,-1),s.host=s.host||(t.document?t.document.domain:t.location.hostname),s.port=s.port||t.location.port),o=n.util.uniqueUri(s);var a={host:s.host,secure:"https"==s.protocol,port:s.port||("https"==s.protocol?443:80),query:s.query||""};return n.util.merge(a,i),!a["force new connection"]&&n.sockets[o]||(r=new n.Socket(a)),!a["force new connection"]&&r&&(n.sockets[o]=r),r=r||n.sockets[o],r.of(s.path.length>1?s.path:"")}}(module.exports,window),function(e,t){var n=e.util={},i=/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,o=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];n.parseUri=function(e){for(var t=i.exec(e||""),n={},r=14;r--;)n[o[r]]=t[r]||"";return n},n.uniqueUri=function(e){var n=e.protocol,i=e.host,o=e.port;return"document"in t?(i=i||document.domain,o=o||("https"==n&&"https:"!==document.location.protocol?443:document.location.port)):(i=i||"localhost",o||"https"!=n||(o=443)),(n||"http")+"://"+i+":"+(o||80)},n.query=function(e,t){var i=n.chunkQuery(e||""),o=[];n.merge(i,n.chunkQuery(t||""));for(var r in i)i.hasOwnProperty(r)&&o.push(r+"="+i[r]);return o.length?"?"+o.join("&"):""},n.chunkQuery=function(e){for(var t,n={},i=e.split("&"),o=0,r=i.length;o<r;++o)t=i[o].split("="),t[0]&&(n[t[0]]=t[1]);return n};var r=!1;n.load=function(e){return"document"in t&&"complete"===document.readyState||r?e():void n.on(t,"load",e,!1)},n.on=function(e,t,n,i){e.attachEvent?e.attachEvent("on"+t,n):e.addEventListener&&e.addEventListener(t,n,i)},n.request=function(e){if(e&&"undefined"!=typeof XDomainRequest&&!n.ua.hasCORS)return new XDomainRequest;if("undefined"!=typeof XMLHttpRequest&&(!e||n.ua.hasCORS))return new XMLHttpRequest;if(!e)try{return new(window[["Active"].concat("Object").join("X")])("Microsoft.XMLHTTP")}catch(e){}return null},"undefined"!=typeof window&&n.load(function(){r=!0}),n.defer=function(e){return n.ua.webkit&&"undefined"==typeof importScripts?void n.load(function(){setTimeout(e,100)}):e()},n.merge=function(e,t,i,o){var r,s=o||[],a="undefined"==typeof i?2:i;for(r in t)t.hasOwnProperty(r)&&n.indexOf(s,r)<0&&("object"==typeof e[r]&&a?n.merge(e[r],t[r],a-1,s):(e[r]=t[r],s.push(t[r])));return e},n.mixin=function(e,t){n.merge(e.prototype,t.prototype)},n.inherit=function(e,t){function n(){}n.prototype=t.prototype,e.prototype=new n},n.isArray=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)},n.intersect=function(e,t){for(var i=[],o=e.length>t.length?e:t,r=e.length>t.length?t:e,s=0,a=r.length;s<a;s++)~n.indexOf(o,r[s])&&i.push(r[s]);return i},n.indexOf=function(e,t,n){for(var i=e.length,n=n<0?n+i<0?0:n+i:n||0;n<i&&e[n]!==t;n++);return i<=n?-1:n},n.toArray=function(e){for(var t=[],n=0,i=e.length;n<i;n++)t.push(e[n]);return t},n.ua={},n.ua.hasCORS="undefined"!=typeof XMLHttpRequest&&function(){try{var e=new XMLHttpRequest}catch(e){return!1}return void 0!=e.withCredentials}(),n.ua.webkit="undefined"!=typeof navigator&&/webkit/i.test(navigator.userAgent),n.ua.iDevice="undefined"!=typeof navigator&&/iPad|iPhone|iPod/i.test(navigator.userAgent)}("undefined"!=typeof io?io:module.exports,window),function(e,t){function n(){}e.EventEmitter=n,n.prototype.on=function(e,n){return this.$events||(this.$events={}),this.$events[e]?t.util.isArray(this.$events[e])?this.$events[e].push(n):this.$events[e]=[this.$events[e],n]:this.$events[e]=n,this},n.prototype.addListener=n.prototype.on,n.prototype.once=function(e,t){function n(){i.removeListener(e,n),t.apply(this,arguments)}var i=this;return n.listener=t,this.on(e,n),this},n.prototype.removeListener=function(e,n){if(this.$events&&this.$events[e]){var i=this.$events[e];if(t.util.isArray(i)){for(var o=-1,r=0,s=i.length;r<s;r++)if(i[r]===n||i[r].listener&&i[r].listener===n){o=r;break}if(o<0)return this;i.splice(o,1),i.length||delete this.$events[e]}else(i===n||i.listener&&i.listener===n)&&delete this.$events[e]}return this},n.prototype.removeAllListeners=function(e){return void 0===e?(this.$events={},this):(this.$events&&this.$events[e]&&(this.$events[e]=null),this)},n.prototype.listeners=function(e){return this.$events||(this.$events={}),this.$events[e]||(this.$events[e]=[]),t.util.isArray(this.$events[e])||(this.$events[e]=[this.$events[e]]),this.$events[e]},n.prototype.emit=function(e){if(!this.$events)return!1;var n=this.$events[e];if(!n)return!1;var i=Array.prototype.slice.call(arguments,1);if("function"==typeof n)n.apply(this,i);else{if(!t.util.isArray(n))return!1;for(var o=n.slice(),r=0,s=o.length;r<s;r++)o[r].apply(this,i)}return!0}}("undefined"!=typeof io?io:module.exports,"undefined"!=typeof io?io:module.parent.exports),function(exports,nativeJSON){"use strict";function f(e){return e<10?"0"+e:e}function date(e,t){return isFinite(e.valueOf())?e.getUTCFullYear()+"-"+f(e.getUTCMonth()+1)+"-"+f(e.getUTCDate())+"T"+f(e.getUTCHours())+":"+f(e.getUTCMinutes())+":"+f(e.getUTCSeconds())+"Z":null}function quote(e){return escapable.lastIndex=0,escapable.test(e)?'"'+e.replace(escapable,function(e){var t=meta[e];return"string"==typeof t?t:"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+e+'"'}function str(e,t){var n,i,o,r,s,a=gap,c=t[e];switch(c instanceof Date&&(c=date(e)),"function"==typeof rep&&(c=rep.call(t,e,c)),typeof c){case"string":return quote(c);case"number":return isFinite(c)?String(c):"null";case"boolean":case"null":return String(c);case"object":if(!c)return"null";if(gap+=indent,s=[],"[object Array]"===Object.prototype.toString.apply(c)){for(r=c.length,n=0;n<r;n+=1)s[n]=str(n,c)||"null";return o=0===s.length?"[]":gap?"[\n"+gap+s.join(",\n"+gap)+"\n"+a+"]":"["+s.join(",")+"]",gap=a,o}if(rep&&"object"==typeof rep)for(r=rep.length,n=0;n<r;n+=1)"string"==typeof rep[n]&&(i=rep[n],o=str(i,c),o&&s.push(quote(i)+(gap?": ":":")+o));else for(i in c)Object.prototype.hasOwnProperty.call(c,i)&&(o=str(i,c),o&&s.push(quote(i)+(gap?": ":":")+o));return o=0===s.length?"{}":gap?"{\n"+gap+s.join(",\n"+gap)+"\n"+a+"}":"{"+s.join(",")+"}",gap=a,o}}if(nativeJSON&&nativeJSON.parse)return exports.JSON={parse:nativeJSON.parse,stringify:nativeJSON.stringify};var JSON=exports.JSON={},cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},rep;JSON.stringify=function(e,t,n){var i;if(gap="",indent="","number"==typeof n)for(i=0;i<n;i+=1)indent+=" ";else"string"==typeof n&&(indent=n);if(rep=t,t&&"function"!=typeof t&&("object"!=typeof t||"number"!=typeof t.length))throw new Error("JSON.stringify");return str("",{"":e})},JSON.parse=function(text,reviver){function walk(e,t){var n,i,o=e[t];if(o&&"object"==typeof o)for(n in o)Object.prototype.hasOwnProperty.call(o,n)&&(i=walk(o,n),void 0!==i?o[n]=i:delete o[n]);return reviver.call(e,t,o)}var j;if(text=String(text),cx.lastIndex=0,cx.test(text)&&(text=text.replace(cx,function(e){return"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)})),/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return j=eval("("+text+")"),"function"==typeof reviver?walk({"":j},""):j;throw new SyntaxError("JSON.parse")}}("undefined"!=typeof io?io:module.exports,"undefined"!=typeof JSON?JSON:void 0),function(e,t){var n=e.parser={},i=n.packets=["disconnect","connect","heartbeat","message","json","event","ack","error","noop"],o=n.reasons=["transport not supported","client not handshaken","unauthorized"],r=n.advice=["reconnect"],s=t.JSON,a=t.util.indexOf;n.encodePacket=function(e){var t=a(i,e.type),n=e.id||"",c=e.endpoint||"",u=e.ack,l=null;switch(e.type){case"error":var p=e.reason?a(o,e.reason):"",f=e.advice?a(r,e.advice):"";""===p&&""===f||(l=p+(""!==f?"+"+f:""));break;case"message":""!==e.data&&(l=e.data);break;case"event":var h={name:e.name};e.args&&e.args.length&&(h.args=e.args),l=s.stringify(h);break;case"json":l=s.stringify(e.data);break;case"connect":e.qs&&(l=e.qs);break;case"ack":l=e.ackId+(e.args&&e.args.length?"+"+s.stringify(e.args):"")}var d=[t,n+("data"==u?"+":""),c];return null!==l&&void 0!==l&&d.push(l),d.join(":")},n.encodePayload=function(e){var t="";if(1==e.length)return e[0];for(var n=0,i=e.length;n<i;n++){var o=e[n];t+="�"+o.length+"�"+e[n]}return t};var c=/([^:]+):([0-9]+)?(\+)?:([^:]+)?:?([\s\S]*)?/;n.decodePacket=function(e){var t=e.match(c);if(!t)return{};var n=t[2]||"",e=t[5]||"",a={type:i[t[1]],endpoint:t[4]||""};switch(n&&(a.id=n,t[3]?a.ack="data":a.ack=!0),a.type){case"error":var t=e.split("+");a.reason=o[t[0]]||"",a.advice=r[t[1]]||"";break;case"message":a.data=e||"";break;case"event":try{var u=s.parse(e);a.name=u.name,a.args=u.args}catch(e){}a.args=a.args||[];break;case"json":try{a.data=s.parse(e)}catch(e){}break;case"connect":a.qs=e||"";break;case"ack":var t=e.match(/^([0-9]+)(\+)?(.*)/);if(t&&(a.ackId=t[1],a.args=[],t[3]))try{a.args=t[3]?s.parse(t[3]):[]}catch(e){}break;case"disconnect":case"heartbeat":}return a},n.decodePayload=function(e){var t=function(e,t){for(var n=0,i=e;i<t.length;i++){if("�"==t.charAt(i))return n;n++}return n};if("�"==e.charAt(0)){for(var i=[],o=1,r="";o<e.length;o++)if("�"==e.charAt(o)){var s=e.substr(o+1).substr(0,r);if("�"!=e.charAt(o+1+Number(r))&&o+1+Number(r)!=e.length){var a=Number(r);l=t(o+a+1,e),s=e.substr(o+1).substr(0,a+l),o+=l}i.push(n.decodePacket(s)),o+=Number(r)+1,r=""}else r+=e.charAt(o);return i}return[n.decodePacket(e)]}}("undefined"!=typeof io?io:module.exports,"undefined"!=typeof io?io:module.parent.exports),function(e,t){function n(e,t){this.socket=e,this.sessid=t}e.Transport=n,t.util.mixin(n,t.EventEmitter),n.prototype.heartbeats=function(){return!0},n.prototype.onData=function(e){if(this!==this.socket.transport)return this;if(this.clearCloseTimeout(),(this.socket.connected||this.socket.connecting||this.socket.reconnecting)&&this.setCloseTimeout(),""!==e){var n=t.parser.decodePayload(e);if(n&&n.length)for(var i=0,o=n.length;i<o;i++)this.onPacket(n[i])}return this},n.prototype.onPacket=function(e){return this.socket.setHeartbeatTimeout(),"heartbeat"==e.type?this.onHeartbeat():("connect"==e.type&&""==e.endpoint&&this.onConnect(),"error"==e.type&&"reconnect"==e.advice&&(this.isOpen=!1),this.socket.onPacket(e),this)},n.prototype.setCloseTimeout=function(){if(!this.closeTimeout){var e=this;this.closeTimeout=setTimeout(function(){e.onDisconnect()},this.socket.closeTimeout)}},n.prototype.onDisconnect=function(){return this.isOpen&&this.close(),this.clearTimeouts(),this.socket.transport===this?this.socket.onDisconnect():this.socket.setBuffer(!1),this},n.prototype.onConnect=function(){return this.socket.onConnect(),this},n.prototype.clearCloseTimeout=function(){this.closeTimeout&&(clearTimeout(this.closeTimeout),this.closeTimeout=null)},n.prototype.clearTimeouts=function(){this.clearCloseTimeout(),this.reopenTimeout&&clearTimeout(this.reopenTimeout)},n.prototype.packet=function(e){this.send(t.parser.encodePacket(e))},n.prototype.onHeartbeat=function(e){this.packet({type:"heartbeat"})},n.prototype.onOpen=function(){this.isOpen=!0,this.clearCloseTimeout(),this.socket.onOpen()},n.prototype.onClose=function(){this.isOpen=!1,this.socket.transport===this?this.socket.onClose():this.socket.setBuffer(!1),this.onDisconnect()},n.prototype.prepareUrl=function(){var e=this.socket.options;return this.scheme()+"://"+e.host+":"+e.port+"/"+e.resource+"/"+t.protocol+"/"+this.name+"/"+this.sessid},n.prototype.ready=function(e,t){t.call(this)}}("undefined"!=typeof io?io:module.exports,"undefined"!=typeof io?io:module.parent.exports),function(e,t,n){function i(e){if(this.options={port:80,secure:!1,document:"document"in n&&document,resource:"socket.io",transports:e.transports||t.transports,"connect timeout":1e4,"try multiple transports":!0,reconnect:!0,"reconnection delay":500,"reconnection limit":1/0,"reopen delay":3e3,"max reconnection attempts":10,"sync disconnect on unload":!1,"auto connect":!0,"flash policy port":10843,manualFlush:!1},t.util.merge(this.options,e),this.connected=!1,this.open=!1,this.connecting=!1,this.reconnecting=!1,this.namespaces={},this.buffer=[],this.doBuffer=!1,this.options["sync disconnect on unload"]&&(!this.isXDomain()||t.util.ua.hasCORS)){var i=this;t.util.on(n,"beforeunload",function(){i.disconnectSync()},!1)}this.options["auto connect"]&&this.connect()}function o(){}e.Socket=i,t.util.mixin(i,t.EventEmitter),i.prototype.of=function(e){return this.namespaces[e]||(this.namespaces[e]=new t.SocketNamespace(this,e),""!==e&&this.namespaces[e].packet({type:"connect"})),this.namespaces[e]},i.prototype.publish=function(){this.emit.apply(this,arguments);var e;for(var t in this.namespaces)this.namespaces.hasOwnProperty(t)&&(e=this.of(t),e.$emit.apply(e,arguments))},i.prototype.handshake=function(e){function n(t){t instanceof Error?(i.connecting=!1,i.onError(t.message)):(console.log("D handshake success "+t),e.apply(null,t.split(":")))}var i=this,r=this.options,s=["http"+(r.secure?"s":"")+":/",r.host+":"+r.port,r.resource,t.protocol,t.util.query(this.options.query,"t="+ +new Date)].join("/");if(this.isXDomain()&&!t.util.ua.hasCORS){var a=document.getElementsByTagName("script")[0],c=document.createElement("script");c.src=s+"&jsonp="+t.j.length,c.onreadystatechange=function(){"loaded"==this.readyState&&c.parentNode&&(c.parentNode.removeChild(c),i.connecting=!1,!i.reconnecting&&i.onError("Server down or port not open"),i.publish("handshake_failed"))},a.parentNode.insertBefore(c,a),t.j.push(function(e){n(e),c.parentNode.removeChild(c)})}else{var u=t.util.request();u.timeout=1e4,u.open("GET",s,!0),this.isXDomain()&&(u.withCredentials=!0),u.onreadystatechange=function(){4==u.readyState&&(u.onreadystatechange=o,200==u.status?n(u.responseText):403==u.status?(i.onError(u.responseText),i.publish("handshake_failed")):(i.connecting=!1,!i.reconnecting&&i.onError(u.responseText),i.publish("handshake_failed")))},u.ontimeout=function(e){i.connecting=!1,!i.reconnecting&&i.onError(u.responseText),i.publish("handshake_failed")},u.send(null)}},i.prototype.connect=function(e){if(this.connecting)return this;var n=this;return n.connecting=!0,this.handshake(function(i,o,r,s){n.sessionid=i,n.closeTimeout=1e3*r,n.heartbeatTimeout=1e3*o,n.transports||(n.transports=n.origTransports=s?t.util.intersect(s.split(","),n.options.transports):n.options.transports),console.log("D options transports: "+n.options.transports),console.log("D transports: "+n.transports),n.setHeartbeatTimeout(),n.once("connect",function(){clearTimeout(n.connectTimeoutTimer),n.connectTimeoutTimer=null,e&&"function"==typeof e&&e()}),n.doConnect()}),this},i.prototype.doConnect=function(){var e=this;return e.transport&&e.transport.clearTimeouts(),e.transport=e.getTransport(e.transports),e.transport?void e.transport.ready(e,function(){e.connecting=!0,e.publish("connecting",e.transport.name),e.transport.open(),e.options["connect timeout"]&&(e.connectTimeoutTimer&&clearTimeout(e.connectTimeoutTimer),e.connectTimeoutTimer=setTimeout(e.tryNextTransport.bind(e),e.options["connect timeout"]))}):e.publish("connect_failed")},i.prototype.getTransport=function(e){for(var n,i=e||this.transports,o=0;n=i[o];o++)if(console.log("D check "+n+" "+t.Transport[n].check(this)+" , cors "+t.Transport[n].xdomainCheck(this)),t.Transport[n]&&t.Transport[n].check(this)&&(!this.isXDomain()||t.Transport[n].xdomainCheck(this))){var r=new t.Transport[n](this,this.sessionid);return r}return null},i.prototype.tryNextTransport=function(){console.log("D try next transport");var e=this;if(!e.connected&&(e.connecting=!1,e.options["try multiple transports"])){for(var t=e.transports;t.length>0&&t.splice(0,1)[0]!=e.transport.name;);t.length?e.doConnect():e.publish("connect_failed")}},i.prototype.setHeartbeatTimeout=function(){if(clearTimeout(this.heartbeatTimeoutTimer),!this.transport||this.transport.heartbeats()){var e=this;this.heartbeatTimeoutTimer=setTimeout(function(){e.transport&&e.transport.onClose()},this.heartbeatTimeout)}},i.prototype.packet=function(e){return this.connected&&!this.doBuffer?this.transport.packet(e):this.buffer.push(e),this},i.prototype.setBuffer=function(e){this.doBuffer=e,!e&&this.connected&&this.buffer.length&&(this.options.manualFlush||this.flushBuffer())},i.prototype.flushBuffer=function(){this.transport.payload(this.buffer),this.buffer=[]},i.prototype.disconnect=function(){return(this.connected||this.connecting)&&(this.open&&this.of("").packet({type:"disconnect"}),this.onDisconnect("booted")),this},i.prototype.disconnectSync=function(){var e=t.util.request(),n=["http"+(this.options.secure?"s":"")+":/",this.options.host+":"+this.options.port,this.options.resource,t.protocol,"",this.sessionid].join("/")+"/?disconnect=1";e.open("GET",n,!1),e.send(null),this.onDisconnect("booted")},i.prototype.isXDomain=function(){var e=n.location.port||("https:"==n.location.protocol?443:80);return this.options.host!==n.location.hostname||this.options.port!=e},i.prototype.onConnect=function(){this.connected||(this.connected=!0,this.connecting=!1,this.doBuffer||this.setBuffer(!1),this.emit("connect"))},i.prototype.onOpen=function(){this.open=!0},i.prototype.onClose=function(){this.open=!1,clearTimeout(this.heartbeatTimeoutTimer)},i.prototype.onPacket=function(e){this.of(e.endpoint).onPacket(e)},i.prototype.onError=function(e){e&&e.advice&&"reconnect"===e.advice&&(this.connected||this.connecting)&&(this.disconnect(),this.options.reconnect&&this.reconnect()),this.publish("error",e&&e.reason?e.reason:e)},i.prototype.onDisconnect=function(e){var t=this.connected,n=this.connecting;this.connected=!1,this.connecting=!1,this.open=!1,(t||n)&&(this.transport.close(),this.transport.clearTimeouts(),t&&(this.publish("disconnect",e),"booted"!=e&&this.options.reconnect&&!this.reconnecting&&this.reconnect()),n&&this.tryNextTransport())},i.prototype.reconnect=function(){function e(){if(n.connected){for(var e in n.namespaces)n.namespaces.hasOwnProperty(e)&&""!==e&&n.namespaces[e].packet({type:"connect"});n.publish("reconnect",n.transport.name,n.reconnectionAttempts)}clearTimeout(n.reconnectionTimer),n.removeListener("connect_failed",t),n.removeListener("connect",t),n.reconnecting=!1,delete n.reconnectionAttempts,delete n.reconnectionDelay,delete n.reconnectionTimer,delete n.redoTransports,n.options["try multiple transports"]=o}function t(){if(n.reconnecting)return n.connected?e():n.connecting&&n.reconnecting?n.reconnectionTimer=setTimeout(t,1e3):void(n.reconnectionAttempts++>=i?n.redoTransports?(n.publish("reconnect_failed"),e()):(n.on("connect_failed",t),n.options["try multiple transports"]=!0,n.transports=n.origTransports,n.transport=n.getTransport(),n.redoTransports=!0,n.connect()):(n.reconnectionDelay<r&&(n.reconnectionDelay*=2),n.connect(),n.publish("reconnecting",n.reconnectionDelay,n.reconnectionAttempts),n.reconnectionTimer=setTimeout(t,n.reconnectionDelay)))}this.reconnecting=!0,this.reconnectionAttempts=0,this.reconnectionDelay=this.options["reconnection delay"];var n=this,i=this.options["max reconnection attempts"],o=this.options["try multiple transports"],r=this.options["reconnection limit"];this.options["try multiple transports"]=!1,this.reconnectionTimer=setTimeout(t,this.reconnectionDelay),this.on("connect",t)}}("undefined"!=typeof io?io:module.exports,"undefined"!=typeof io?io:module.parent.exports,window),function(e,t){function n(e,t){this.socket=e,this.name=t||"",this.flags={},this.json=new i(this,"json"),this.ackPackets=0,this.acks={}}function i(e,t){this.namespace=e,this.name=t}e.SocketNamespace=n,t.util.mixin(n,t.EventEmitter),n.prototype.$emit=t.EventEmitter.prototype.emit,n.prototype.of=function(){return this.socket.of.apply(this.socket,arguments)},n.prototype.packet=function(e){return e.endpoint=this.name,this.socket.packet(e),this.flags={},this},n.prototype.send=function(e,t){var n={type:this.flags.json?"json":"message",data:e};return"function"==typeof t&&(n.id=++this.ackPackets,n.ack=!0,this.acks[n.id]=t),this.packet(n)},n.prototype.emit=function(e){var t=Array.prototype.slice.call(arguments,1),n=t[t.length-1],i={type:"event",name:e};return"function"==typeof n&&(i.id=++this.ackPackets,i.ack="data",this.acks[i.id]=n,t=t.slice(0,t.length-1)),i.args=t,this.packet(i)},n.prototype.disconnect=function(){return""===this.name?this.socket.disconnect():(this.packet({type:"disconnect"}),this.$emit("disconnect")),this},n.prototype.onPacket=function(e){function n(){i.packet({type:"ack",args:t.util.toArray(arguments),ackId:e.id})}var i=this;switch(e.type){case"connect":this.$emit("connect");break;case"disconnect":""===this.name?this.socket.onDisconnect(e.reason||"booted"):this.$emit("disconnect",e.reason);break;case"message":case"json":var o=["message",e.data];"data"==e.ack?o.push(n):e.ack&&this.packet({type:"ack",ackId:e.id}),this.$emit.apply(this,o);break;case"event":var o=[e.name].concat(e.args);"data"==e.ack&&o.push(n),this.$emit.apply(this,o);break;case"ack":this.acks[e.ackId]&&(this.acks[e.ackId].apply(this,e.args),delete this.acks[e.ackId]);break;case"error":e.advice?this.socket.onError(e):"unauthorized"==e.reason?this.$emit("connect_failed",e.reason):this.$emit("error",e.reason)}},i.prototype.send=function(){this.namespace.flags[this.name]=!0,this.namespace.send.apply(this.namespace,arguments)},i.prototype.emit=function(){this.namespace.flags[this.name]=!0,this.namespace.emit.apply(this.namespace,arguments)}}("undefined"!=typeof io?io:module.exports,"undefined"!=typeof io?io:module.parent.exports),function(e,t,n){function i(e){t.Transport.apply(this,arguments)}e.websocket=i,t.util.inherit(i,t.Transport),i.prototype.name="websocket",i.prototype.open=function(){var e,i=t.util.query(this.socket.options.query),o=this;return e||(e=n.MozWebSocket||n.WebSocket),this.websocket=new e(this.prepareUrl()+i),this.websocket.onopen=function(){o.onOpen(),o.socket.setBuffer(!1)},this.websocket.onmessage=function(e){o.onData(e.data)},this.websocket.onclose=function(){o.socket.setBuffer(!0),o.onClose()},this.websocket.onerror=function(e){o.onError(e)},this},t.util.ua.iDevice?i.prototype.send=function(e){var t=this;return setTimeout(function(){t.websocket.send(e)},0),this}:i.prototype.send=function(e){return this.websocket.send(e),this},i.prototype.payload=function(e){for(var t=0,n=e.length;t<n;t++)this.packet(e[t]);return this},i.prototype.close=function(){return this.websocket.close(),this},i.prototype.onError=function(e){this.socket.onError(e)},i.prototype.scheme=function(){return this.socket.options.secure?"wss":"ws"},i.check=function(){return"WebSocket"in n&&!("__addTask"in WebSocket)||"MozWebSocket"in n},i.xdomainCheck=function(){return!0},t.transports.push("websocket")}("undefined"!=typeof io?io.Transport:module.exports,"undefined"!=typeof io?io:module.parent.exports,window),function(e,t){function n(){t.Transport.websocket.apply(this,arguments)}e.flashsocket=n,t.util.inherit(n,t.Transport.websocket),n.prototype.name="flashsocket",n.prototype.open=function(){var e=this,n=arguments;return WebSocket.__addTask(function(){t.Transport.websocket.prototype.open.apply(e,n)}),this},n.prototype.send=function(){var e=this,n=arguments;return WebSocket.__addTask(function(){t.Transport.websocket.prototype.send.apply(e,n)}),this},n.prototype.close=function(){return WebSocket.__tasks.length=0,t.Transport.websocket.prototype.close.call(this),this},n.prototype.ready=function(e,i){function o(){var t=e.options,o=t["flash policy port"],s=["http"+(t.secure?"s":"")+":/",t.host+":"+t.port,t.resource,"static/flashsocket","WebSocketMain"+(e.isXDomain()?"Insecure":"")+".swf"];n.loaded||("undefined"==typeof WEB_SOCKET_SWF_LOCATION&&(WEB_SOCKET_SWF_LOCATION=s.join("/")),843!==o&&WebSocket.loadFlashPolicyFile("xmlsocket://"+t.host+":"+o),WebSocket.__initialize(),n.loaded=!0),i.call(r)}var r=this;return document.body?o():void t.util.load(o)},n.check=function(){return!!("undefined"!=typeof WebSocket&&"__initialize"in WebSocket&&swfobject)&&swfobject.getFlashPlayerVersion().major>=10},n.xdomainCheck=function(){return!0},"undefined"!=typeof window&&(window.WEB_SOCKET_DISABLE_AUTO_INITIALIZATION=!0),t.transports.push("flashsocket")}("undefined"!=typeof io?io.Transport:module.exports,"undefined"!=typeof io?io:module.parent.exports),"undefined"!=typeof window&&"undefined"!=typeof window.document)var swfobject=function(){function e(){if(!V){try{var e=U.getElementsByTagName("body")[0].appendChild(m("span"));e.parentNode.removeChild(e)}catch(aa){return}V=!0;for(var t=j.length,n=0;n<t;n++)j[n]()}}function t(e){V?e():j[j.length]=e}function n(e){if(typeof R.addEventListener!=k)R.addEventListener("load",e,!1);else if(typeof U.addEventListener!=k)U.addEventListener("load",e,!1);else if(typeof R.attachEvent!=k)y(R,"onload",e);else if("function"==typeof R.onload){var t=R.onload;R.onload=function(){t(),e()}}else R.onload=e}function i(){W?o():r()}function o(){var e=U.getElementsByTagName("body")[0],t=m(O);t.setAttribute("type",D);var n=e.appendChild(t);if(n){var i=0;!function(){if(typeof n.GetVariable!=k){var o=n.GetVariable("$version");o&&(o=o.split(" ")[1].split(","),Y.pv=[parseInt(o[0],10),parseInt(o[1],10),parseInt(o[2],10)])}else if(i<10)return i++,void setTimeout(arguments.callee,10);e.removeChild(t),n=null,r()}()}else r()}function r(){var e=B.length;if(e>0)for(var t=0;t<e;t++){var n=B[t].id,i=B[t].callbackFn,o={success:!1,id:n};if(Y.pv[0]>0){var r=v(n);if(r)if(!g(B[t].swfVersion)||Y.wk&&Y.wk<312)if(B[t].expressInstall&&a()){var l={};l.data=B[t].expressInstall,l.width=r.getAttribute("width")||"0",l.height=r.getAttribute("height")||"0",r.getAttribute("class")&&(l.styleclass=r.getAttribute("class")),r.getAttribute("align")&&(l.align=r.getAttribute("align"));for(var p={},f=r.getElementsByTagName("param"),h=f.length,d=0;d<h;d++)"movie"!=f[d].getAttribute("name").toLowerCase()&&(p[f[d].getAttribute("name")]=f[d].getAttribute("value"));c(l,p,n,i)}else u(r),i&&i(o);else _(n,!0),i&&(o.success=!0,o.ref=s(n),i(o))}else if(_(n,!0),i){var m=s(n);m&&typeof m.SetVariable!=k&&(o.success=!0,o.ref=m),i(o)}}}function s(e){var t=null,n=v(e);if(n&&"OBJECT"==n.nodeName)if(typeof n.SetVariable!=k)t=n;else{var i=n.getElementsByTagName(O)[0];i&&(t=i)}return t}function a(){return!$&&g("6.0.65")&&(Y.win||Y.mac)&&!(Y.wk&&Y.wk<312)}function c(e,t,n,i){$=!0,T=i||null,E={success:!1,id:n};var o=v(n);if(o){"OBJECT"==o.nodeName?(C=l(o),S=null):(C=o,S=n),e.id=N,(typeof e.width==k||!/%$/.test(e.width)&&parseInt(e.width,10)<310)&&(e.width="310"),(typeof e.height==k||!/%$/.test(e.height)&&parseInt(e.height,10)<137)&&(e.height="137"),U.title=U.title.slice(0,47)+" - Flash Player Installation";var r=Y.ie&&Y.win?["Active"].concat("").join("X"):"PlugIn",s="MMredirectURL="+R.location.toString().replace(/&/g,"%26")+"&MMplayerType="+r+"&MMdoctitle="+U.title;if(typeof t.flashvars!=k?t.flashvars+="&"+s:t.flashvars=s,Y.ie&&Y.win&&4!=o.readyState){var a=m("div");n+="SWFObjectNew",a.setAttribute("id",n),o.parentNode.insertBefore(a,o),o.style.display="none",function(){4==o.readyState?o.parentNode.removeChild(o):setTimeout(arguments.callee,10)}()}p(e,t,n)}}function u(e){if(Y.ie&&Y.win&&4!=e.readyState){var t=m("div");e.parentNode.insertBefore(t,e),t.parentNode.replaceChild(l(e),t),e.style.display="none",function(){4==e.readyState?e.parentNode.removeChild(e):setTimeout(arguments.callee,10)}()}else e.parentNode.replaceChild(l(e),e)}function l(e){var t=m("div");if(Y.win&&Y.ie)t.innerHTML=e.innerHTML;else{var n=e.getElementsByTagName(O)[0];if(n){var i=n.childNodes;if(i)for(var o=i.length,r=0;r<o;r++)1==i[r].nodeType&&"PARAM"==i[r].nodeName||8==i[r].nodeType||t.appendChild(i[r].cloneNode(!0))}}return t}function p(e,t,n){var i,o=v(n);if(Y.wk&&Y.wk<312)return i;if(o)if(typeof e.id==k&&(e.id=n),Y.ie&&Y.win){var r="";for(var s in e)e[s]!=Object.prototype[s]&&("data"==s.toLowerCase()?t.movie=e[s]:"styleclass"==s.toLowerCase()?r+=' class="'+e[s]+'"':"classid"!=s.toLowerCase()&&(r+=" "+s+'="'+e[s]+'"'));var a="";for(var c in t)t[c]!=Object.prototype[c]&&(a+='<param name="'+c+'" value="'+t[c]+'" />');o.outerHTML='<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"'+r+">"+a+"</object>",F[F.length]=e.id,i=v(e.id)}else{var u=m(O);u.setAttribute("type",D);for(var l in e)e[l]!=Object.prototype[l]&&("styleclass"==l.toLowerCase()?u.setAttribute("class",e[l]):"classid"!=l.toLowerCase()&&u.setAttribute(l,e[l]));for(var p in t)t[p]!=Object.prototype[p]&&"movie"!=p.toLowerCase()&&f(u,p,t[p]);o.parentNode.replaceChild(u,o),i=u}return i}function f(e,t,n){var i=m("param");i.setAttribute("name",t),i.setAttribute("value",n),e.appendChild(i)}function h(e){var t=v(e);t&&"OBJECT"==t.nodeName&&(Y.ie&&Y.win?(t.style.display="none",function(){4==t.readyState?d(e):setTimeout(arguments.callee,10)}()):t.parentNode.removeChild(t))}function d(e){var t=v(e);if(t){for(var n in t)"function"==typeof t[n]&&(t[n]=null);t.parentNode.removeChild(t)}}function v(e){var t=null;try{t=U.getElementById(e)}catch(Y){}return t}function m(e){return U.createElement(e)}function y(e,t,n){e.attachEvent(t,n),H[H.length]=[e,t,n]}function g(e){var t=Y.pv,n=e.split(".");return n[0]=parseInt(n[0],10),n[1]=parseInt(n[1],10)||0,n[2]=parseInt(n[2],10)||0,t[0]>n[0]||t[0]==n[0]&&t[1]>n[1]||t[0]==n[0]&&t[1]==n[1]&&t[2]>=n[2]}function b(e,t,n,i){if(!Y.ie||!Y.mac){var o=U.getElementsByTagName("head")[0];if(o){var r=n&&"string"==typeof n?n:"screen";if(i&&(x=null,I=null),!x||I!=r){var s=m("style");s.setAttribute("type","text/css"),s.setAttribute("media",r),x=o.appendChild(s),Y.ie&&Y.win&&typeof U.styleSheets!=k&&U.styleSheets.length>0&&(x=U.styleSheets[U.styleSheets.length-1]),I=r}Y.ie&&Y.win?x&&typeof x.addRule==O&&x.addRule(e,t):x&&typeof U.createTextNode!=k&&x.appendChild(U.createTextNode(e+" {"+t+"}"))}}}function _(e,t){if(q){var n=t?"visible":"hidden";V&&v(e)?v(e).style.visibility=n:b("#"+e,"visibility:"+n)}}function w(e){var t=/[\\\"<>\.;]/,n=null!=t.exec(e);return n&&typeof encodeURIComponent!=k?encodeURIComponent(e):e}var C,S,T,E,x,I,k="undefined",O="object",A="Shockwave Flash",M="ShockwaveFlash.ShockwaveFlash",D="application/x-shockwave-flash",N="SWFObjectExprInst",P="onreadystatechange",R=window,U=document,L=navigator,W=!1,j=[i],B=[],F=[],H=[],V=!1,$=!1,q=!0,Y=function(){var e=typeof U.getElementById!=k&&typeof U.getElementsByTagName!=k&&typeof U.createElement!=k,t=L.userAgent.toLowerCase(),n=L.platform.toLowerCase(),i=n?/win/.test(n):/win/.test(t),o=n?/mac/.test(n):/mac/.test(t),r=!!/webkit/.test(t)&&parseFloat(t.replace(/^.*webkit\/(\d+(\.\d+)?).*$/,"$1")),s=!1,a=[0,0,0],c=null;if(typeof L.plugins!=k&&typeof L.plugins[A]==O)c=L.plugins[A].description,!c||typeof L.mimeTypes!=k&&L.mimeTypes[D]&&!L.mimeTypes[D].enabledPlugin||(W=!0,s=!1,c=c.replace(/^.*\s+(\S+\s+\S+$)/,"$1"),a[0]=parseInt(c.replace(/^(.*)\..*$/,"$1"),10),a[1]=parseInt(c.replace(/^.*\.(.*)\s.*$/,"$1"),10),a[2]=/[a-zA-Z]/.test(c)?parseInt(c.replace(/^.*[a-zA-Z]+(.*)$/,"$1"),10):0);else if(typeof R[["Active"].concat("Object").join("X")]!=k)try{var u=new(window[["Active"].concat("Object").join("X")])(M);u&&(c=u.GetVariable("$version"),c&&(s=!0,c=c.split(" ")[1].split(","),a=[parseInt(c[0],10),parseInt(c[1],10),parseInt(c[2],10)]))}catch(Z){}return{w3:e,pv:a,wk:r,ie:s,win:i,mac:o}}();(function(){Y.w3&&((typeof U.readyState!=k&&"complete"==U.readyState||typeof U.readyState==k&&(U.getElementsByTagName("body")[0]||U.body))&&e(),V||(typeof U.addEventListener!=k&&U.addEventListener("DOMContentLoaded",e,!1),
Y.ie&&Y.win&&(U.attachEvent(P,function(){"complete"==U.readyState&&(U.detachEvent(P,arguments.callee),e())}),R==top&&!function(){if(!V){try{U.documentElement.doScroll("left")}catch(X){return void setTimeout(arguments.callee,0)}e()}}()),Y.wk&&!function(){if(!V)return/loaded|complete/.test(U.readyState)?void e():void setTimeout(arguments.callee,0)}(),n(e)))})(),function(){Y.ie&&Y.win&&window.attachEvent("onunload",function(){for(var e=H.length,t=0;t<e;t++)H[t][0].detachEvent(H[t][1],H[t][2]);for(var n=F.length,i=0;i<n;i++)h(F[i]);for(var o in Y)Y[o]=null;Y=null;for(var r in swfobject)swfobject[r]=null;swfobject=null})}();return{registerObject:function(e,t,n,i){if(Y.w3&&e&&t){var o={};o.id=e,o.swfVersion=t,o.expressInstall=n,o.callbackFn=i,B[B.length]=o,_(e,!1)}else i&&i({success:!1,id:e})},getObjectById:function(e){if(Y.w3)return s(e)},embedSWF:function(e,n,i,o,r,s,u,l,f,h){var d={success:!1,id:n};Y.w3&&!(Y.wk&&Y.wk<312)&&e&&n&&i&&o&&r?(_(n,!1),t(function(){i+="",o+="";var t={};if(f&&typeof f===O)for(var v in f)t[v]=f[v];t.data=e,t.width=i,t.height=o;var m={};if(l&&typeof l===O)for(var y in l)m[y]=l[y];if(u&&typeof u===O)for(var b in u)typeof m.flashvars!=k?m.flashvars+="&"+b+"="+u[b]:m.flashvars=b+"="+u[b];if(g(r)){var w=p(t,m,n);t.id==n&&_(n,!0),d.success=!0,d.ref=w}else{if(s&&a())return t.data=s,void c(t,m,n,h);_(n,!0)}h&&h(d)})):h&&h(d)},switchOffAutoHideShow:function(){q=!1},ua:Y,getFlashPlayerVersion:function(){return{major:Y.pv[0],minor:Y.pv[1],release:Y.pv[2]}},hasFlashPlayerVersion:g,createSWF:function(e,t,n){return Y.w3?p(e,t,n):void 0},showExpressInstall:function(e,t,n,i){Y.w3&&a()&&c(e,t,n,i)},removeSWF:function(e){Y.w3&&h(e)},createCSS:function(e,t,n,i){Y.w3&&b(e,t,n,i)},addDomLoadEvent:t,addLoadEvent:n,getQueryParamValue:function(e){var t=U.location.search||U.location.hash;if(t){if(/\?/.test(t)&&(t=t.split("?")[1]),null==e)return w(t);for(var n=t.split("&"),i=0;i<n.length;i++)if(n[i].substring(0,n[i].indexOf("="))==e)return w(n[i].substring(n[i].indexOf("=")+1))}return""},expressInstallCallback:function(){if($){var e=v(N);e&&C&&(e.parentNode.replaceChild(C,e),S&&(_(S,!0),Y.ie&&Y.win&&(C.style.display="block")),T&&T(E)),$=!1}}}}();!function(){if("undefined"!=typeof window&&!window.WebSocket){var e=window.console;if(e&&e.log&&e.error||(e={log:function(){},error:function(){}}),!swfobject.hasFlashPlayerVersion("10.0.0"))return void e.error("Flash Player >= 10.0.0 is required.");"file:"==location.protocol&&e.error("WARNING: web-socket-js doesn't work in file:///... URL unless you set Flash Security Settings properly. Open the page via Web server i.e. http://..."),WebSocket=function(e,t,n,i,o){var r=this;r.__id=WebSocket.__nextId++,WebSocket.__instances[r.__id]=r,r.readyState=WebSocket.CONNECTING,r.bufferedAmount=0,r.__events={},t?"string"==typeof t&&(t=[t]):t=[],setTimeout(function(){WebSocket.__addTask(function(){WebSocket.__flash.create(r.__id,e,t,n||null,i||0,o||null)})},0)},WebSocket.prototype.send=function(e){if(this.readyState==WebSocket.CONNECTING)throw"INVALID_STATE_ERR: Web Socket connection has not been established";var t=WebSocket.__flash.send(this.__id,encodeURIComponent(e));return t<0||(this.bufferedAmount+=t,!1)},WebSocket.prototype.close=function(){this.readyState!=WebSocket.CLOSED&&this.readyState!=WebSocket.CLOSING&&(this.readyState=WebSocket.CLOSING,WebSocket.__flash.close(this.__id))},WebSocket.prototype.addEventListener=function(e,t,n){e in this.__events||(this.__events[e]=[]),this.__events[e].push(t)},WebSocket.prototype.removeEventListener=function(e,t,n){if(e in this.__events)for(var i=this.__events[e],o=i.length-1;o>=0;--o)if(i[o]===t){i.splice(o,1);break}},WebSocket.prototype.dispatchEvent=function(e){for(var t=this.__events[e.type]||[],n=0;n<t.length;++n)t[n](e);var i=this["on"+e.type];i&&i(e)},WebSocket.prototype.__handleEvent=function(e){"readyState"in e&&(this.readyState=e.readyState),"protocol"in e&&(this.protocol=e.protocol);var t;if("open"==e.type||"error"==e.type)t=this.__createSimpleEvent(e.type);else if("close"==e.type)t=this.__createSimpleEvent("close");else{if("message"!=e.type)throw"unknown event type: "+e.type;var n=decodeURIComponent(e.message);t=this.__createMessageEvent("message",n)}this.dispatchEvent(t)},WebSocket.prototype.__createSimpleEvent=function(e){if(document.createEvent&&window.Event){var t=document.createEvent("Event");return t.initEvent(e,!1,!1),t}return{type:e,bubbles:!1,cancelable:!1}},WebSocket.prototype.__createMessageEvent=function(e,t){if(document.createEvent&&window.MessageEvent&&!window.opera){var n=document.createEvent("MessageEvent");return n.initMessageEvent("message",!1,!1,t,null,null,window,null),n}return{type:e,data:t,bubbles:!1,cancelable:!1}},WebSocket.CONNECTING=0,WebSocket.OPEN=1,WebSocket.CLOSING=2,WebSocket.CLOSED=3,WebSocket.__flash=null,WebSocket.__instances={},WebSocket.__tasks=[],WebSocket.__nextId=0,WebSocket.loadFlashPolicyFile=function(e){WebSocket.__addTask(function(){WebSocket.__flash.loadManualPolicyFile(e)})},WebSocket.__initialize=function(){if(!WebSocket.__flash){if(WebSocket.__swfLocation&&(window.WEB_SOCKET_SWF_LOCATION=WebSocket.__swfLocation),!window.WEB_SOCKET_SWF_LOCATION)return void e.error("[WebSocket] set WEB_SOCKET_SWF_LOCATION to location of WebSocketMain.swf");var t=document.createElement("div");t.id="webSocketContainer",t.style.position="absolute",WebSocket.__isFlashLite()?(t.style.left="0px",t.style.top="0px"):(t.style.left="-100px",t.style.top="-100px");var n=document.createElement("div");n.id="webSocketFlash",t.appendChild(n),document.body.appendChild(t),swfobject.embedSWF(WEB_SOCKET_SWF_LOCATION,"webSocketFlash","1","1","10.0.0",null,null,{hasPriority:!0,swliveconnect:!0,allowScriptAccess:"always"},null,function(t){t.success||e.error("[WebSocket] swfobject.embedSWF failed")})}},WebSocket.__onFlashInitialized=function(){setTimeout(function(){WebSocket.__flash=document.getElementById("webSocketFlash"),WebSocket.__flash.setCallerUrl(location.href),WebSocket.__flash.setDebug(!!window.WEB_SOCKET_DEBUG);for(var e=0;e<WebSocket.__tasks.length;++e)WebSocket.__tasks[e]();WebSocket.__tasks=[]},0)},WebSocket.__onFlashEvent=function(){return setTimeout(function(){try{for(var t=WebSocket.__flash.receiveEvents(),n=0;n<t.length;++n)WebSocket.__instances[t[n].webSocketId].__handleEvent(t[n])}catch(e){e.error(e)}},0),!0};var t=function(){var e=function(e,t){t=t||2;for(var n=""+e;n.length<t;)n="0"+n;return n},t=new Date,n=t.getFullYear()+"-"+e(t.getMonth()+1)+"-"+e(t.getDate())+" "+e(t.getHours())+":"+e(t.getMinutes())+":"+e(t.getSeconds())+":"+e(t.getMilliseconds(),3);return n};WebSocket.__log=function(n){e.log(t(),decodeURIComponent(n))},WebSocket.__error=function(n){e.error(t(),decodeURIComponent(n))},WebSocket.__addTask=function(e){WebSocket.__flash?e():WebSocket.__tasks.push(e)},WebSocket.__isFlashLite=function(){if(!window.navigator||!window.navigator.mimeTypes)return!1;var e=window.navigator.mimeTypes["application/x-shockwave-flash"];return!!(e&&e.enabledPlugin&&e.enabledPlugin.filename)&&!!e.enabledPlugin.filename.match(/flashlite/i)},window.WEB_SOCKET_DISABLE_AUTO_INITIALIZATION||(window.addEventListener?window.addEventListener("load",function(){WebSocket.__initialize()},!1):window.attachEvent("onload",function(){WebSocket.__initialize()}))}}(),function(e,t,n){function i(e){e&&(t.Transport.apply(this,arguments),this.sendBuffer=[])}function o(){}e.XHR=i,t.util.inherit(i,t.Transport),i.prototype.open=function(){return this.socket.setBuffer(!1),this.onOpen(),this.get(),this.setCloseTimeout(),this},i.prototype.payload=function(e){for(var n=[],i=0,o=e.length;i<o;i++)n.push(t.parser.encodePacket(e[i]));this.send(t.parser.encodePayload(n))},i.prototype.send=function(e){return this.post(e),this},i.prototype.post=function(e){function t(){4==this.readyState&&(this.onreadystatechange=o,r.posting=!1,200==this.status?r.socket.setBuffer(!1):r.onClose())}function i(){this.onload=o,r.socket.setBuffer(!1)}var r=this;this.socket.setBuffer(!0),this.sendXHR=this.request("POST"),n.XDomainRequest&&this.sendXHR instanceof XDomainRequest?this.sendXHR.onload=this.sendXHR.onerror=i:this.sendXHR.onreadystatechange=t,this.sendXHR.send(e)},i.prototype.close=function(){return this.onClose(),this},i.prototype.request=function(e){var n=t.util.request(this.socket.isXDomain()),i=t.util.query(this.socket.options.query,"t="+ +new Date);if(n.open(e||"GET",this.prepareUrl()+i,!0),"POST"==e)try{n.setRequestHeader?n.setRequestHeader("Content-type","text/plain;charset=UTF-8"):n.contentType="text/plain"}catch(e){}return n},i.prototype.scheme=function(){return this.socket.options.secure?"https":"http"},i.check=function(e,i){try{var o=t.util.request(i),r=n.XDomainRequest&&o instanceof XDomainRequest,s=e&&e.options&&e.options.secure?"https:":"http:",a=n.location&&s!=n.location.protocol;if(o&&(!r||!a))return!0}catch(e){}return!1},i.xdomainCheck=function(e){return i.check(e,!0)}}("undefined"!=typeof io?io.Transport:module.exports,"undefined"!=typeof io?io:module.parent.exports,window),function(e,t){function n(e){t.Transport.XHR.apply(this,arguments)}e.htmlfile=n,t.util.inherit(n,t.Transport.XHR),n.prototype.name="htmlfile",n.prototype.get=function(){this.doc=new(window[["Active"].concat("Object").join("X")])("htmlfile"),this.doc.open(),this.doc.write("<html></html>"),this.doc.close(),this.doc.parentWindow.s=this;var e=this.doc.createElement("div");e.className="socketio",this.doc.body.appendChild(e),this.iframe=this.doc.createElement("iframe"),e.appendChild(this.iframe);var n=this,i=t.util.query(this.socket.options.query,"t="+ +new Date);this.iframe.src=this.prepareUrl()+i,t.util.on(window,"unload",function(){n.destroy()})},n.prototype._=function(e,t){this.onData(e);try{var n=t.getElementsByTagName("script")[0];n.parentNode.removeChild(n)}catch(e){}},n.prototype.destroy=function(){if(this.iframe){try{this.iframe.src="about:blank"}catch(e){}this.doc=null,this.iframe.parentNode.removeChild(this.iframe),this.iframe=null,CollectGarbage()}},n.prototype.close=function(){return this.destroy(),t.Transport.XHR.prototype.close.call(this)},n.check=function(e){if("undefined"!=typeof window&&["Active"].concat("Object").join("X")in window)try{var n=new(window[["Active"].concat("Object").join("X")])("htmlfile");return n&&t.Transport.XHR.check(e)}catch(e){}return!1},n.xdomainCheck=function(){return!1},t.transports.push("htmlfile")}("undefined"!=typeof io?io.Transport:module.exports,"undefined"!=typeof io?io:module.parent.exports),function(e,t,n){function i(){t.Transport.XHR.apply(this,arguments)}function o(){}e["xhr-polling"]=i,t.util.inherit(i,t.Transport.XHR),t.util.merge(i,t.Transport.XHR),i.prototype.name="xhr-polling",i.prototype.heartbeats=function(){return!1},i.prototype.open=function(){var e=this;return t.Transport.XHR.prototype.open.call(e),!1},i.prototype.get=function(){function e(){4==this.readyState&&(this.onreadystatechange=o,200==this.status?(r.onData(this.responseText),r.get()):r.onClose())}function t(){this.onload=o,this.onerror=o,r.retryCounter=1,r.onData(this.responseText),r.get()}function i(){r.retryCounter++,!r.retryCounter||r.retryCounter>3?r.onClose():r.get()}if(this.isOpen){var r=this;this.xhr=this.request(),n.XDomainRequest&&this.xhr instanceof XDomainRequest?(this.xhr.onload=t,this.xhr.onerror=i):this.xhr.onreadystatechange=e,this.xhr.send(null)}},i.prototype.onClose=function(){if(t.Transport.XHR.prototype.onClose.call(this),this.xhr){this.xhr.onreadystatechange=this.xhr.onload=this.xhr.onerror=o;try{this.xhr.abort()}catch(e){}this.xhr=null}},i.prototype.ready=function(e,n){var i=this;t.util.defer(function(){n.call(i)})},t.transports.push("xhr-polling")}("undefined"!=typeof io?io.Transport:module.exports,"undefined"!=typeof io?io:module.parent.exports,window),function(e,t,n){function i(e){t.Transport["xhr-polling"].apply(this,arguments),this.index=t.j.length;var n=this;t.j.push(function(e){n._(e)})}var o=n.document&&"MozAppearance"in n.document.documentElement.style;e["jsonp-polling"]=i,t.util.inherit(i,t.Transport["xhr-polling"]),i.prototype.name="jsonp-polling",i.prototype.post=function(e){function n(){i(),o.socket.setBuffer(!1)}function i(){o.iframe&&o.form.removeChild(o.iframe);try{s=document.createElement('<iframe name="'+o.iframeId+'">')}catch(e){s=document.createElement("iframe"),s.name=o.iframeId}s.id=o.iframeId,o.form.appendChild(s),o.iframe=s}var o=this,r=t.util.query(this.socket.options.query,"t="+ +new Date+"&i="+this.index);if(!this.form){var s,a=document.createElement("form"),c=document.createElement("textarea"),u=this.iframeId="socketio_iframe_"+this.index;a.className="socketio",a.style.position="absolute",a.style.top="0px",a.style.left="0px",a.style.display="none",a.target=u,a.method="POST",a.setAttribute("accept-charset","utf-8"),c.name="d",a.appendChild(c),document.body.appendChild(a),this.form=a,this.area=c}this.form.action=this.prepareUrl()+r,i(),this.area.value=t.JSON.stringify(e);try{this.form.submit()}catch(e){}this.iframe.attachEvent?s.onreadystatechange=function(){"complete"==o.iframe.readyState&&n()}:this.iframe.onload=n,this.socket.setBuffer(!0)},i.prototype.get=function(){var e=this,n=document.createElement("script"),i=t.util.query(this.socket.options.query,"t="+ +new Date+"&i="+this.index);this.script&&(this.script.parentNode.removeChild(this.script),this.script=null),n.async=!0,n.src=this.prepareUrl()+i,n.onerror=function(){e.onClose()};var r=document.getElementsByTagName("script")[0];r.parentNode.insertBefore(n,r),this.script=n,o&&setTimeout(function(){var e=document.createElement("iframe");document.body.appendChild(e),document.body.removeChild(e)},100)},i.prototype._=function(e){return this.onData(e),this.isOpen&&this.get(),this},i.prototype.ready=function(e,n){var i=this;return o?void t.util.load(function(){n.call(i)}):n.call(this)},i.check=function(){return"document"in n},i.xdomainCheck=function(){return!0},t.transports.push("jsonp-polling")}("undefined"!=typeof io?io.Transport:module.exports,"undefined"!=typeof io?io:module.parent.exports,window),__WEBPACK_AMD_DEFINE_ARRAY__=[],__WEBPACK_AMD_DEFINE_RESULT__=function(){return io}.apply(exports,__WEBPACK_AMD_DEFINE_ARRAY__),!(void 0!==__WEBPACK_AMD_DEFINE_RESULT__&&(module.exports=__WEBPACK_AMD_DEFINE_RESULT__))}()}).call(exports,__webpack_require__(14)(module))},22:function(e,t){function n(e,t){for(var n=t.split(".");n.length;){var i=n.shift(),o=!1;if("?"==i[i.length-1]&&(i=i.slice(0,-1),o=!0),e=e[i],!e&&o)return e}return e}e.exports=n},28:function(e,t){e.exports=function n(e,t){"use strict";var i,o,r=/(^([+\-]?(?:0|[1-9]\d*)(?:\.\d*)?(?:[eE][+\-]?\d+)?)?$|^0x[0-9a-f]+$|\d+)/gi,s=/(^[ ]*|[ ]*$)/g,a=/(^([\w ]+,?[\w ]+)?[\w ]+,?[\w ]+\d+:\d+(:\d+)?[\w ]?|^\d{1,4}[\/\-]\d{1,4}[\/\-]\d{1,4}|^\w+, \w+ \d+, \d{4})/,c=/^0x[0-9a-f]+$/i,u=/^0/,l=function(e){return n.insensitive&&(""+e).toLowerCase()||""+e},p=l(e).replace(s,"")||"",f=l(t).replace(s,"")||"",h=p.replace(r,"\0$1\0").replace(/\0$/,"").replace(/^\0/,"").split("\0"),d=f.replace(r,"\0$1\0").replace(/\0$/,"").replace(/^\0/,"").split("\0"),v=parseInt(p.match(c),16)||1!==h.length&&p.match(a)&&Date.parse(p),m=parseInt(f.match(c),16)||v&&f.match(a)&&Date.parse(f)||null;if(m){if(v<m)return-1;if(v>m)return 1}for(var y=0,g=Math.max(h.length,d.length);y<g;y++){if(i=!(h[y]||"").match(u)&&parseFloat(h[y])||h[y]||0,o=!(d[y]||"").match(u)&&parseFloat(d[y])||d[y]||0,isNaN(i)!==isNaN(o))return isNaN(i)?1:-1;if(typeof i!=typeof o&&(i+="",o+=""),i<o)return-1;if(i>o)return 1}return 0}},33:function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}t.__esModule=!0,t["default"]=function(e){if(!e.url||!e.data)return Promise.reject("参数不完整，无法发起请求");var t={method:e.type||"get",url:e.url,responseType:e.dataType||"json"};return/^get$/gi.test(t.method)&&(t.params=e.data),/^post$/gi.test(t.method)&&(t.data=e.data),(0,r["default"])(t)};var o=n(72),r=i(o);e.exports=t["default"]},44:function(e,t,n){(function(e){"use strict";"undefined"!=typeof window&&(window.console||e.env.WEIXIN_APP||(window.console={log:function(){},info:function(){},warn:function(){},error:function(){}}))}).call(t,n(7))},45:function(e,t,n){"use strict";var i=n(1);i.fillPropertyWithDefault=function(e,t,n){return!!i.undef(e[t])&&(e[t]=n,!0)}},47:function(e,t){},55:function(e,t){"use strict";function n(e){i(e.enable)&&(this.enable=e.enable?1:0),i(e.needBadge)&&(this.needBadge=e.needBadge?1:0),i(e.needPushNick)&&(this.needPushNick=e.needPushNick?1:0),i(e.pushContent)&&(this.pushContent=""+e.pushContent),i(e.custom)&&(this.custom=""+e.custom),i(e.pushPayload)&&(this.pushPayload=""+e.pushPayload),i(e.sound)&&(this.sound=""+e.sound),i(e.webrtcEnable)&&(this.webrtcEnable=e.webrtcEnable?1:0)}t.__esModule=!0,t["default"]=function(e){var t=e.util;return i=t.notundef,n};var i=void 0;e.exports=t["default"]},67:function(e,t){"use strict";var n={};n.html2node=function(e){var t=document.createElement("div");t.innerHTML=e;var n,i,o=[];if(t.children)for(n=0,i=t.children.length;n<i;n++)o.push(t.children[n]);else for(n=0,i=t.childNodes.length;n<i;n++){var r=t.childNodes[n];1===r.nodeType&&o.push(r)}return o.length>1?t:o[0]},n.n2node=function(e){return e?/HTML.+Element/gi.test(e)?e:e[0]&&/HTML.+Element/gi.test(e[0])?e[0]:null:null},e.exports=n},72:function(e,t,n){(function(t){!function(t,n){e.exports=n()}(this,function(){return function(e){function t(i){if(n[i])return n[i].exports;var o=n[i]={exports:{},id:i,loaded:!1};return e[i].call(o.exports,o,o.exports,t),o.loaded=!0,o.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(e,t,n){e.exports=n(1)},function(e,t,n){"use strict";function i(e){var t=new s(e),n=r(s.prototype.request,t);return o.extend(n,s.prototype,t),o.extend(n,t),n}var o=n(2),r=n(3),s=n(4),a=n(5),c=i(a);c.Axios=s,c.create=function(e){return i(o.merge(a,e))},c.Cancel=n(22),c.CancelToken=n(23),c.isCancel=n(19),c.all=function(e){return Promise.all(e)},c.spread=n(24),e.exports=c,e.exports["default"]=c},function(e,t,n){"use strict";function i(e){return"[object Array]"===S.call(e)}function o(e){return"[object ArrayBuffer]"===S.call(e)}function r(e){return"undefined"!=typeof FormData&&e instanceof FormData}function s(e){var t;return t="undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(e):e&&e.buffer&&e.buffer instanceof ArrayBuffer}function a(e){return"string"==typeof e}function c(e){return"number"==typeof e}function u(e){return"undefined"==typeof e}function l(e){return null!==e&&"object"==typeof e}function p(e){return"[object Date]"===S.call(e)}function f(e){return"[object File]"===S.call(e)}function h(e){return"[object Blob]"===S.call(e)}function d(e){return"[object Function]"===S.call(e)}function v(e){return l(e)&&d(e.pipe)}function m(e){return"undefined"!=typeof URLSearchParams&&e instanceof URLSearchParams}function y(e){return e.replace(/^\s*/,"").replace(/\s*$/,"")}function g(){return"undefined"!=typeof window&&"undefined"!=typeof document&&"function"==typeof document.createElement}function b(e,t){if(null!==e&&"undefined"!=typeof e)if("object"==typeof e||i(e)||(e=[e]),i(e))for(var n=0,o=e.length;n<o;n++)t.call(null,e[n],n,e);else for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.call(null,e[r],r,e)}function _(){function e(e,n){"object"==typeof t[n]&&"object"==typeof e?t[n]=_(t[n],e):t[n]=e}for(var t={},n=0,i=arguments.length;n<i;n++)b(arguments[n],e);return t}function w(e,t,n){return b(t,function(t,i){n&&"function"==typeof t?e[i]=C(t,n):e[i]=t}),e}var C=n(3),S=Object.prototype.toString;e.exports={isArray:i,isArrayBuffer:o,isFormData:r,isArrayBufferView:s,isString:a,isNumber:c,isObject:l,isUndefined:u,isDate:p,isFile:f,isBlob:h,isFunction:d,isStream:v,isURLSearchParams:m,isStandardBrowserEnv:g,forEach:b,merge:_,extend:w,trim:y}},function(e,t){"use strict";e.exports=function(e,t){return function(){for(var n=new Array(arguments.length),i=0;i<n.length;i++)n[i]=arguments[i];return e.apply(t,n)}}},function(e,t,n){"use strict";function i(e){this.defaults=e,this.interceptors={request:new s,response:new s}}var o=n(5),r=n(2),s=n(16),a=n(17),c=n(20),u=n(21);i.prototype.request=function(e){"string"==typeof e&&(e=r.merge({url:arguments[0]},arguments[1])),e=r.merge(o,this.defaults,{method:"get"},e),e.baseURL&&!c(e.url)&&(e.url=u(e.baseURL,e.url));var t=[a,void 0],n=Promise.resolve(e);for(this.interceptors.request.forEach(function(e){t.unshift(e.fulfilled,e.rejected)}),this.interceptors.response.forEach(function(e){t.push(e.fulfilled,e.rejected)});t.length;)n=n.then(t.shift(),t.shift());return n},r.forEach(["delete","get","head"],function(e){i.prototype[e]=function(t,n){return this.request(r.merge(n||{},{method:e,url:t}))}}),r.forEach(["post","put","patch"],function(e){i.prototype[e]=function(t,n,i){return this.request(r.merge(i||{},{method:e,url:t,data:n}))}}),e.exports=i},function(e,n,i){"use strict";function o(e,t){!s.isUndefined(e)&&s.isUndefined(e["Content-Type"])&&(e["Content-Type"]=t)}function r(){var e;return"undefined"!=typeof XMLHttpRequest?e=i(7):"undefined"!=typeof t&&(e=i(7)),e}var s=i(2),a=i(6),c=/^\)\]\}',?\n/,u={"Content-Type":"application/x-www-form-urlencoded"},l={adapter:r(),transformRequest:[function(e,t){return a(t,"Content-Type"),s.isFormData(e)||s.isArrayBuffer(e)||s.isStream(e)||s.isFile(e)||s.isBlob(e)?e:s.isArrayBufferView(e)?e.buffer:s.isURLSearchParams(e)?(o(t,"application/x-www-form-urlencoded;charset=utf-8"),e.toString()):s.isObject(e)?(o(t,"application/json;charset=utf-8"),JSON.stringify(e)):e}],transformResponse:[function(e){if("string"==typeof e){e=e.replace(c,"");try{e=JSON.parse(e)}catch(e){}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,validateStatus:function(e){return e>=200&&e<300}};l.headers={common:{Accept:"application/json, text/plain, */*"}},s.forEach(["delete","get","head"],function(e){l.headers[e]={}}),s.forEach(["post","put","patch"],function(e){l.headers[e]=s.merge(u)}),e.exports=l},function(e,t,n){"use strict";var i=n(2);e.exports=function(e,t){i.forEach(e,function(n,i){i!==t&&i.toUpperCase()===t.toUpperCase()&&(e[t]=n,delete e[i])})}},function(e,t,n){"use strict";var i=n(2),o=n(8),r=n(11),s=n(12),a=n(13),c=n(9),u="undefined"!=typeof window&&window.btoa&&window.btoa.bind(window)||n(14);e.exports=function(e){return new Promise(function(t,l){var p=e.data,f=e.headers;i.isFormData(p)&&delete f["Content-Type"];var h=new XMLHttpRequest,d="onreadystatechange",v=!1;if("undefined"==typeof window||!window.XDomainRequest||"withCredentials"in h||a(e.url)||(h=new window.XDomainRequest,d="onload",v=!0,h.onprogress=function(){},h.ontimeout=function(){}),e.auth){var m=e.auth.username||"",y=e.auth.password||"";f.Authorization="Basic "+u(m+":"+y)}if(h.open(e.method.toUpperCase(),r(e.url,e.params,e.paramsSerializer),!0),h.timeout=e.timeout,h[d]=function(){if(h&&(4===h.readyState||v)&&(0!==h.status||h.responseURL&&0===h.responseURL.indexOf("file:"))){var n="getAllResponseHeaders"in h?s(h.getAllResponseHeaders()):null,i=e.responseType&&"text"!==e.responseType?h.response:h.responseText,r={data:i,status:1223===h.status?204:h.status,statusText:1223===h.status?"No Content":h.statusText,headers:n,config:e,request:h};o(t,l,r),h=null}},h.onerror=function(){l(c("Network Error",e)),h=null},h.ontimeout=function(){l(c("timeout of "+e.timeout+"ms exceeded",e,"ECONNABORTED")),h=null},i.isStandardBrowserEnv()){var g=n(15),b=(e.withCredentials||a(e.url))&&e.xsrfCookieName?g.read(e.xsrfCookieName):void 0;b&&(f[e.xsrfHeaderName]=b)}if("setRequestHeader"in h&&i.forEach(f,function(e,t){"undefined"==typeof p&&"content-type"===t.toLowerCase()?delete f[t]:h.setRequestHeader(t,e)}),e.withCredentials&&(h.withCredentials=!0),e.responseType)try{h.responseType=e.responseType}catch(e){if("json"!==h.responseType)throw e}"function"==typeof e.onDownloadProgress&&h.addEventListener("progress",e.onDownloadProgress),"function"==typeof e.onUploadProgress&&h.upload&&h.upload.addEventListener("progress",e.onUploadProgress),e.cancelToken&&e.cancelToken.promise.then(function(e){h&&(h.abort(),l(e),h=null)}),void 0===p&&(p=null),h.send(p)})}},function(e,t,n){"use strict";var i=n(9);e.exports=function(e,t,n){var o=n.config.validateStatus;n.status&&o&&!o(n.status)?t(i("Request failed with status code "+n.status,n.config,null,n)):e(n)}},function(e,t,n){"use strict";var i=n(10);e.exports=function(e,t,n,o){var r=new Error(e);return i(r,t,n,o)}},function(e,t){"use strict";e.exports=function(e,t,n,i){return e.config=t,n&&(e.code=n),e.response=i,e}},function(e,t,n){"use strict";function i(e){return encodeURIComponent(e).replace(/%40/gi,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}var o=n(2);e.exports=function(e,t,n){if(!t)return e;var r;if(n)r=n(t);else if(o.isURLSearchParams(t))r=t.toString();else{var s=[];o.forEach(t,function(e,t){null!==e&&"undefined"!=typeof e&&(o.isArray(e)&&(t+="[]"),o.isArray(e)||(e=[e]),o.forEach(e,function(e){o.isDate(e)?e=e.toISOString():o.isObject(e)&&(e=JSON.stringify(e)),s.push(i(t)+"="+i(e))}))}),r=s.join("&")}return r&&(e+=(e.indexOf("?")===-1?"?":"&")+r),e}},function(e,t,n){"use strict";var i=n(2);e.exports=function(e){var t,n,o,r={};return e?(i.forEach(e.split("\n"),function(e){o=e.indexOf(":"),t=i.trim(e.substr(0,o)).toLowerCase(),n=i.trim(e.substr(o+1)),t&&(r[t]=r[t]?r[t]+", "+n:n)}),r):r}},function(e,t,n){"use strict";var i=n(2);e.exports=i.isStandardBrowserEnv()?function(){function e(e){var t=e;return n&&(o.setAttribute("href",t),t=o.href),o.setAttribute("href",t),{href:o.href,protocol:o.protocol?o.protocol.replace(/:$/,""):"",host:o.host,search:o.search?o.search.replace(/^\?/,""):"",hash:o.hash?o.hash.replace(/^#/,""):"",hostname:o.hostname,port:o.port,pathname:"/"===o.pathname.charAt(0)?o.pathname:"/"+o.pathname}}var t,n=/(msie|trident)/i.test(navigator.userAgent),o=document.createElement("a");return t=e(window.location.href),function(n){var o=i.isString(n)?e(n):n;return o.protocol===t.protocol&&o.host===t.host}}():function(){return function(){return!0}}()},function(e,t){"use strict";function n(){this.message="String contains an invalid character"}function i(e){for(var t,i,r=String(e),s="",a=0,c=o;r.charAt(0|a)||(c="=",a%1);s+=c.charAt(63&t>>8-a%1*8)){if(i=r.charCodeAt(a+=.75),i>255)throw new n;t=t<<8|i}return s}var o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";n.prototype=new Error,n.prototype.code=5,n.prototype.name="InvalidCharacterError",e.exports=i},function(e,t,n){"use strict";var i=n(2);e.exports=i.isStandardBrowserEnv()?function(){return{write:function(e,t,n,o,r,s){var a=[];a.push(e+"="+encodeURIComponent(t)),i.isNumber(n)&&a.push("expires="+new Date(n).toGMTString()),i.isString(o)&&a.push("path="+o),i.isString(r)&&a.push("domain="+r),s===!0&&a.push("secure"),document.cookie=a.join("; ")},read:function(e){var t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove:function(e){this.write(e,"",Date.now()-864e5)}}}():function(){return{write:function(){},read:function(){return null},remove:function(){}}}()},function(e,t,n){"use strict";function i(){this.handlers=[]}var o=n(2);i.prototype.use=function(e,t){return this.handlers.push({fulfilled:e,rejected:t}),this.handlers.length-1},i.prototype.eject=function(e){this.handlers[e]&&(this.handlers[e]=null)},i.prototype.forEach=function(e){o.forEach(this.handlers,function(t){null!==t&&e(t)})},e.exports=i},function(e,t,n){"use strict";function i(e){e.cancelToken&&e.cancelToken.throwIfRequested()}var o=n(2),r=n(18),s=n(19),a=n(5);e.exports=function(e){i(e),e.headers=e.headers||{},e.data=r(e.data,e.headers,e.transformRequest),e.headers=o.merge(e.headers.common||{},e.headers[e.method]||{},e.headers||{}),o.forEach(["delete","get","head","post","put","patch","common"],function(t){delete e.headers[t]});var t=e.adapter||a.adapter;return t(e).then(function(t){return i(e),t.data=r(t.data,t.headers,e.transformResponse),t},function(t){return s(t)||(i(e),t&&t.response&&(t.response.data=r(t.response.data,t.response.headers,e.transformResponse))),Promise.reject(t)})}},function(e,t,n){"use strict";var i=n(2);e.exports=function(e,t,n){return i.forEach(n,function(n){e=n(e,t)}),e}},function(e,t){"use strict";e.exports=function(e){return!(!e||!e.__CANCEL__)}},function(e,t){"use strict";e.exports=function(e){return/^([a-z][a-z\d\+\-\.]*:)?\/\//i.test(e)}},function(e,t){"use strict";e.exports=function(e,t){return e.replace(/\/+$/,"")+"/"+t.replace(/^\/+/,"")}},function(e,t){"use strict";function n(e){this.message=e}n.prototype.toString=function(){return"Cancel"+(this.message?": "+this.message:"")},n.prototype.__CANCEL__=!0,e.exports=n},function(e,t,n){"use strict";function i(e){if("function"!=typeof e)throw new TypeError("executor must be a function.");var t;this.promise=new Promise(function(e){t=e});var n=this;e(function(e){n.reason||(n.reason=new o(e),t(n.reason))})}var o=n(22);i.prototype.throwIfRequested=function(){if(this.reason)throw this.reason},i.source=function(){var e,t=new i(function(t){e=t});return{token:t,cancel:e}},e.exports=i},function(e,t){"use strict";e.exports=function(e){return function(t){return e.apply(null,t)}}}])})}).call(t,n(7))},85:function(e,t,n){"use strict";t.__esModule=!0;var i,o,r,s,a=n(17),c={CONTROL_COMMAND_NOTIFY_AUDIO_ON:1,CONTROL_COMMAND_NOTIFY_AUDIO_OFF:2,CONTROL_COMMAND_NOTIFY_VIDEO_ON:3,CONTROL_COMMAND_NOTIFY_VIDEO_OFF:4,CONTROL_COMMAND_SWITCH_AUDIO_TO_VIDEO:5,CONTROL_COMMAND_SWITCH_AUDIO_TO_VIDEO_AGREE:6,CONTROL_COMMAND_SWITCH_AUDIO_TO_VIDEO_REJECT:7,CONTROL_COMMAND_SWITCH_VIDEO_TO_AUDIO:8,CONTROL_COMMAND_BUSY:9,CONTROL_COMMAND_SELF_CAMERA_INVALID:10,CONTROL_COMMAND_SELF_AUDIO_INVALID:11,CONTROL_COMMAND_SELF_ON_BACKGROUND:12,CONTROL_COMMAND_START_NOTIFY_RECEIVED:13,CONTROL_COMMAND_NOTIFY_RECORD_START:14,CONTROL_COMMAND_NOTIFY_RECORD_STOP:15},u={HANGUP_TYPE_NORMAL:0,HANGUP_TYPE_TIMEOUT:-1},l={NETCALL_TYPE_AUDIO:1,NETCALL_TYPE_VIDEO:2,DEVICE_TYPE_AUDIO_IN:0,DEVICE_TYPE_AUDIO_OUT_LOCAL:1,DEVICE_TYPE_AUDIO_OUT_CHAT:2,DEVICE_TYPE_VIDEO:3,DEVICE_TYPE_DESKTOP_SCREEN:4,DEVICE_TYPE_DESKTOP_WINDOW:5,CHAT_VIDEO_QUALITY_NORMAL:0,CHAT_VIDEO_QUALITY_LOW:1,CHAT_VIDEO_QUALITY_MEDIUM:2,CHAT_VIDEO_QUALITY_HIGH:3,CHAT_VIDEO_QUALITY_480P:4,CHAT_VIDEO_QUALITY_540P:5,CHAT_VIDEO_QUALITY_720P:6,CHAT_VIDEO_FRAME_RATE_NORMAL:0,CHAT_VIDEO_FRAME_RATE_5:1,CHAT_VIDEO_FRAME_RATE_10:2,CHAT_VIDEO_FRAME_RATE_15:3,CHAT_VIDEO_FRAME_RATE_20:4,CHAT_VIDEO_FRAME_RATE_25:5,LAYOUT_SPLITBOTTOMHORFLOATING:0,LAYOUT_SPLITTOPHORFLOATING:1,LAYOUT_SPLITLATTICETILE:2,LAYOUT_SPLITLATTICECUTTINGTILE:3,LAYOUT_SPLITCUSTOM:4},p={WB_TYPE_TCP:2,WB_TYPE_UDP:3,CALL_TYPE_NONE:0,CALL_TYPE_AUDIO:1,HANGUP_TYPE_NORMAL:0,HANGUP_TYPE_TIMEOUT:-1};l.deviceTypeMap=(i={},i[l.DEVICE_TYPE_AUDIO_IN]="audioIn",i[l.DEVICE_TYPE_AUDIO_OUT_CHAT]="audioOut",i[l.DEVICE_TYPE_VIDEO]="video",i),l.deviceTypeMap=(o={},o[l.DEVICE_TYPE_AUDIO_IN]="audioIn",o[l.DEVICE_TYPE_AUDIO_OUT_LOCAL]="audioOut",o[l.DEVICE_TYPE_AUDIO_OUT_CHAT]="audioOut",o[l.DEVICE_TYPE_VIDEO]="video",o),l.videoMap={frame:(r={},r[l.CHAT_VIDEO_QUALITY_NORMAL]="480x320",r[l.CHAT_VIDEO_QUALITY_LOW]="176x144",r[l.CHAT_VIDEO_QUALITY_MEDIUM]="352x288",r[l.CHAT_VIDEO_QUALITY_HIGH]="480x320",r[l.CHAT_VIDEO_QUALITY_480P]="640x480",r[l.CHAT_VIDEO_QUALITY_540P]="960x540",r[l.CHAT_VIDEO_QUALITY_720P]="1280x720",r),frameRate:(s={},s[l.CHAT_VIDEO_FRAME_RATE_NORMAL]=15,s[l.CHAT_VIDEO_FRAME_RATE_5]=5,s[l.CHAT_VIDEO_FRAME_RATE_10]=10,s[l.CHAT_VIDEO_FRAME_RATE_15]=15,s[l.CHAT_VIDEO_FRAME_RATE_20]=20,s[l.CHAT_VIDEO_FRAME_RATE_25]=25,s)};var f={getVideoSessionConfig:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.quality,n=void 0===t?l.CHAT_VIDEO_QUALITY_NORMAL:t,i=e.frameRate,o=void 0===i?l.CHAT_VIDEO_FRAME_RATE_NORMAL:i,r={},s=l.videoMap.frame[n];return r.frameRate=l.videoMap.frameRate[o],r.width=+s.split("x")[0],r.height=+s.split("x")[1],r},getDeviceTypeStr:function(e){return l.deviceTypeMap[e]},getDeviceTypeMap:function(e){return l.deviceTypeMap[e]}},h=a.merge(l,c,u),d=a.merge(p,c,u);t.constantTool=f,t.constantRtc=h,
t.constantBB=d},145:function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}t.__esModule=!0;var o=n(175);Object.defineProperty(t,"monitor",{enumerable:!0,get:function(){return i(o)["default"]}});var r=n(176);Object.defineProperty(t,"signal",{enumerable:!0,get:function(){return i(r)["default"]}});var s=n(195);Object.defineProperty(t,"configMap",{enumerable:!0,get:function(){return i(s)["default"]}})},172:function(e,t){"use strict";e.exports={pushConfig:{enable:1,needBadge:2,needPushNick:3,pushContent:4,custom:5,pushPayload:6,sound:7,webrtcEnable:10},liveOption:{liveEnable:1,webrtcEnable:2},turnInfoTag:{channelId:0,tunnelServer:1,proxyServer:2,stunServer:3,type:4,dispatchServer:5},gateWay:{login:1,loginAck:2,join:3,keep_alive:4,keep_alive_ack:5,keep_alive_node:6,broadcast:7,toUser:8,logout:9}}},175:function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}t.__esModule=!0;var o=n(197),r=i(o),s=n(198),a=i(s),c=n(199),u=i(c);t["default"]={DataApi:function(e){return new r["default"](e)},DataRtc:function(e){return new a["default"](e)},DataStats:function(e){return new u["default"](e)}},e.exports=t["default"]},176:function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}t.__esModule=!0;var s=n(145),a=n(8),c=n(9),u=n(2).Promise,l=n(17),p=n(172),f=function(e){function t(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};i(this,t);var r=o(this,e.call(this));return l.merge(r.info,n),r.init(),r.logger=n.logger||window.console,r.autoReconnect=n.autoReconnect||!0,r.isDestroy=!1,r.reConnectCount=0,r.wssUrl=null,r}return r(t,e),t}(a),h=f.prototype;h.init=function(){this.reset()},h.reset=function(){this.imInfo={}},h.connect=function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.url,i=void 0===n?this.wssUrl:n,o=t.imInfo;return this.imInfo=o||this.imInfo,i?new u(function(t,n){e.url=i;var o=void 0;try{!function(){o=e.ws=new WebSocket("wss://"+i);var r=e;o.onopen=function(n){e.wssUrl=i,r.initSignal(),r.signalConnected=!0,r.emit("signalConnected"),t(r),e.heartbeat()},o.onclose=o.onerror=function(e){r.signalConnected=!1,n(e)}}()}catch(e){e.logger.error("信令连接建立失败",e),n(e)}}):u.reject("信令地址缺失")},h.initSignal=function(){var e=this,t=this.ws,n=t.send;t.send=function(e){n.call(this,JSON.stringify(e))},t.onmessage=function(t){var n=JSON.parse(t.data||null);if(n)return!e.isHeartBeating||"keep_alive_ack"!==n.type&&n.type!==p.gateWay.keep_alive_ack?void e.emit("message",n):void e.onHeartBeat(n)},t.onclose=function(t){e.signalConnected=!1,e.emit("signalTimeout",t)},t.onerror=function(t){e.signalConnected=!1,e.emit("signalError",t)}},h.send=function(e){var t=this;"keep_alive"!==e.type,this.ws&&this.signalConnected&&this.ws.readyState===this.ws.OPEN?(e.browser={},e.browser.name=c.name,e.browser.version=c.version,this.ws.send(e)):this.once("signalConnected",function(){t.send(e)})},h.heartbeat=function(){this.socketData=this.socketData||{uid:this.imInfo.uid,cid:this.imInfo.cid},this.heartBeatList=[],this.bindHearBeat(5)},h.onHeartBeat=function(e){this.heartBeatList.shift(),this.bindHearBeat(5)},h.heartBeatHandler=function(){var e=this.socketData,t=this.heartBeatList;if(t){var n=Date.now(),i=n;if(s.configMap.CURRENT.SDK_TYPE===s.configMap.SDK_TYPE.WHITEBOARD&&(i=+n.toString().slice(0,-3)),t.constructor===Array&&0===t.length){t.push(n);var o=this.getContentData({type:"keep_alive",uid:s.configMap.CURRENT.SDK_TYPE===s.configMap.SDK_TYPE.WHITEBOARD?+e.uid:e.uid+"",cid:s.configMap.CURRENT.SDK_TYPE===s.configMap.SDK_TYPE.WHITEBOARD?+e.cid:e.cid+""},i);return this.send(o),void this.bindHearBeat(5)}var r=Date.now()-t[0];if(r>3e4)this.logger.error("socket error: heartbeat timeout"),this.emit("signalTimeout");else if(r>2e3&&r<3e4){this.logger.warn("socket error: no response, keep heartbeat"),t.push(n);var a=this.getContentData({type:"keep_alive",uid:e.uid,cid:e.cid},i);this.send(a),this.bindHearBeat(2)}}},h.getContentData=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments[1];return s.configMap.CURRENT.SDK_TYPE===s.configMap.SDK_TYPE.WHITEBOARD?(e.version=31,e.type=p.gateWay[e.type],e.content={params:{timestamp:+t}}):e.params={content:{timestamp:t+""}},e},h.bindHearBeat=function(e){this.isHeartBeating&&clearTimeout(this.isHeartBeating),this.isHeartBeating=setTimeout(this.heartBeatHandler.bind(this),1e3*e)},h.stopHeartBeat=function(){this.isHeartBeating&&(clearTimeout(this.isHeartBeating),clearInterval(this.heartBeatTimer),this.isHeartBeating=null,this.heartBeatTimer=null,this.heartBeatList=null,this.heartBeatCount=0)},h.logout=function(){var e=this.socketData,t=Date.now().toString(),n=this.getContentData({type:"logout",uid:e.uid,cid:e.cid},t);this.send(n)},h.destroy=function(){this.logger.log("signal close -> signal.js"),this.stopHeartBeat(),this.isDestroy=!0,this.ws&&(this.ws.onopen=null,this.ws.onmessage=null,this.ws.onerror=null,this.ws.onclose=null,this.ws.readyState===WebSocket.OPEN&&this.ws.close(),this.ws=null)},t["default"]=f,e.exports=t["default"]},179:function(e,t){"use strict";e.exports={pushConfig:{1:"enable",2:"needBadge",3:"needPushNick",4:"pushContent",5:"custom",6:"pushPayload",7:"sound",10:"webrtcEnable"},liveOption:{1:"liveEnable",2:"webrtcEnable"},turnInfoTag:{0:"channelId",1:"tunnelServer",2:"proxyServer",3:"stunServer",4:"type",5:"dispatchServer"},gateWay:{1:"login",2:"loginAck",3:"join",4:"keep_alive",5:"keep_alive_ack",6:"keep_alive_node",7:"broadcast",8:"toUser",9:"logout"}}},190:function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}t.__esModule=!0;var i=function(){function e(t){n(this,e),this.all=t||Object.create(null)}return e.prototype.on=function(e,t){(this.all[e]||(this.all[e]=[])).push(t)},e.prototype.off=function(e,t){this.all[e]&&this.all[e].splice(this.all[e].indexOf(t)>>>0,1)},e.prototype.emit=function(e,t){(this.all[e]||[]).map(function(e){e(t)}),(this.all["*"]||[]).map(function(n){n(e,t)})},e}();t["default"]=i,e.exports=t["default"]},191:function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function a(e,t,n){var i=0;t.forEach(function(t){if(t.visible&&!(i>=n)){if(c(e,t),"fill"===t.mode)return v(e,t.corner[0]);e.drawImage(t.ctx.canvas,t.corner[0].x,t.corner[0].y),n++}})}function c(e,t){var n=t.UID,i=t.ctx,o=t.size,r=t.color,s=t.mode;void 0!==n&&(e.lineWidth=i.lineWidth=o,e.strokeStyle=i.strokeStyle=r),"erase"===s?e.globalCompositeOperation="destination-out":e.globalCompositeOperation="source-over"}function u(e,t){var n=e.canvas,i=document.createElement("canvas").getContext("2d");i.canvas.width=n.width,i.canvas.height=n.height,i.drawImage(n,0,0,n.width,n.height),n.style.width=n.width*t+"px",n.style.height=n.height*t+"px",n.width=n.width*t,n.height=n.height*t,e.lineCap=e.lineJoin="round",e.drawImage(i.canvas,0,0,n.width,n.height)}function l(e,t,n,i){return t.x===i.x&&t.y===i.y?void f(e,t,1,1):(e.beginPath(),e.moveTo(t.x,t.y),e.quadraticCurveTo(n.x,n.y,i.x,i.y),void e.stroke())}function p(e,t,n){e.beginPath(),e.moveTo(t.x,t.y),e.lineTo(n.x,n.y),e.stroke()}function f(e,t,n,i){var o=arguments.length>4&&void 0!==arguments[4]&&arguments[4];o?e.fillRect(t.x,t.y,n,i):e.strokeRect(t.x,t.y,n,i)}function h(e,t,n,i,o){var r=arguments.length>5&&void 0!==arguments[5]&&arguments[5],s=t.x,a=t.y,c=n<0?-o:o,u=i<0?-o:o;e.beginPath(),e.moveTo(s+c,a),e.lineTo(s+n-c,a),e.quadraticCurveTo(s+n,a,s+n,a+u),e.lineTo(s+n,a+i-u),e.quadraticCurveTo(s+n,a+i,s+n-c,a+i),e.lineTo(s+c,a+i),e.quadraticCurveTo(s,a+i,s,a+i-u),e.lineTo(s,a+u),e.quadraticCurveTo(s,a,s+c,a),e.stroke(),r&&e.fill()}function d(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];e.beginPath(),e.arc(t.x,t.y,n,0,2*Math.PI,!0),e.stroke(),i&&e.fill()}function v(e,t){function n(e){return e===y||(4278190080&e)>>>0<4278190080}var i=t.x,o=t.y,r=e.getImageData(0,0,e.canvas.width,e.canvas.height),s=0,a=1,c=e.strokeStyle,u=parseInt(c.substr(1,2),16),l=parseInt(c.substr(3,2),16),p=parseInt(c.substr(5,2),16),f=(255<<24|p<<16|l<<8|u)>>>0,h=[i,o],d=new ArrayBuffer(r.data.length),v=new Uint8ClampedArray(d);v.set(r.data);var m=new Uint32Array(d),y=m[o*r.width+i];if(y!==f){for(var g=[h],b=void 0,_=r.width-1,w=r.height-1;b=g.pop();){for(var C=b[a]*r.width+b[s],S=b[s],T=b[a];T-- >=0&&n(m[C]);)C-=r.width;C+=r.width,T++;for(var E=!1,x=!1;T++<w&&n(m[C]);)m[C]=f,S>0&&(n(m[C-1])?E||(g.push([S-1,T]),E=!0):E&&(E=!1)),S<_&&(n(m[C+1])?x||(g.push([S+1,T]),x=!0):x&&(x=!1)),C+=r.width}r.data.set(v),e.putImageData(r,0,0)}}t.__esModule=!0;var m=n(190),y=i(m),g=function(e){function t(n){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};o(this,t);var s=r(this,e.call(this));if(s.displayCtx&&s.destory(),s.users={},s.UID=i.UID||0,s.shapes=[],s.visible=0,!(n instanceof window.HTMLElement))throw new Error("画板容器不是HTMLElement实例");s.container=n;var a=document.createElement("canvas");if(s.displayCtx=a.getContext("2d"),n.style.position="relative",a.style.position="relative",a.style.boxSizing="content-box",a.style.zIndex=i.zIndex||0,a.style.cursor="crosshair",s.width=i.width||800,s.height=i.height||500,"number"!=typeof s.width)throw new Error("画板宽度不是数字");if("number"!=typeof s.height)throw new Error("画板高度不是数字");s.displayCtx.canvas.width=s.width,s.displayCtx.canvas.height=s.height,s.displayCtx.lineCap=s.displayCtx.lineJoin="round";var c=s.addUser(s.UID);return n.appendChild(a),n.appendChild(c.ctx.canvas),s.dispatcher=s.dispatcher.bind(s),s.switchEventListener(!0),s}return s(t,e),t.prototype.mode=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.UID,n=this.users[t];if(!e)return n.mode;if("string"!=typeof e)throw new Error("操作模式不是字符串");var i=e.split(":");n.mode=i[0],n.type=i[1]||"free",this.emit("action",{UID:t,op:"mode",value:e})},t.prototype.size=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.UID,n=this.users[t];if(!e)return n.size;if("number"!=typeof e)throw new Error("Type Error: size");n.size=e,this.emit("action",{UID:t,op:"size",value:e})},t.prototype.color=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.UID,n=this.users[t];return e?(n.color=e,void this.emit("action",{UID:t,op:"color",value:e})):n.color},t.prototype.switchEventListener=function(e){var t=e?"add":"remove",n=[this.users[this.UID].ctx.canvas,this.displayCtx.canvas],i=this.dispatcher;n.forEach(function(e){e[t+"EventListener"]("mousedown",i),e[t+"EventListener"]("mousemove",i),e[t+"EventListener"]("touchmove",i),e[t+"EventListener"]("touchstart",i)}),document[t+"EventListener"]("mouseup",i),document[t+"EventListener"]("touchend",i)},t.prototype.mousedown=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.UID,n=void 0,i=this.users[t],o=i.start,r=i.oldMid,s=i.end;i.isMouseDown=!0;var a=i.ctx;switch("free"===i.type?a.canvas.style.visibility="hidden":a.canvas.style.visibility="visible",c(this.displayCtx,i),i.mode){case"draw":case"erase":switch(n=new _(i.mode,i.type,i.size,i.color,new b(e.x,e.y)),i.activeShape=n,this.shapes.push(n),i.shapes.push(this.shapes.length-1),i.type){case"free":b.set(o,e.x,e.y),b.set(r,o.x,o.y),b.set(s,o.x,o.y);break;default:b.set(o,e.x,e.y)}break;case"fill":n=new _(i.mode,i.type,i.size,i.color,new b(e.x,e.y)),this.shapes.push(n),i.shapes.push(this.shapes.length-1),v(this.displayCtx,e);break;case"select":}"select"!==i.mode&&(i.available=++i.visible,this.visible++),this.emit("action",{UID:t,op:"mousedown",value:e})},t.prototype.mousemove=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.UID,n=this.users[t];if(n.isMouseDown){var i=n.start,o=n.oldMid,r=n.end,s=n.ctx,a=this.displayCtx;switch(n.mode){case"draw":case"erase":switch(c(a,n),n.type){case"free":var u=new b((r.x+e.x)/2,(r.y+e.y)/2);l(s,o,r,u),l(a,o,r,u),b.set(o,u.x,u.y),b.set(r,e.x,e.y);break;case"line":b.set(r,e.x,e.y),s.clearRect(0,0,s.canvas.width,s.canvas.height),p(s,i,r);break;case"rect":b.set(r,e.x,e.y),s.clearRect(0,0,s.canvas.width,s.canvas.height),f(s,i,r.x-i.x,r.y-i.y);break;case"roundRect":b.set(r,e.x,e.y),s.clearRect(0,0,s.canvas.width,s.canvas.height),h(s,i,r.x-i.x,r.y-i.y,30);break;case"circle":b.set(r,e.x,e.y),s.clearRect(0,0,s.canvas.width,s.canvas.height),d(s,i,Math.abs(e.x-i.x))}var v=n.activeShape.corner;if("circle"===n.type){var m=Math.abs(e.x-i.x);v[0].x=i.x-m,v[0].y=i.y-m,v[1].x=i.x+m,v[1].y=i.y+m}else v[0].x=Math.min(r.x,v[0].x),v[0].y=Math.min(r.y,v[0].y),v[1].x=Math.max(r.x,v[1].x),v[1].y=Math.max(r.y,v[1].y);break;case"fill":break;case"select":}this.emit("action",{UID:t,op:"mousemove",value:e})}},t.prototype.mouseup=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.UID,n=this.users[t];if(n.isMouseDown){n.isMouseDown=!1;var i=n.start,o=n.oldMid,r=n.end,s=n.ctx,a=this.displayCtx;switch(n.mode){case"draw":case"erase":switch(c(a,n),n.type){case"free":var u=new b((r.x+e.x)/2,(r.y+e.y)/2);l(s,o,r,u),l(a,o,r,u),b.set(o,u.x,u.y),b.set(r,e.x,e.y);break;case"line":b.set(r,e.x,e.y),p(s,i,r);break;case"rect":b.set(r,e.x,e.y),f(s,i,r.x-i.x,r.y-i.y);break;case"roundRect":b.set(r,e.x,e.y),h(s,i,r.x-i.x,r.y-i.y,30);break;case"circle":b.set(r,e.x,e.y),d(s,i,Math.abs(e.x-i.x))}var v=n.activeShape.corner,m=n.activeShape.ctx;v[0].x-=this.size(),v[0].y-=this.size(),v[1].x+=this.size(),v[1].y+=this.size(),m.canvas.width=Math.ceil(v[1].x-v[0].x),m.canvas.height=Math.ceil(v[1].y-v[0].y),m.lineCap=m.lineJoin=n.ctx.lineCap,m.lineWidth=n.ctx.lineWidth;var y=s.getImageData(v[0].x,v[0].y,m.canvas.width,m.canvas.height);m.putImageData(y,0,0),"free"!==n.type&&a.drawImage(m.canvas,v[0].x,v[0].y),s.clearRect(0,0,this.displayCtx.canvas.width,this.displayCtx.canvas.height);break;case"fill":break;case"select":}this.emit("action",{UID:t,op:"mouseup",value:e})}},t.prototype.undo=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.UID,t=this.users[e];if(0!==t.visible){var n=t.shapes.pop();this.shapes[n].visible=!1,t.recycle.push(n),--t.visible,this._clear(),a(this.displayCtx,this.shapes,--this.visible),this.emit("action",{UID:e,op:"undo",value:e})}},t.prototype.redo=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.UID,t=this.users[e];if(t.visible!==t.available){var n=t.recycle.pop();this.shapes[n].visible=!0,t.shapes.push(n),++t.visible,this._clear(),a(this.displayCtx,this.shapes,++this.visible),this.emit("action",{UID:e,op:"redo",value:e})}},t.prototype.clear=function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.UID;if(this._clear(),e&&this.users[e]){var i=this.users[e];return i.isMouseDown=!1,i.shapes.forEach(function(e){t.shapes[e]&&(t.shapes[e].visible=!1,t.visible--)}),i.shapes=[],i.recycle=[],i.available=0,i.visible=0,this._clear(),void a(this.displayCtx,this.shapes,this.visible)}this.shapes=[],this.visible=0;for(var o in this.users){var r=this.users[o];r.shapes=[],r.recycle=[],r.available=0,r.visible=0,r.isMouseDown=!1}this.emit("action",{UID:n,op:"clear",value:null})},t.prototype._clear=function(){this.displayCtx.clearRect(0,0,this.width,this.height);for(var e in this.users){var t=this.users[e];t.ctx.clearRect(0,0,this.width,this.height)}},t.prototype.act=function(e){var t=e.UID,n=e.op,i=e.value,o=this.users[t];o||(this.users[t]=this.addUser(t)),this[n](i,t)},t.prototype.resize=function(e){if(e=parseInt(e),isNaN(e)||e<=0)throw new Error("白板宽度应是大于0的数字");var t=e/this.width,n=this.height*t;u(this.displayCtx,t);for(var i in this.users)u(this.users[i].ctx,t);this.shapes.forEach(function(e){u(e.ctx,t),e.corner[0].x*=t,e.corner[0].y*=t,e.corner[1].x*=t,e.corner[1].y*=t}),this.width=e,this.height=n},t.prototype.addUser=function(e){if(this.users[e])return this.users[e];var t=new w(e),n=t.ctx.canvas,i=this.displayCtx.canvas;return n.style.position="absolute",n.style.boxSizing="content-box",n.style.top=i.clientTop+"px",n.style.left=i.clientLeft+"px",n.style.zIndex=i.style.zIndex+1,n.style.cursor="crosshair",n.style.width=this.width+"px",n.style.height=this.height+"px",n.width=this.width,n.height=this.height,t.ctx.lineCap=t.ctx.lineJoin="round",this.users[e]=t,this.users[e]},t.prototype.destory=function(){this.users[this.UID]&&(this.switchEventListener(!1),this.container.removeChild(this.users[this.UID].ctx.canvas)),this.container.removeChild(this.displayCtx.canvas),this.displayCtx=null,this.shapes=[],this.visible=0},t.prototype.dispatcher=function(e){e.preventDefault(),e=e.originalEvent?e.originalEvent:e;var t=this.displayCtx.canvas.getBoundingClientRect(),n=void 0,i=void 0;e.touches&&1===e.touches.length?(n=e.touches[0].clientX,i=e.touches[0].clientY):e.changedTouches&&1===e.changedTouches.length?(n=e.changedTouches[0].clientX,i=e.changedTouches[0].clientY):(n=e.clientX,i=e.clientY),n||0===n||(n=0),i||0===i||(i=0);var o=new b(n-t.left,i-t.top),r=e.type;"touchstart"===r&&(r="mousedown"),"touchmove"===r&&(r="mousemove"),"touchend"===r&&(r="mouseup"),this[r](o)},t}(y["default"]);t["default"]=g;var b=function(){function e(t,n){o(this,e),this.x=t||0,this.y=n||0}return e.prototype.copy=function(){return new e(this.x,this.y)},e.set=function(e,t,n){e.x=t,e.y=n},e}(),_=function C(e,t,n,i,r){o(this,C),this.visible=!0,this.ctx=document.createElement("canvas").getContext("2d"),this.type=t,this.mode=e,this.color=i,this.size=n,this.corner=[r.copy(),r.copy()],this.transform=[],this.path=[],this.zIndex=0},w=function S(e){o(this,S),this.UID=e,this.ctx=document.createElement("canvas").getContext("2d"),this.shapes=[],this.recycle=[],this.mode="draw",this.type="free",this.size=4,this.color="#000",this.isMouseDown=!1,this.start=new b(0,0),this.oldMid=new b(0,0),this.end=new b(0,0),this.visible=0,this.available=0,this.activeShape={}};e.exports=t["default"]},192:function(e,t,n){"use strict";var i=n(55),o={};o.install=function(e){var t=e.fn,n=e.util,o=i({util:n});t.initWhiteBoard=function(e){return n.verifyOptions(e,"type accounts"),e.pushContent="",e.custom="",e.pushConfig||(e.pushConfig={}),e.pushConfig.webrtcEnable=e.webrtcEnable,e.pushConfig=new o(e.pushConfig),this.cbAndSendCmd("initWhiteBoard",e)},t.wbKeepCalling=function(e){return n.verifyOptions(e,"type accounts channelId"),this.cbAndSendCmd("wbKeepCalling",e)},t.wbCalleeAck=function(e){return n.verifyOptions(e,"account channelId type accepted"),this.cbAndSendCmd("wbCalleeAck",e)},t.wbHangup=function(e){return n.verifyOptions(e,"channelId"),this.cbAndSendCmd("wbHangup",e)},t.wbControl=function(e){return n.verifyOptions(e,"channelId type"),this.cbAndSendCmd("wbControl",e)},t.wbCreateChannel=function(e){return this.cbAndSendCmd("wbCreateChannel",e)},t.wbJoinChannel=function(e){return n.verifyOptions(e,"channelName"),n.verifyBooleanWithDefault(e,"liveEnable",!1),n.verifyBooleanWithDefault(e,"webrtcEnable",!1),this.cbAndSendCmd("wbJoinChannel",{channelName:e.channelName,liveOption:{liveEnable:e.liveEnable?1:0,webrtcEnable:e.webrtcEnable?1:0}})},t.wbQueryAccountUidMap=function(e,t){return this.cbAndSendCmd("wbQueryAccountUidMap",{channelName:e,uids:t})}},e.exports=o},194:function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var s=n(67),a=n(8),c=n(1),u=function(e){function t(n){i(this,t);var r=o(this,e.call(this));return n.container=s.n2node(n.container),n.remoteContainer=s.n2node(n.remoteContainer),c.merge(r,n),r.init(),r.util=c,r.debug=!0,r}return r(t,e),t}(a),l=u.prototype;l.init=function(){var e=this;this.resetStatus(),window.addEventListener("beforeunload",this.beforeunload.bind(this));var t=this.nim&&this.nim.logger||window.console;this.logger={log:function(){arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};e.debug&&t.log.apply(t,arguments)},error:function(){arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};e.debug&&t.error.apply(t,arguments)},warn:function(){arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};e.debug&&t.warn.apply(t,arguments)}},this.log=this.logger.log,this.error=this.logger.error,this.warn=this.logger.warn},l.resetStatus=function(){this.signalInited=!1,this.channelId=null,this.type=null,this.target={account:null,uid:null},this.sessionConfig={},this.sessionMode=null,this.imInfo={},this.calling=!1,this.isCaller=!1,this.callee=null,this.callAccepted=!1,this.callerInfo=null,this.beCalledInfo=null,this.nim&&(this.nim.protocol&&this.nim.protocol.setCurrentNetcall&&this.nim.protocol.setCurrentNetcall(),this.nim.protocol&&this.nim.protocol.setCurrentWhiteBoard&&this.nim.protocol.setCurrentWhiteBoard()),this.needQueryAccountMap={},this.accountUidMap={},this.uidAccountMap={},this.isOnHangup=!1},l.beforeunload=function(){this.signalInited&&(this.callerInfo||this.beCalledInfo?this.hangup():this.leaveChannel())},l.baseGetAccount=function(){return this.nim&&this.nim.account},l.baseGetUid=function(){return this.accountUidMap?this.accountUidMap[this.nim.account]||"-1":"-1"},l.parseAccountUidMap=function(e){var t=this;Object.keys(e).forEach(function(n){t.addAccountUidMap({account:n,uid:e[n]})})},l.addAccountUidMap=function(e){var t=e.account,n=e.uid;this.uidAccountMap||(this.uidAccountMap={}),this.uidAccountMap[n]=t,this.accountUidMap||(this.accountUidMap={}),this.accountUidMap[t]=n},l.getAccountWithUid=function(e){if(this.uidAccountMap)return this.uidAccountMap[e]},l.getUidWithAccount=function(e){if(this.accountUidMap)return this.accountUidMap[e]},l.baseIsCurrentChannelId=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.channelId&&this.channelId===e.channelId},l.baseNotCurrentChannelId=function(e){return!this.baseIsCurrentChannelId(e)},l.baseResponse=function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.fn||"calleeAck",i=t.beCalledInfo||this.beCalledInfo,o=i.accepted=t.accepted!==!1;return o?(this.sessionMode="p2p",this.type=i.type,this.channelId=i.channelId,this.target.account=i.account,this.calling=!0,this.imInfo=i,this.imInfo.sessionMode=this.sessionMode,this.setSessionConfig({signalStartTime:Date.now()})):(this.log("reject call",i),this.packNetcallRecord({type:i.type,channelId:i.channelId,isCaller:!1,target:i.account,recordType:"rejectNetcall"})),this.nim[n](i).then(function(){o&&(t.sessionConfig&&e.setSessionConfig(t.sessionConfig),e.beCalledInfo=i,e.initSession({beCalledInfo:i}))},function(t){throw e.log(t),t})},l.baseControl=function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(t.channelId=t.channelId||this.channelId,t.command&&t.channelId){var n=t.fn||"netcallControl";return t.type=t.command,this.nim[n](t)["catch"](function(t){e.log(t)})}},l.baseHangup=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.channelId||this.channelId;if(t){var n=e.fn||"hangup";this.nim[n]({channelId:t})}t===this.channelId&&(this.isCaller&&!this.callAccepted&&(this.log("cancelWhiteBoardBeforeAccept",{channelId:t}),this.packNetcallRecord({recordType:"cancelWhiteBoardBeforeAccept"})),this.resetWhenHangup())},l.baseStartSession=function(){this.imInfo.cid=this.imInfo.cid||this.imInfo.channelId;var e=this.sessionMode=this.sessionMode||"p2p";this.imInfo.sessionMode=e,this.imInfo.sessionConfig=this.sessionConfig},l.packNetcallRecord=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.recordType,n=c.exist(e.type)?e.type:this.type,i=c.exist(e.channelId)?e.channelId:this.channelId,o=c.exist(e.duration)?e.duration:0,r=c.exist(e.isCaller)?e.isCaller:this.isCaller,s=c.exist(e.target)?e.target:this.target.account,a=this.baseGetAccount(),u=r?a:s,l=r?s:a,p=+new Date;this.nim.protocol.onMsg({content:{msg:{attach:JSON.stringify({data:{calltype:n,channel:i,duration:o,ids:[a,s],time:p},id:t}),from:u,fromClientType:r?16:0,fromDeviceId:"",fromNick:"",idClient:c.guid(),idServer:c.guid(),scene:0,time:p,to:l,type:5}}})},l.setSessionConfig=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.sessionConfig=c.merge(this.sessionConfig,e)},l.initSignal=function(){return Promise.resolve()},l.initSession=function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.sessionMode="p2p";var n=this.isCaller?this.callerInfo:t.beCalledInfo;this.parseAccountUidMap(n.accountUidMap),!n.account&&n.uid&&(n.account=this.getAccountWithUid(n.uid)),this.callAccepted=!0,this.signalInited=!0,this.setSessionConfig({signalEndTime:Date.now()});var i={type:n.type,account:this.target&&this.target.account||n.account,channelId:n.channelId};n.netcallType&&(i.netcallType=n.netcallType),this.imInfo.target=this.target,setTimeout(function(){e.emit("callAccepted",i)},1)},l.onBeCalled=function(e){this.signalInited=!0,this.channelId=e.channelId,this.beCalledInfo=e,this.log("beCalling",e),this.emit("beCalling",e)},l.onUserJoin=function(e){if(this.log("client on userJoined",e),e.type=e.type||this.type,e.account=this.getAccountWithUid(e.uid),e.mode=this.sessionMode,e.account!==this.baseGetAccount()){if(e.account)return this.logger.log("有人加入 ----> 来自信令层的通知",e),void this.emit("joinChannel",e);this.needQueryAccountMap[e.uid]=e,this.nim.queryAccountUidMap(this.channelName,[e.uid])}},l.onUserLeft=function(e){var t=this;this.channelId&&(this.logger.log("leave channel from signal"),"p2p"===this.imInfo.sessionMode?(setTimeout(function(){t.logger.log("超时处理 onUserLeft"),t.resetWhenHangup()},1e3),this.emit("hangup",{channelId:e.channelId||e.cid,account:this.target.account,type:e.type||0})):this.emit("leaveChannel",{channelId:e.channelId||e.cid,account:this.getAccountWithUid(e.uid),type:e.type||0}))},l.onNotifyJoin=function(e){this.logger.log("join channel from IM");var t=e.accountUidMap,n=this.needQueryAccountMap;this.parseAccountUidMap(t);for(var i in t){var o=i,r=t[i];if(r in n){var s=n[r];s.account=o,delete n[r],this.logger.log("有人加入 ----> 来自IM的通知",e),this.emit("joinChannel",s)}}},l.onCalleeAck=function(e){if(this.logger.log("收到被叫的通知",e),!this.baseNotCurrentChannelId(e)){var t=e.account,n=this.beCalledInfo||this.callerInfo;this.target.account=t,this.setSessionConfig({signalEndTime:Date.now()}),e.accepted?(this.callAccepted=!0,this.initSession()):(this.log("call Rejected",e),this.packNetcallRecord({type:e.type,channelId:e.channelId,isCaller:!0,target:e.account,recordType:"netcallRejected"}),this.resetWhenHangup(),this.emit("callRejected",{type:n.type,account:t}))}},l.onHangup=function(e){var t=this;this.channelId&&(this.logger.log("on hangup from IM"),setTimeout(function(){t.logger.log("超时处理 onHangup"),t.resetWhenHangup()},1e3),this.emit("hangup",{channelId:e.channelId,account:e.account}))},l.onControl=function(e){this.emit("control",e)},l.onCalleeAckSync=function(e){this.emit("callerAckSync",e),this.baseIsCurrentChannelId(e)&&this.resetWhenHangup()},l.baseCreateChannel=function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return c.verifyOptions(n,"channelName"),n.custom=n.custom||"",this.setSessionConfig({signalStartTime:Date.now()}),this.nim[e](n).then(function(e){return Promise.resolve(e)})["catch"](function(e){return t.setSessionConfig({signalEndTime:Date.now()}),Promise.reject(e)})},l.baseJoinChannel=function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.nim[e](n).then(function(e){return t.setSessionConfig({signalEndTime:Date.now()}),t.signalInited=!0,t.sessionMode=e.sessionMode="meeting",t.parseAccountUidMap(e.accountUidMap),e.uid=t.getUidWithAccount(t.nim.account),Promise.resolve(e)})["catch"](function(e){return t.setSessionConfig({signalEndTime:Date.now()}),Promise.reject(e)})},l.format=function(e){return e.rtcServerMap&&(e.rtcServerMap=JSON.parse(e.rtcServerMap),e.rtcServerMap=e.rtcServerMap.webrtcarray||[e.rtcServerMap.webrtc]||e.rtcServerMap),e.wbServerMap&&(e.wbServerMap=JSON.parse(e.wbServerMap),e.wbServerMap=e.wbServerMap.webrtcarray||[e.wbServerMap.webrtc]||e.wbServerMap),e},l.resetWhenHangup=function(){},e.exports=u},195:function(e,t){"use strict";t.__esModule=!0,t["default"]={CURRENT:{SDK_TYPE:null},SDK_TYPE:{NETCALL:1,WEBRTC:2,WHITEBOARD:3}},e.exports=t["default"]},196:function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}t.__esModule=!0;var s=n(85),a=n(145),c=n(175),u=n(8),l=n(176),p=n(17),f=n(2).Promise,h=function(e){function t(n){i(this,t);var r=o(this,e.call(this,n));return r.info={},r._init(n),r._reset(),r}return r(t,e),t}(u);t["default"]=h;var d=h.prototype;d._init=function(e){p.merge(this.info,e),this.logger=e.logger||window.console,this.dataApi=(0,c.DataApi)(this.info.appKey),this.dataRtc=(0,c.DataRtc)(this.info.appKey),this.dataStats=(0,c.DataStats)(this.info.appKey)},d._reset=function(){this.signal&&(this.signal.destroy(),this.signal=null),this.sessionConfig={},this.imInfo={},this.target={},this.userJoinTimeoutId=0,this.remoteUidStatus={},this.dataRtc.stop()},d.resetStatus=function(){this._reset()},d._startSession=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this.imInfo||e;this.setSessionConfig(t.sessionConfig);var n=t.serverMap?JSON.parse(t.serverMap):{};t.urlArray=t.serverAddrs||n.webrtcarray||[n.webrtc];var i=void 0;return i=this.signal?f.resolve(this.signal):this._initSignal()},d._initSignal=function(){var e=this;if(this.signal)return f.resolve();var t=new l({logger:this.logger}),n=this.imInfo.urlArray,i=n.shift();return i?t.connect({url:i,imInfo:this.imInfo}).then(function(t){return e.signal=t,e._initSignalEvent(),f.resolve(t.url)})["catch"](function(t){return e._initSignal()}):f.reject("无可用的网关服务器地址, 如果当前应用是WebRTC音视频, 请确保对方打开了WebRTC兼容开关")},d._initSignalEvent=function(){var e=this,t=this.signal;t.on("signalTimeout",this.onSignalTimeout.bind(this)),t.on("message",this.onSignalMessage.bind(this)),t.on("signalClosed",function(){e.emit("signalClosed"),e.resetStatus()}),this.signal.on("signalError",function(t){e.emit("signalClosed"),e._stopSignal()})},d._stopSignal=function(){this.signal&&(this.signal.destroy(),this.signal=null)},d._stopSession=function(){this._stopSignal(),this._reset()},d._logout=function(){
this.signal&&this.signal.logout()},d.getUidByMsid=function(e){var t=this.remoteUidMsidMap;for(var n in t)if(t[n]===e)return n;return null},d.getMsidByUid=function(e){return this.remoteUidMsidMap(e)},d.setSessionConfig=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.sessionConfig=p.merge(this.sessionConfig,e)},d.onSignalMessage=function(e){},d.onSignalTimeout=function(e){},d.uploadDataRtcStart=function(){this.info.appKey&&a.configMap.CURRENT.SDK_TYPE===a.configMap.SDK_TYPE.WEBRTC&&this.dataRtc.start({rtcConnection:this.rtc.rtcConnection,imInfo:this.imInfo,remoteUidMsidMap:this.remoteUidMsidMap,sessionConfig:this.sessionConfig,videoConfig:this.imInfo.videoConfig,uid:this.imInfo.uid})},d.uploadDataRtcStop=function(){},d.uploadDataRtcOnce=function(e){if(a.configMap.CURRENT.SDK_TYPE===a.configMap.SDK_TYPE.WEBRTC){var t=s.constantTool.getVideoSessionConfig({quality:this.sessionConfig.videoQuality,frameRate:this.sessionConfig.videoFrameRate});this.dataRtc.updateOnce({imInfo:e,sessionConfig:this.sessionConfig,videoConfig:t})}},d.uploadDataRtc=function(e,t){if(a.configMap.CURRENT.SDK_TYPE===a.configMap.SDK_TYPE.WEBRTC&&this.info.appKey)return"volume"===e?void this.dataRtc.updateLocalVolumn(t):void this.dataRtc.update(e,t)},d.uploadDataApi=function(e,t){a.configMap.CURRENT.SDK_TYPE===a.configMap.SDK_TYPE.WEBRTC&&this.info.appKey&&this.dataApi[e]&&this.dataApi[e](t)},d.uploadDataRtcStart=function(){this.dataStats.start()},d.uploadDataRtcStop=function(){this.dataStats.stop()},d.uploadDataRtcNew=function(e){var t={cid:this.imInfo.cid,uid:this.imInfo.uid,data:e,timestamp:Date.now()};this.dataStats.send(t)},e.exports=t["default"]},197:function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}t.__esModule=!0;var r=n(33),s=i(r),a=n(3),c=a.info.nrtcVersion,u=n(17),l="https://statistic.live.126.net/statistic/realtime/sdkFunctioninfo",p=function h(e,t){o(this,h),this.apis={},this.isRtc=/WebRTC/.test(t),this.init(e,t),this.resetStatus()};t["default"]=p;var f=p.prototype;f.init=function(e,t){u.merge(this.apis,{ver:1,platform:t,sdk_ver:c||"v4.4.0",uid:null,appkey:e,time:null})},f.start=function(e){u.merge(this.apis,e)},f.resetStatus=function(){this.calling=!1,u.merge(this.apis,{p2p:{value:0},meeting:{value:0},bypass:{value:0},call_control_type:{value:0},self_mute:{value:-1},self_mic_mute:{value:-1},switch_p2p_type:{value:0},set_speaker:{value:-1},net_detect:{value:this.isRtc?-1:0},beautify:{value:-1},water_mark:{value:-1},audio_samples:{value:-1},video_samples:{value:-1},pre_view_mirror:{value:-1},code_mirror:{value:-1},custom_audio:{value:-1},custom_video:{value:-1},audio_mix:{value:-1},snap_shot:{value:-1},record:{value:0},audio_record:{value:0},display:{value:0},android_compatibility:{value:-1},hd_audio:{value:0},video_quality:{value:0},fps:{value:0},prefered_video_encoder:{value:-1},prefered_video_decoder:{value:-1},video_max_encode_bitrate:{value:this.isRtc?-1:0},audio_scene:{value:-1},video_adaptive_strategy:{value:this.isRtc?-1:0},ans:{value:-1},agc:{value:-1},dtx:{value:-1},aec:{value:-1},awc:{value:-1}})},f.update=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.key,n=e.ext;this.apis[t]&&(this.apis[t].value=1,void 0!==n&&(this.apis[t].ext=n),/(p2p|meeting)/.test(t)&&(this.calling=!0))},f.send=function(){var e=this;this.calling&&(this.calling=!1,this.apis.time=Date.now(),console.log("----- send apiData ------",this.apis),(0,s["default"])({type:"post",url:l,data:this.apis}).then(function(t){e.resetStatus()})["catch"](function(t){console.log("err",t),e.resetStatus()}))},e.exports=t["default"]},198:function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}t.__esModule=!0;var r=n(33),s=i(r),a=n(9),c=n(3),u=c.info.nrtcVersion,l=n(17),p="https://statistic.live.126.net/statistic/realtime/sdkinfo",f=function v(e){o(this,v),this.infos={},this.userlist=[],this.localVolumn=0,this.local={},this.remote={},this.init(e),this.resetStatus()};t["default"]=f;var h=f.prototype;h.init=function(e){l.merge(this.infos,{ver:1,device:-1,isp:-1,platform:d.convertPlatform(a.os.family)+"-"+a.os.version,browser:a.name+"-"+a.version,sdk_ver:u||"v4.2.0",appkey:e,interval:60,samples:30,time:null,qos_algorithm:-1,fec_algorithm:-1,qos_scene:-1,qos_strategy:-1})},h.resetStatus=function(){l.merge(this.infos,{uid:null,cid:null,push_url:null,turn_ip:null,proxy_ip:null,meeting:!1,live:!1}),this.clearInfoData(),this.uidSsrcMap={},this.userlist=[]},h.initInfoData=function(e){var t={uid:e,cid:this.imInfo&&this.imInfo.channelId||-1,push_url:this.sessionConfig&&this.sessionConfig.rtmpUrl||-1,turn_ip:this.imInfo&&this.imInfo.turnMap||-1,proxy_ip:this.imInfo&&this.imInfo.turnMap||-1,meeting:/^meeting$/gi.test(this.imInfo.sessionMode),live:this.sessionConfig&&this.sessionConfig.liveEnable||!1,p2p:!1,isp:-1,net:-1,connect_state:this.imInfo&&this.imInfo.code||200,signalling_time:(this.sessionConfig&&this.sessionConfig.signalEndTime||0)-(this.sessionConfig&&this.sessionConfig.signalStartTime||0),connect_time:(this.sessionConfig&&this.sessionConfig.rtcEndTime||0)-(this.sessionConfig&&this.sessionConfig.rtcStartTime||0)};l.merge(this.infos,t)},h.clearInfoData=function(){this.localVolumn=0,l.merge(this.infos,{rx:{audio:[],video:[]},tx:{a_lost:[],v_lost:[],rtt:[],rtt_mdev:[],set_v_fps:[],qos_v_fps:[],v_fps:[],set_v_quality:[],real_v_res:[],real_v_kbps:[],real_v_kbps_n:[],real_a_kbps:[],real_a_kbps_n:[],set_v_kbps:[],qos_v_kbps:[],tx_bw_kbps:[],a_volume:[]}})},h.start=function(e){var t=this,n=e.imInfo,i=e.remoteUidMsidMap,o=e.sessionConfig,r=e.rtcConnection,s=e.uid;n&&i&&r&&(this.imInfo=n||{},this.remoteUidMsidMap=i||{},this.sessionConfig=o||{},this.rtcConnection=r,this.videoConfig=e.videoConfig||{},this.sdkInfoTimer||(this.getTurnMap(),this.initInfoData(s),this.format(),this.sdkInfoTimer=setInterval(function(){t.sendInfo()},1e3*this.infos.interval)))},h.stop=function(){this.sdkInfoTimer&&this.resetStatus()},h.update=function(e){this.rtcStats=e,this.format(),this.updateRxMediaInfo(),this.updateTxMediaInfo()},h.updateOnce=function(e){var t=e.imInfo,n=e.remoteUidMsidMap,i=e.sessionConfig,o=e.rtcConnection;t&&(this.imInfo=t||{},this.remoteUidMsidMap=n||{},this.sessionConfig=i||{},this.rtcConnection=o||{},this.videoConfig=e.videoConfig||{},this.getTurnMap(),this.initInfoData(),this.sendInfo())},h.updateLocalVolumn=function(e){this.localVolumn=e},h.updateRxMediaInfo=function(){var e=this,t={u:[],g:[],c:[],bn:[],bc:[]},n={u:[],i:[],bn:[],bc:[],r:[],f:[]};this.userlist.map(function(i){var o=e.getMediaStats(i);t.u.push(o.audio.u),t.g.push(-1),t.c.push(-1),t.bn.push(o.audio.bn),t.bc.push(o.audio.bc),n.u.push(o.video.u),n.i.push(o.video.i),n.bn.push(o.video.bn),n.bc.push(o.video.bc),n.r.push(o.video.r),n.f.push(o.video.f)}),this.infos.rx.audio.push(t),this.infos.rx.video.push(n)},h.getMediaStats=function(e){var t=this.rtcStats,n={audio:{u:+e,g:-1,c:-1,bn:0,bc:0},video:{u:+e,i:-1,bn:0,bc:0,r:-1,f:0}},i={},o=this.uidSsrcMap[e];if(!o)return n;o=o.join("|");var r=new RegExp("("+o+")");return t.results.filter(function(e){return r.test(e.ssrc)&&(i[e.mediaType]=e),r.test(e)}),i.audio&&(n.audio.bn=(i.audio.availableBandwidth||0)-0,n.audio.bc=-1),i.video&&(n.video.bn=(i.video.availableBandwidth||0)-0,n.video.bc=i.video.googFrameWidthReceived+"x"+i.video.googFrameHeightReceived,n.video.f=(i.video.googFrameRateDecoded||0)-0),n},h.getLocalMediaStats=function(){var e=this.rtcStats,t={a_lost:-1,v_lost:-1,rtt:0,rtt_mdev:-1,set_v_fps:this.videoConfig.frameRate||0,qos_v_fps:0,v_fps:0,set_v_quality:this.sessionConfig.videoQuality,real_v_res:0,real_v_kbps:0,real_v_kbps_n:0,real_a_kbps:-1,real_a_kbps_n:0,set_v_kbps:-1,qos_v_kbps:0,tx_bw_kbps:0,a_volume:0},n={},i=this.imInfo.uid,o=this.uidSsrcMap[i];if(!o)return t;o=o.join("|");var r=new RegExp("("+o+")");return e.results.filter(function(e){return e.localCandidateId?void(n.rtt=e):(r.test(e.ssrc)&&(n[e.mediaType]=e),r.test(e))}),n.audio&&(t.real_a_kbps_n=(n.audio.availableBandwidth||e.audio.send.availableBandwidth)-0,t.a_volume=this.localVolumn-0),n.video&&(t.qos_v_fps=n.video.googFrameRateInput-0,t.v_fps=n.video.googFrameRateSent-0,t.real_v_res=n.video.googFrameWidthSent+"x"+n.video.googFrameHeightSent,t.real_v_kbps=n.video.googEncodeUsagePercent-0,t.real_v_kbps_n=n.video.availableBandwidth-0),t.rtt=n.rtt.googRtt-0,t.tx_bw_kbps=(e.connectionType.bitsSentPerSecond||0)-0,t},h.updateTxMediaInfo=function(){var e=this.getLocalMediaStats(),t=this.infos.tx;for(var n in e)t[n].push(e[n]);this.infos.net=d.convertNetwork(this.rtcStats.connectionType.local.networkType[0])},h.getTurnMap=function(){var e=this.imInfo;e.serverMap&&(e.turnMap=JSON.parse(e.serverMap||null),e.turnMap=e.turnMap&&e.turnMap.turnaddrs,e.turnMap=e.turnMap&&e.turnMap[0],e.turnMap=e.turnMap.constructor===Array?e.turnMap[0]:e.turnMap,e.turnMap=e.turnMap&&e.turnMap.match(/\d+\.\d+.\d+\.\d+/),e.turnMap=e.turnMap[0])},h.getSsrc=function(e,t){var n=[],i={audio:this.getTypeSsrc("audio",e,t),video:this.getTypeSsrc("video",e,t)};return i.audio&&n.push(i.audio),i.video&&n.push(i.video),n},h.getTypeSsrc=function(e,t,n){var i=void 0,o="";if(i=new RegExp(e+"[.\\r\\n\\s\\S]*ssrc:(\\d+)\\smsid:"+t),o=n.match(i),o=o&&o[0])return i=new RegExp("ssrc:\\d+\\smsid:"+t),o=o.match(i),o=o.map(function(e){return i=new RegExp("ssrc:(\\d+)\\s"),e=e.match(i),e[1]})},h.format=function(){this.formatLocal(),this.formatRemote()},h.formatLocal=function(){this.localSdp=this.rtcConnection.localDescription,this.localStream=this.rtcConnection.getLocalStreams()[0],this.localStream&&(this.uidSsrcMap[this.imInfo.uid]=this.getSsrc(this.localStream.id,this.localSdp.sdp),this.local.ssrc=this.uidSsrcMap[this.imInfo.uid])},h.formatRemote=function(){this.remoteSdp=this.rtcConnection.remoteDescription,this.userlist=[];var e=this.remoteUidMsidMap;for(var t in e)this.userlist.push(t),this.remote[t]={},this.uidSsrcMap[t]=this.getSsrc(e[t],this.remoteSdp.sdp),this.remote[t].ssrc=this.uidSsrcMap[t]},h.sendInfo=function(){var e=this;this.infos.uid&&this.infos.cid&&(this.infos.time=Date.now(),this.infos.samples=this.infos.rx.audio.length,(0,s["default"])({type:"post",url:p,data:this.infos}).then(function(t){e.clearInfoData()})["catch"](function(t){e.clearInfoData()}))};var d={convertNetwork:function(e){var t={wlan:"wifi",lan:"ethernet"};return t[e]||"unknown"},convertPlatform:function(e){var t=/Windows/i,n=/OS X/i,i=void 0;return i=t.test(e)&&"Win"||e,i=n.test(i)&&"Mac"||i}};e.exports=t["default"]},199:function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}t.__esModule=!0;var r=n(33),s=(i(r),n(3)),a=s.info.nrtcVersion,c=n(17),u=function(){function e(t,n){o(this,e),this.apis={},this.isRtc=/WebRTC/.test(n),this.init(t,n),this.resetStatus()}return e.prototype.resetStatus=function(){},e.prototype.init=function(e,t){c.merge(this.apis,{ver:1,platform:t,sdk_ver:a||"v4.4.0",uid:null,appkey:e,time:null})},e.prototype.start=function(e){c.merge(this.apis,e)},e.prototype.send=function(e){},e}();t["default"]=u,e.exports=t["default"]},205:function(e,t){"use strict";var n={};n.install=function(e){var t=e.Protocol.fn;t.processDatatun=function(e){switch(e.cmd){case"initWhiteBoard":this.onWbInit(e);break;case"wbBeCalled":this.onWbBeCalled(e);break;case"wbKeepCalling":this.onWbKeepCalling(e);break;case"wbCalleeAck":break;case"wbNotifyCalleeAck":this.onWbNotifyCalleeAck(e);break;case"wbHangup":break;case"wbNotifyHangup":this.onWbNotifyHangup(e);break;case"wbNotifyControl":this.onWbControl(e);break;case"wbNotifyCalleeAckSync":this.onWbNotifyCalleeAckSync(e);break;case"wbNotifyRecord":break;case"wbCreateChannel":break;case"wbJoinChannel":this.wbJoinChannel(e);break;case"wbNotifyJoin":this.onWbNotifyJoin(e)}},t.onWbInit=function(e){if(!e.error){var t=e.obj.type;e.obj=e.content,e.obj.type=t,e.obj.accounts=e.obj.keepCallingAccounts,this.setCurrentWhiteBoard(e.obj.channelId),this.wbKeepCalling(e)}},t.setCurrentWhiteBoard=function(e){this.currentWhiteBoardChannelId=e},t.onWbKeepCalling=function(e){e.error||e.content.accounts.length&&this.wbKeepCalling(e)},t.wbKeepCalling=function(e){var t=this,n=e.obj,i=n.type,o=n.accounts,r=n.channelId;o&&o.length&&setTimeout(function(){t.currentWhiteBoardChannelId&&t.currentWhiteBoardChannelId===r&&t.api.wbKeepCalling({type:i,accounts:o,channelId:r})["catch"](function(){})},3e3)},t.onWbBeCalled=function(e){e.error||this.emitAPI({type:"wbBeCalled",obj:e.content})},t.onWbNotifyCalleeAck=function(e){e.error||this.emitAPI({type:"wbNotifyCalleeAck",obj:e.content})},t.onWbNotifyHangup=function(e){e.error||this.emitAPI({type:"wbNotifyHangup",obj:e.content})},t.onWbControl=function(e){e.error||this.emitAPI({type:"wbControl",obj:e.content})},t.onWbNotifyCalleeAckSync=function(e){e.error||this.emitAPI({type:"wbNotifyCalleeAckSync",obj:e.content})},t.onWbNotifyJoin=function(e){e.error||this.emitAPI({type:"wbNotifyJoin",obj:e.content})},t.wbJoinChannel=function(e){e.obj=e.content}},e.exports=n},206:function(e,t){"use strict";var n=11,i={wb:{id:n,initWhiteBoard:1,wbKeepCalling:2,wbCalleeAck:4,wbNotifyCalleeAck:5,wbHangup:8,wbNotifyHangup:9,wbControl:10,wbNotifyControl:11,wbNotifyRecord:12,wbCreateChannel:13,wbJoinChannel:14,wbNotifyJoin:15,wbQueryAccountUidMap:16}},o={initWhiteBoard:{sid:n,cid:i.wb.initWhiteBoard,params:[{type:"StrArray",name:"type"},{type:"StrArray",name:"accounts"},{type:"String",name:"pushContent"},{type:"String",name:"custom"},{type:"Property",name:"pushConfig"}]},wbKeepCalling:{sid:n,cid:i.wb.wbKeepCalling,params:[{type:"StrArray",name:"accounts"},{type:"long",name:"channelId"}]},wbCalleeAck:{sid:n,cid:i.wb.wbCalleeAck,params:[{type:"long",name:"channelId"},{type:"bool",name:"accepted"}]},wbHangup:{sid:n,cid:i.wb.wbHangup,params:[{type:"long",name:"channelId"}]},wbControl:{sid:n,cid:i.wb.wbControl,params:[{type:"long",name:"channelId"},{type:"byte",name:"type"},{type:"string",name:"info"}]},wbCreateChannel:{sid:n,cid:i.wb.wbCreateChannel,params:[{type:"String",name:"channelName"},{type:"String",name:"custom"},{type:"String",name:"webrtcEnable"}]},wbJoinChannel:{sid:n,cid:i.wb.wbJoinChannel,params:[{type:"String",name:"channelName"},{type:"Property",name:"liveOption"}]},wbQueryAccountUidMap:{sid:n,cid:i.wb.wbQueryAccountUidMap,params:[{type:"String",name:"channelName"},{type:"LongArray",name:"uids"}]}},r="datatun",s={"11_1":{service:r,cmd:"initWhiteBoard",response:[{type:"Number",name:"timetag"},{type:"Number",name:"uid"},{type:"Number",name:"channelId"},{type:"PropertyArray",name:"turnInfoTag"},{type:"StrArray",name:"keepCallingAccounts"},{type:"StrLongMap",name:"accountUidMap"},{type:"bool",name:"p2p"},{type:"String",name:"clientConfig"}]},"11_2":{service:r,cmd:"wbKeepCalling",response:[{type:"StrArr",name:"accounts"}]},"11_3":{service:r,cmd:"wbBeCalled",response:[{type:"Number",name:"timetag"},{type:"String",name:"account"},{type:"Number",name:"channelId"},{type:"PropertyArray",name:"turnInfoTag"},{type:"StrLongMap",name:"accountUidMap"},{type:"bool",name:"p2p"},{type:"String",name:"custom"},{type:"Number",name:"uid"},{type:"String",name:"clientConfig"},{type:"Property",name:"pushConfig"}]},"11_4":{service:r,cmd:"wbCalleeAck",response:[]},"11_5":{service:r,cmd:"wbNotifyCalleeAck",response:[{type:"long",name:"channelId"},{type:"String",name:"account"},{type:"bool",name:"accepted"}]},"11_6":{service:r,cmd:"wbNotifyCalleeAckSync",response:[{type:"String",name:"timetag"},{type:"long",name:"channelId"},{type:"byte",name:"type"},{type:"bool",name:"accepted"},{type:"byte",name:"fromClientType"}]},"11_7":{service:r,cmd:"xxxx",response:[]},"11_8":{service:r,cmd:"wbHangup",response:[]},"11_9":{service:r,cmd:"wbNotifyHangup",response:[{type:"long",name:"timetag"},{type:"long",name:"channelId"},{type:"String",name:"account"}]},"11_10":{service:r,cmd:"wbControl",response:[]},"11_11":{service:r,cmd:"wbNotifyControl",response:[{type:"String",name:"account"},{type:"byte",name:"type"},{type:"string",name:"info"},{type:"long",name:"channelId"}]},"11_12":{service:r,cmd:"wbNotifyRecord",response:[{type:"Property",name:"msg"}]},"11_13":{service:r,cmd:"wbCreateChannel",response:[{type:"long",name:"timetag"}]},"11_14":{service:r,cmd:"wbJoinChannel",response:[{type:"long",name:"timetag"},{type:"long",name:"channelId"},{type:"StrLongMap",name:"accountUidMap"},{type:"Property",name:"turnInfoTag"},{type:"String",name:"custom"}]},"11_15":{service:r,cmd:"wbNotifyJoin",response:[{type:"Long",name:"channelId"},{type:"StrLongMap",name:"accountUidMap"}]},"11_16":{service:r,cmd:"wbQueryAccountUidMap",response:[]}};e.exports={idMap:i,cmdConfig:o,packetConfig:s}},207:function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}t.__esModule=!0;var a=n(8),c=i(a),u=n(191),l=i(u),p="#f5455e",f="#238efa",h=function(e){function t(n){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};o(this,t);var s=r(this,e.call(this));return s.debug=i.debug||!1,s.limit=i.limit||80,s.data="",s.count=0,s.draw=new l["default"](n,i),s.draw.size(4),s.draw.color(p),s.draw.on("action",s.transform.bind(s)),setInterval(function(){s.data.length>0&&(s.emit("action",s.data),s.data="",s.count++)},s.limit),s}return s(t,e),t.prototype.undo=function(){this.draw.undo()},t.prototype.clear=function(){this.draw.clear()},t.prototype.resize=function(e){this.draw.resize(e)},t.prototype.act=function(e){var t=this,n=e.UID,i=e.data;if(n!==this.draw.UID){this.draw.users[n]||(this.draw.addUser(n),this.draw.users[n].color=f);var o=i.split(";"),r=this.draw.width,s=this.draw.height;o.forEach(function(e){var i=e.split(":"),o=i[0],a=i.length>1?i[1].split(","):[],c={};switch(o){case"1":c.op="mousedown",c.value={x:Math.ceil(parseFloat(a[0])*r),y:Math.ceil(parseFloat(a[1])*s)};break;case"2":c.op="mousemove",c.value={x:Math.ceil(parseFloat(a[0])*r),y:Math.ceil(parseFloat(a[1])*s)};break;case"3":c.op="mouseup",c.value={x:Math.ceil(parseFloat(a[0])*r),y:Math.ceil(parseFloat(a[1])*s)};break;case"4":c.op="undo",c.value=n;break;case"5":return;case"6":c.op="clear",t.data+="7:0,0;";break;case"7":c.op="clear",c.value=n;break;case"8":break;case"9":break;case"10":break;case"11":break;case"12":break;case"13":break;case"14":break;default:return}c.UID=n,t.draw.act(c)})}},t.prototype.destory=function(){this.draw.destory()},t.prototype.transform=function(e){if(e.UID===this.draw.UID){var t="",n=[],i=this.draw.width,o=this.draw.height;switch(e.op){case"mousedown":t="1",n.push(e.value.x/i,e.value.y/o);break;case"mousemove":t="2",n.push(e.value.x/i,e.value.y/o);break;case"mouseup":t="3",n.push(e.value.x/i,e.value.y/o);break;case"undo":t="4",n.push(0,0);break;case"color":return void(this.color=parseInt(e.value.substring(1),16));case"clear":t="6",n.push(0,0);break;default:return}this.data+=t+":"+n.join(",")+";",this.debug&&(this.data+="5:"+this.count+",0;")}},t}(c["default"]);t["default"]=h,e.exports=t["default"]},208:function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}t.__esModule=!0;var o=n(1);i(o);t["default"]={getAccount:function(){return this.baseGetAccount()},getUid:function(){return this.baseGetUid()},isCurrentChannelId:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.baseIsCurrentChannelId(e)},notCurrentChannelId:function(e){return!this.isCurrentChannelId(e)},startSession:function(){return this.baseStartSession(),this.controller.startSession(this.imInfo)},stopSession:function(){return this.resetWhenHangup(),Promise.resolve()},leaveChannel:function(){this.stopSession()},undo:function(){this.controller.undo()},redo:function(){this.controller.redo()},clear:function(){this.controller.clear()},resize:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.controller.resize(e)},sendCustomData:function(e){this.controller.sendCustomData(e)},send:function(e){this.controller.send(e)}},e.exports=t["default"]},209:function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}t.__esModule=!0;var a=n(145),c=n(194),u=i(c),l=n(210),p=i(l),f=n(1),h=i(f),d=n(85),v=n(208),m=i(v);a.configMap.CURRENT.SDK_TYPE=a.configMap.SDK_TYPE.WHITEBOARD;var y=function(e){function t(n){o(this,t);var i=r(this,e.call(this,n));return i.initWB(),i}return s(t,e),t.prototype.initWB=function(){if(!this.nim)throw new Error({error:"请传入nim实例"});this.initProtocol(),this.initController()},t.prototype.initProtocol=function(){var e=this.nim;e.on("wbBeCalled",this.onBeCalled.bind(this)),e.on("wbNotifyCalleeAck",this.onCalleeAck.bind(this)),e.on("wbNotifyHangup",this.onHangup.bind(this)),e.on("wbControl",this.onControl.bind(this)),e.on("wbNotifyCalleeAckSync",this.onCalleeAckSync.bind(this)),e.on("wbNotifyJoin",this.onNotifyJoin.bind(this))},t.prototype.initController=function(){var e=this;window.myWbContrl=this.controller=new p["default"]({appKey:this.nim&&this.nim.options.appKey,debug:this.debug,container:this.container,logger:this.logger,client:this,isCustom:this.isCustom}),this.controller.on("userJoined",this.onUserJoin.bind(this)),this.controller.on("signalClosed",function(t){e.emit("signalClosed",t)}),this.controller.on("leaveChannel",this.onUserLeft.bind(this)),this.controller.on("error",function(t){e.emit("error",t)}),this.controller.on("customData",function(t){e.emit("customData",t)}),this.controller.on("data",function(t){e.emit("data",{account:e.getAccountWithUid(t.uid),data:t.data})}),window.addEventListener("beforeunload",this.beforeunload.bind(this))},t.prototype.serializeType=function(e,t){return t&&t!==d.constantBB.CALL_TYPE_NONE?t!==d.constantBB.CALL_TYPE_AUDIO?[e]:[t,e]:[e]},t.prototype.unserializeType=function(e){var t={},n=-1;return e.map(function(e,i){e===d.constantBB.CALL_TYPE_AUDIO&&(t.netcallType=d.constantBB.CALL_TYPE_AUDIO,n=i)}),n!==-1&&e.splice(t.i,1),t.type=e[0],t},t.prototype.call=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.account,n=e.type,i=e.netcallType,o=e.pushConfig,r=e.sessionConfig,s=e.webrtcEnable;return this.calling=!0,this.isCaller=!0,this.callee=t,this.target.account=t,r&&(r.signalStartTime=Date.now(),this.setSessionConfig(r)),this.initWhiteBoard({type:n,netcallType:i,pushConfig:o,webrtcEnable:s})},t.prototype.initWhiteBoard=function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.type,i=t.netcallType,o=t.pushConfig,r=t.webrtcEnable;this.type=n,this.netcallType=i||d.constantBB.CALL_TYPE_NONE,this.setSessionConfig({signalStartTime:Date.now()});var s={type:this.serializeType(this.type,this.netcallType),accounts:[this.callee],pushConfig:o};return r&&(s.webrtcEnable=t.webrtcEnable),this.nim.initWhiteBoard(s).then(function(t){e.signalInited=!0,e.sessionMode="p2p",e.logger.log("initWhiteBoard:",t),e.callerInfo=e.wbFormat(t),e.imInfo=e.callerInfo,e.imInfo.sessionMode=e.sessionMode,e.channelId=t.channelId})["catch"](function(t){throw e.setSessionConfig({signalEndTime:Date.now()}),e.resetWhenHangup(),t})},t.prototype.response=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return e.fn="wbCalleeAck",this.baseResponse(e)},t.prototype.control=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return e.info="",e.fn="wbControl",this.baseControl(e)},t.prototype.hangup=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return e.fn="wbHangup",this.baseHangup(e)},t.prototype.createChannel=function(e){return h["default"].verifyOptions(e,"channelName"),e.custom=e.custom||"",this.baseCreateChannel("wbCreateChannel",e).then(function(e){return Promise.resolve(e)})["catch"](function(e){return Promise.reject(e)})},t.prototype.joinChannel=function(e){var t=this;if(this.signalInited)return Promise.reject("已经加入会议");h["default"].verifyOptions(e,"channelName");var n=e.sessionConfig;return n&&(h["default"].merge(this,{sessionConfig:n}),this.setSessionConfig(n),this.setSessionConfig({signalStartTime:Date.now()})),this.baseJoinChannel("wbJoinChannel",{channelName:e.channelName}).then(function(i){var o=void 0;return i.turnInfoTag&&(o=i.turnInfoTag.dispatchServer&&JSON.parse(i.turnInfoTag.dispatchServer)||i.turnInfoTag.tunnelServer),o&&o.constructor===String&&(o=o.split(";")),o&&o.constructor===Object&&(o=o.webrtcarray),i.serverAddrs=o||[],t.type=i.type=i.type,i.account=t.nim.account,i.sessionConfig=n,t.imInfo=i,t.startSession(e),Promise.resolve({uid:i.uid,account:t.nim.account,type:i.type})})["catch"](function(e){return Promise.reject(e)})},t.prototype.onBeCalled=function(e){e=this.wbFormat(e),this.channelId||(this.signalInited=!0,this.channelId=e.channelId,this.beCalledInfo=e,this.logger.log("beCalling",e)),this.emit("beCalling",e)},t.prototype.wbFormat=function(e){var t=e,n=t.turnInfoTag;return n&&n.constructor===Array?(n.map(function(t){/[01]/.test(t.type)?(e.netcallType=t.type,e.rtcServerMap=t.dispatchServer,e.serverMap=JSON.parse(JSON.stringify(t.dispatchServer))):(e.type=t.type,e.wbServerMap=t.dispatchServer)}),e.netcallType=e.netcallType||d.constantBB.CALL_TYPE_NONE,e=this.format(e),e.serverAddrs=JSON.parse(JSON.stringify(e.wbServerMap))||[],e):e},t.prototype.resetWhenHangup=function(){this.controller.stopSession(),this.resetStatus()},t}(u["default"]),g=y.prototype;h["default"].merge(g,m["default"]),t["default"]=y,e.exports=t["default"]},210:function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}t.__esModule=!0;var a=n(196),c=i(a),u=n(207),l=i(u),p=n(85),f=n(172),h=n(179),d=n(17),v=n(2).Promise,m=3,y=null,g=function(e){function t(n){o(this,t);var i=r(this,e.call(this,n));return i.isCustom=n.isCustom||!0,i.logger=n.logger||{},i.resetStatus(),i}return s(t,e),t}(c["default"]);t["default"]=g;var b=g.prototype;b.resetStatus=function(){this.wbAdapter&&(this.wbAdapter.destory(),this.wbAdapter=null),this.nodeTimer&&(clearInterval(this.nodeTimer),this.nodeTimer=null),this.reConnectCount=0,this.recv_bytes=0,this.send_bytes=0},b.startSession=function(e){var t=this;return this.imInfo=e||this.imInfo,this.connect().then(function(){"meeting"===t.imInfo.sessionMode&&t.initWbAdapter()})},b.connect=function(){var e=this;return this._startSession().then(function(t){return y=t,e.reConnectCount=0,new v(function(t,n){e.wbLogin(),e.once("LoginSuccess",function(n){e.logger.log("once LoginSuccess-->",n),t(y)}),e.once("LoginFailed",function(t){e.logger.log("once LoginFailed-->",t),n(t)})})})},b.stopSession=function(){return this.wbLogout(),this._stopSession(),this.resetStatus(),v.resolve()},b.setSessionConfig=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.sessionConfig=d.merge(this.sessionConfig,e)},b.initWbAdapter=function(){!this.wbAdapter&&this.info.container&&(this.wbAdapter=new l["default"](this.info.container,{UID:this.imInfo.uid,width:parseInt(this.sessionConfig.width)||400,height:parseInt(this.sessionConfig.height)||400,limit:60,debug:this.info.debug}),this.wbAdapter.on("action",this.onWbAdapterData.bind(this)))},b.onWbAdapterData=function(e,t){t&&(e=JSON.stringify({isCustom:1,data:e})),this.send(e)},b.send=function(e){var t={data:e};this.sendStats(e),"p2p"===this.imInfo.sessionMode&&(t.dst_client_id=this.target&&this.target.uid||0);var n="p2p"===this.imInfo.sessionMode?f.gateWay.toUser:f.gateWay.broadcast;this.sendMsg(n,t)},b.wbLogin=function(){var e={token:this.imInfo.cid,client_type:2,client_net:2,client_os:6,client_support_record:~~this.sessionConfig.record};this.sendMsg(f.gateWay.login,e)},b.wbLogout=function(){var e=Date.now(),t={timestamp:e,recv_bytes:this.recv_bytes,send_bytes:this.send_bytes};this.sendMsg(f.gateWay.logout,t)},b.sendMsg=function(e,t){var n={type:e,uid:+this.imInfo.uid,cid:+this.imInfo.cid,version:31,content:{params:t}};this.signal&&this.signal.send(n)},b.onSignalMessage=function(e){if(e&&e.cid&&e.uid&&(e.cid=+e.cid,e.uid=+e.uid),e.cid!==this.imInfo.cid)return this.logger.error("websocket message not belong to this session");var t=h.gateWay[e.type];this["on"+t]&&this["on"+t](e)},b.onloginAck=function(e){var t=this,n=e.content.params.auth_result-0;return 200!==n?(this.logger.error("服务器验证不通过, 断开连接"),void this.emit("LoginFailed",{code:n,error:"服务器验证不通过, 断开连接"})):(this.logger.log("白板服务器登录成功",e),this.emit("LoginSuccess"),void("p2p"===this.imInfo.sessionMode&&(this.userJoinTimeoutId=setTimeout(function(){t.userJoinTimeoutId&&0===Object.keys(t.remoteUidStatus).length&&t.emit("error",{error:"点对点对方登录超时, 断开连接"})},45e3))))},b.onjoin=function(e){this.logger.log(e);var t=e.content&&e.content.params&&e.content.params.client_id;this.startNodeMonitor(t),"p2p"===this.imInfo.sessionMode&&(this.target={uid:t},this.initWbAdapter(),this.userJoinTimeoutId&&clearTimeout(this.userJoinTimeoutId),this.userJoinTimeoutId=0),this.emit("userJoined",{uid:t,cid:e.cid})},b.onkeep_alive_node=function(e){var t=e.uid;this.remoteUidStatus[t].now=Date.now(),this.remoteUidStatus[t].total=45},b.onlogout=function(e){this.logger.log("onlogout",e),this.emit("leaveChannel",{uid:e.uid,channelId:e.cid})},b.ontoUser=function(e){this.onData(e)},b.onbroadcast=function(e){this.onData(e)},b.onData=function(e){var t=e.content&&e.content.params&&e.content.params.data;this.receiveStats(t);var n=void 0;try{n=JSON.parse(t||null)}catch(e){n=t}return this.remoteUidStatus[e.uid].now=Date.now(),this.remoteUidStatus[e.uid].total=45,this.info.isCustom?void this.emit("data",{uid:e.uid,data:n}):n.constructor===Object?void(n.isCustom&&this.emit("customData",{UID:e.uid,data:n.data})):void(this.wbAdapter&&this.wbAdapter.act({UID:e.uid,data:n}))},b.startNodeMonitor=function(e){var t=this,n=this.remoteUidStatus;n[e]=n[e]||{now:Date.now(),total:45},n[e].now=Date.now(),this.nodeTimer||(this.nodeTimer=setInterval(function(){var e=Date.now();Object.keys(n).map(function(i){return e-n[i].now>5e4||n[i].total<=0?(t.logger.error("节点45s超时离开:",i),void t.emit("leaveChannel",{uid:i,type:p.constantBB.HANGUP_TYPE_TIMEOUT,channelId:t.imInfo.cid})):e-n[i].now>5e3?(t.logger.warn("节点5s内未收到心跳包，"+n[i].total+"s后将超时断开:",i),void(n[i].total-=5)):void 0})},5e3))},b.onSignalTimeout=function(){var e=this;return this.reConnectCount>=m?void this.emit("signalClosed"):(this.reConnectCount++,this.logger.log("3s后尝试第"+this.reConnectCount+"次重连服务器"),
this._stopSignal(),void setTimeout(function(){e.logger.log("开始第"+e.reConnectCount+"次重连服务器"),e.logger.log("wss 地址",y),y&&e.imInfo.serverAddrs.unshift(y),e.connect()["catch"](function(t){e.logger.error("reconnect error",t),e.onSignalTimeout()})},3e3))},b.undo=function(){this.wbAdapter&&this.wbAdapter.undo()},b.redo=function(){this.wbAdapter&&this.wbAdapter.redo()},b.clear=function(){this.wbAdapter&&this.wbAdapter.clear()},b.resize=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.wbAdapter.resize(e.width)},b.sendCustomData=function(e){this.onWbAdapterData(e,!0)},b.sendStats=function(e){this.send_bytes+=e.length},b.receiveStats=function(e){this.recv_bytes+=e.length},e.exports=t["default"]}})});