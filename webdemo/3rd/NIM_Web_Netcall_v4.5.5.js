!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.Netcall=t():e.Netcall=t()}(this,function(){return function(e){function t(i){if(n[i])return n[i].exports;var o=n[i]={exports:{},id:i,loaded:!1};return e[i].call(o.exports,o,o.exports,t),o.loaded=!0,o.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}({0:function(e,t,n){"use strict";var i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},o=n(180),r=n(99),a=n(161),s=n(177),c=n(87),u=n(170),l=n(171),d=n(173),h=void 0,p=i({},c,{webgl:o,install:function(e,t){r.install(e,t),a.install(e,t),e.parser.mixin({configMap:u,serializeMap:l,unserializeMap:d}),s.install(e,t)},getInstance:function(e){return h||(h=new s(e)),h},destroy:function(){h&&(h.destroy(),h=null)}});e.exports=p},3:function(e,t,n){(function(t){"use strict";var n="'ff80495d22439d057d1c603288cd9270f8679dff",i="ff80495'",o="4.5.5",r="2.2.0.1013",a="3.5.0",s="40",c=1,u="https://lbs.netease.im/lbs/webconf.jsp",l="development"===t.env.NODE_ENV?6e3:42e3,d={info:{hash:n,shortHash:i,version:o,sdkVersion:s,nrtcVersion:a,protocolVersion:c},agentVersion:r,lbsUrl:u,connectTimeout:l,xhrTimeout:l,socketTimeout:l,reconnectionDelay:656.25,reconnectionDelayMax:l,reconnectionJitter:.1,heartbeatInterval:18e4,cmdTimeout:l};d.formatSocketUrl=function(e){var t=e.url,n=e.secure,i=n?"https":"http";return t.indexOf("http")===-1?i+"://"+t:t},d.fileServerUrl="https://nos.netease.com",d.replaceUrl="http://nos.netease.im",d.genUploadUrl=function(e){return d.uploadUrl?d.uploadUrl+"/"+e:d.fileServerUrl+"/"+e},d.genDownloadUrl=function(e,t){return d.downloadUrl?d.replaceUrl+"/"+e+"/"+t:d.fileServerUrl+"/"+e+"/"+t},e.exports=d}).call(t,n(7))},7:function(e,t){function n(){throw new Error("setTimeout has not been defined")}function i(){throw new Error("clearTimeout has not been defined")}function o(e){if(l===setTimeout)return setTimeout(e,0);if((l===n||!l)&&setTimeout)return l=setTimeout,setTimeout(e,0);try{return l(e,0)}catch(e){try{return l.call(null,e,0)}catch(e){return l.call(this,e,0)}}}function r(e){if(d===clearTimeout)return clearTimeout(e);if((d===i||!d)&&clearTimeout)return d=clearTimeout,clearTimeout(e);try{return d(e)}catch(e){try{return d.call(null,e)}catch(e){return d.call(this,e)}}}function a(){m&&p&&(m=!1,p.length?f=p.concat(f):v=-1,f.length&&s())}function s(){if(!m){var e=o(a);m=!0;for(var t=f.length;t;){for(p=f,f=[];++v<t;)p&&p[v].run();v=-1,t=f.length}p=null,m=!1,r(e)}}function c(e,t){this.fun=e,this.array=t}function u(){}var l,d,h=e.exports={};!function(){try{l="function"==typeof setTimeout?setTimeout:n}catch(e){l=n}try{d="function"==typeof clearTimeout?clearTimeout:i}catch(e){d=i}}();var p,f=[],m=!1,v=-1;h.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];f.push(new c(e,t)),1!==f.length||m||o(s)},c.prototype.run=function(){this.fun.apply(null,this.array)},h.title="browser",h.browser=!0,h.env={},h.argv=[],h.version="",h.versions={},h.on=u,h.addListener=u,h.once=u,h.off=u,h.removeListener=u,h.removeAllListeners=u,h.emit=u,h.binding=function(e){throw new Error("process.binding is not supported")},h.cwd=function(){return"/"},h.chdir=function(e){throw new Error("process.chdir is not supported")},h.umask=function(){return 0}},8:function(e,t,n){"use strict";function i(){}function o(e,t,n){this.fn=e,this.context=t,this.once=n||!1}function r(){this._events=new i,this._eventsCount=0}var a=Object.prototype.hasOwnProperty,s="~";Object.create&&(i.prototype=Object.create(null),(new i).__proto__||(s=!1)),r.prototype.eventNames=function(){var e,t,n=[];if(0===this._eventsCount)return n;for(t in e=this._events)a.call(e,t)&&n.push(s?t.slice(1):t);return Object.getOwnPropertySymbols?n.concat(Object.getOwnPropertySymbols(e)):n},r.prototype.listeners=function(e,t){var n=s?s+e:e,i=this._events[n];if(t)return!!i;if(!i)return[];if(i.fn)return[i.fn];for(var o=0,r=i.length,a=new Array(r);o<r;o++)a[o]=i[o].fn;return a},r.prototype.emit=function(e,t,n,i,o,r){var a=s?s+e:e;if(!this._events[a])return!1;var c,u,l=this._events[a],d=arguments.length;if(l.fn){switch(l.once&&this.removeListener(e,l.fn,void 0,!0),d){case 1:return l.fn.call(l.context),!0;case 2:return l.fn.call(l.context,t),!0;case 3:return l.fn.call(l.context,t,n),!0;case 4:return l.fn.call(l.context,t,n,i),!0;case 5:return l.fn.call(l.context,t,n,i,o),!0;case 6:return l.fn.call(l.context,t,n,i,o,r),!0}for(u=1,c=new Array(d-1);u<d;u++)c[u-1]=arguments[u];l.fn.apply(l.context,c)}else{var h,p=l.length;for(u=0;u<p;u++)switch(l[u].once&&this.removeListener(e,l[u].fn,void 0,!0),d){case 1:l[u].fn.call(l[u].context);break;case 2:l[u].fn.call(l[u].context,t);break;case 3:l[u].fn.call(l[u].context,t,n);break;case 4:l[u].fn.call(l[u].context,t,n,i);break;default:if(!c)for(h=1,c=new Array(d-1);h<d;h++)c[h-1]=arguments[h];l[u].fn.apply(l[u].context,c)}}return!0},r.prototype.on=function(e,t,n){var i=new o(t,n||this),r=s?s+e:e;return this._events[r]?this._events[r].fn?this._events[r]=[this._events[r],i]:this._events[r].push(i):(this._events[r]=i,this._eventsCount++),this},r.prototype.once=function(e,t,n){var i=new o(t,n||this,!0),r=s?s+e:e;return this._events[r]?this._events[r].fn?this._events[r]=[this._events[r],i]:this._events[r].push(i):(this._events[r]=i,this._eventsCount++),this},r.prototype.removeListener=function(e,t,n,o){var r=s?s+e:e;if(!this._events[r])return this;if(!t)return 0===--this._eventsCount?this._events=new i:delete this._events[r],this;var a=this._events[r];if(a.fn)a.fn!==t||o&&!a.once||n&&a.context!==n||(0===--this._eventsCount?this._events=new i:delete this._events[r]);else{for(var c=0,u=[],l=a.length;c<l;c++)(a[c].fn!==t||o&&!a[c].once||n&&a[c].context!==n)&&u.push(a[c]);u.length?this._events[r]=1===u.length?u[0]:u:0===--this._eventsCount?this._events=new i:delete this._events[r]}return this},r.prototype.removeAllListeners=function(e){var t;return e?(t=s?s+e:e,this._events[t]&&(0===--this._eventsCount?this._events=new i:delete this._events[t])):(this._events=new i,this._eventsCount=0),this},r.prototype.off=r.prototype.removeListener,r.prototype.addListener=r.prototype.on,r.prototype.setMaxListeners=function(){return this},r.prefixed=s,r.EventEmitter=r,e.exports=r},9:function(e,t,n){var i;(function(e,o){(function(){"use strict";function r(e){return e=String(e),e.charAt(0).toUpperCase()+e.slice(1)}function a(e,t,n){var i={"10.0":"10",6.4:"10 Technical Preview",6.3:"8.1",6.2:"8",6.1:"Server 2008 R2 / 7","6.0":"Server 2008 / Vista",5.2:"Server 2003 / XP 64-bit",5.1:"XP",5.01:"2000 SP1","5.0":"2000","4.0":"NT","4.90":"ME"};return t&&n&&/^Win/i.test(e)&&!/^Windows Phone /i.test(e)&&(i=i[/[\d.]+$/.exec(e)])&&(e="Windows "+i),e=String(e),t&&n&&(e=e.replace(RegExp(t,"i"),n)),e=c(e.replace(/ ce$/i," CE").replace(/\bhpw/i,"web").replace(/\bMacintosh\b/,"Mac OS").replace(/_PowerPC\b/i," OS").replace(/\b(OS X) [^ \d]+/i,"$1").replace(/\bMac (OS X)\b/,"$1").replace(/\/(\d)/," $1").replace(/_/g,".").replace(/(?: BePC|[ .]*fc[ \d.]+)$/i,"").replace(/\bx86\.64\b/gi,"x86_64").replace(/\b(Windows Phone) OS\b/,"$1").replace(/\b(Chrome OS \w+) [\d.]+\b/,"$1").split(" on ")[0])}function s(e,t){var n=-1,i=e?e.length:0;if("number"==typeof i&&i>-1&&i<=A)for(;++n<i;)t(e[n],n,e);else u(e,t)}function c(e){return e=f(e),/^(?:webOS|i(?:OS|P))/.test(e)?e:r(e)}function u(e,t){for(var n in e)I.call(e,n)&&t(e[n],n,e)}function l(e){return null==e?r(e):w.call(e).slice(8,-1)}function d(e,t){var n=null!=e?typeof e[t]:"number";return!(/^(?:boolean|number|string|undefined)$/.test(n)||"object"==n&&!e[t])}function h(e){return String(e).replace(/([ -])(?!$)/g,"$1?")}function p(e,t){var n=null;return s(e,function(i,o){n=t(n,i,o,e)}),n}function f(e){return String(e).replace(/^ +| +$/g,"")}function m(e){function t(t){return p(t,function(t,n){return t||RegExp("\\b"+(n.pattern||h(n))+"\\b","i").exec(e)&&(n.label||n)})}function n(t){return p(t,function(t,n,i){return t||(n[Q]||n[/^[a-z]+(?: +[a-z]+\b)*/i.exec(Q)]||RegExp("\\b"+h(i)+"(?:\\b|\\w*\\d)","i").exec(e))&&i})}function i(t){return p(t,function(t,n){return t||RegExp("\\b"+(n.pattern||h(n))+"\\b","i").exec(e)&&(n.label||n)})}function o(t){return p(t,function(t,n){var i=n.pattern||h(n);return!t&&(t=RegExp("\\b"+i+"(?:/[\\d.]+|[ \\w.]*)","i").exec(e))&&(t=a(t,i,n.label||n)),t})}function r(t){return p(t,function(t,n){var i=n.pattern||h(n);return!t&&(t=RegExp("\\b"+i+" *\\d+[.\\w_]*","i").exec(e)||RegExp("\\b"+i+"(?:; *(?:[a-z]+[_-])?[a-z]+\\d+|[^ ();-]*)","i").exec(e))&&((t=String(n.label&&!RegExp(i,"i").test(n.label)?n.label:t).split("/"))[1]&&!/[\d.]+/.test(t[0])&&(t[0]+=" "+t[1]),n=n.label||n,t=c(t[0].replace(RegExp(i,"i"),n).replace(RegExp("; *(?:"+n+"[_-])?","i")," ").replace(RegExp("("+n+")[-_.]?(\\w)","i"),"$1 $2"))),t})}function s(t){return p(t,function(t,n){return t||(RegExp(n+"(?:-[\\d.]+/|(?: for [\\w-]+)?[ /-])([\\d.]+[^ ();/_-]*)","i").exec(e)||0)[1]||null})}function v(){return this.description||""}var y=g,b=e&&"object"==typeof e&&"String"!=l(e);b&&(y=e,e=null);var C=y.navigator||{},A=C.userAgent||"";e||(e=A);var E,I,O=b||S==_,x=b?!!C.likeChrome:/\bChrome\b/.test(e)&&!/internal|\n/i.test(w.toString()),M="Object",k=b?M:"ScriptBridgingProxyObject",N=b?M:"Environment",R=b&&y.java?"JavaPackage":l(y.java),D=b?M:"RuntimeObject",L=/\bJava/.test(R)&&y.java,U=L&&l(y.environment)==N,P=L?"a":"α",V=L?"b":"β",j=y.document||{},F=y.operamini||y.opera,B=T.test(B=b&&F?F["[[Class]]"]:l(F))?B:F=null,W=e,H=[],Y=null,q=e==A,z=q&&F&&"function"==typeof F.version&&F.version(),G=t([{label:"EdgeHTML",pattern:"Edge"},"Trident",{label:"WebKit",pattern:"AppleWebKit"},"iCab","Presto","NetFront","Tasman","KHTML","Gecko"]),X=i(["Adobe AIR","Arora","Avant Browser","Breach","Camino","Epiphany","Fennec","Flock","Galeon","GreenBrowser","iCab","Iceweasel","K-Meleon","Konqueror","Lunascape","Maxthon",{label:"Microsoft Edge",pattern:"Edge"},"Midori","Nook Browser","PaleMoon","PhantomJS","Raven","Rekonq","RockMelt","SeaMonkey",{label:"Silk",pattern:"(?:Cloud9|Silk-Accelerated)"},"Sleipnir","SlimBrowser",{label:"SRWare Iron",pattern:"Iron"},"Sunrise","Swiftfox","WebPositive","Opera Mini",{label:"Opera Mini",pattern:"OPiOS"},"Opera",{label:"Opera",pattern:"OPR"},"Chrome",{label:"Chrome Mobile",pattern:"(?:CriOS|CrMo)"},{label:"Firefox",pattern:"(?:Firefox|Minefield)"},{label:"Firefox for iOS",pattern:"FxiOS"},{label:"IE",pattern:"IEMobile"},{label:"IE",pattern:"MSIE"},"Safari"]),Q=r([{label:"BlackBerry",pattern:"BB10"},"BlackBerry",{label:"Galaxy S",pattern:"GT-I9000"},{label:"Galaxy S2",pattern:"GT-I9100"},{label:"Galaxy S3",pattern:"GT-I9300"},{label:"Galaxy S4",pattern:"GT-I9500"},"Google TV","Lumia","iPad","iPod","iPhone","Kindle",{label:"Kindle Fire",pattern:"(?:Cloud9|Silk-Accelerated)"},"Nexus","Nook","PlayBook","PlayStation 3","PlayStation 4","PlayStation Vita","TouchPad","Transformer",{label:"Wii U",pattern:"WiiU"},"Wii","Xbox One",{label:"Xbox 360",pattern:"Xbox"},"Xoom"]),$=n({Apple:{iPad:1,iPhone:1,iPod:1},Archos:{},Amazon:{Kindle:1,"Kindle Fire":1},Asus:{Transformer:1},"Barnes & Noble":{Nook:1},BlackBerry:{PlayBook:1},Google:{"Google TV":1,Nexus:1},HP:{TouchPad:1},HTC:{},LG:{},Microsoft:{Xbox:1,"Xbox One":1},Motorola:{Xoom:1},Nintendo:{"Wii U":1,Wii:1},Nokia:{Lumia:1},Samsung:{"Galaxy S":1,"Galaxy S2":1,"Galaxy S3":1,"Galaxy S4":1},Sony:{"PlayStation 4":1,"PlayStation 3":1,"PlayStation Vita":1}}),J=o(["Windows Phone","Android","CentOS",{label:"Chrome OS",pattern:"CrOS"},"Debian","Fedora","FreeBSD","Gentoo","Haiku","Kubuntu","Linux Mint","OpenBSD","Red Hat","SuSE","Ubuntu","Xubuntu","Cygwin","Symbian OS","hpwOS","webOS ","webOS","Tablet OS","Linux","Mac OS X","Macintosh","Mac","Windows 98;","Windows "]);if(G&&(G=[G]),$&&!Q&&(Q=r([$])),(E=/\bGoogle TV\b/.exec(Q))&&(Q=E[0]),/\bSimulator\b/i.test(e)&&(Q=(Q?Q+" ":"")+"Simulator"),"Opera Mini"==X&&/\bOPiOS\b/.test(e)&&H.push("running in Turbo/Uncompressed mode"),"IE"==X&&/\blike iPhone OS\b/.test(e)?(E=m(e.replace(/like iPhone OS/,"")),$=E.manufacturer,Q=E.product):/^iP/.test(Q)?(X||(X="Safari"),J="iOS"+((E=/ OS ([\d_]+)/i.exec(e))?" "+E[1].replace(/_/g,"."):"")):"Konqueror"!=X||/buntu/i.test(J)?$&&"Google"!=$&&(/Chrome/.test(X)&&!/\bMobile Safari\b/i.test(e)||/\bVita\b/.test(Q))||/\bAndroid\b/.test(J)&&/^Chrome/.test(X)&&/\bVersion\//i.test(e)?(X="Android Browser",J=/\bAndroid\b/.test(J)?J:"Android"):"Silk"==X?(/\bMobi/i.test(e)||(J="Android",H.unshift("desktop mode")),/Accelerated *= *true/i.test(e)&&H.unshift("accelerated")):"PaleMoon"==X&&(E=/\bFirefox\/([\d.]+)\b/.exec(e))?H.push("identifying as Firefox "+E[1]):"Firefox"==X&&(E=/\b(Mobile|Tablet|TV)\b/i.exec(e))?(J||(J="Firefox OS"),Q||(Q=E[1])):X&&!(E=!/\bMinefield\b/i.test(e)&&/\b(?:Firefox|Safari)\b/.exec(X))||(X&&!Q&&/[\/,]|^[^(]+?\)/.test(e.slice(e.indexOf(E+"/")+8))&&(X=null),(E=Q||$||J)&&(Q||$||/\b(?:Android|Symbian OS|Tablet OS|webOS)\b/.test(J))&&(X=/[a-z]+(?: Hat)?/i.exec(/\bAndroid\b/.test(J)?J:E)+" Browser")):J="Kubuntu",z||(z=s(["(?:Cloud9|CriOS|CrMo|Edge|FxiOS|IEMobile|Iron|Opera ?Mini|OPiOS|OPR|Raven|Silk(?!/[\\d.]+$))","Version",h(X),"(?:Firefox|Minefield|NetFront)"])),(E="iCab"==G&&parseFloat(z)>3&&"WebKit"||/\bOpera\b/.test(X)&&(/\bOPR\b/.test(e)?"Blink":"Presto")||/\b(?:Midori|Nook|Safari)\b/i.test(e)&&!/^(?:Trident|EdgeHTML)$/.test(G)&&"WebKit"||!G&&/\bMSIE\b/i.test(e)&&("Mac OS"==J?"Tasman":"Trident")||"WebKit"==G&&/\bPlayStation\b(?! Vita\b)/i.test(X)&&"NetFront")&&(G=[E]),"IE"==X&&(E=(/; *(?:XBLWP|ZuneWP)(\d+)/i.exec(e)||0)[1])?(X+=" Mobile",J="Windows Phone "+(/\+$/.test(E)?E:E+".x"),H.unshift("desktop mode")):/\bWPDesktop\b/i.test(e)?(X="IE Mobile",J="Windows Phone 8.x",H.unshift("desktop mode"),z||(z=(/\brv:([\d.]+)/.exec(e)||0)[1])):"IE"!=X&&"Trident"==G&&(E=/\brv:([\d.]+)/.exec(e))&&(X&&H.push("identifying as "+X+(z?" "+z:"")),X="IE",z=E[1]),q){if(d(y,"global"))if(L&&(E=L.lang.System,W=E.getProperty("os.arch"),J=J||E.getProperty("os.name")+" "+E.getProperty("os.version")),O&&d(y,"system")&&(E=[y.system])[0]){J||(J=E[0].os||null);try{E[1]=y.require("ringo/engine").version,z=E[1].join("."),X="RingoJS"}catch(e){E[0].global.system==y.system&&(X="Narwhal")}}else"object"==typeof y.process&&!y.process.browser&&(E=y.process)?(X="Node.js",W=E.arch,J=E.platform,z=/[\d.]+/.exec(E.version)[0]):U&&(X="Rhino");else l(E=y.runtime)==k?(X="Adobe AIR",J=E.flash.system.Capabilities.os):l(E=y.phantom)==D?(X="PhantomJS",z=(E=E.version||null)&&E.major+"."+E.minor+"."+E.patch):"number"==typeof j.documentMode&&(E=/\bTrident\/(\d+)/i.exec(e))&&(z=[z,j.documentMode],(E=+E[1]+4)!=z[1]&&(H.push("IE "+z[1]+" mode"),G&&(G[1]=""),z[1]=E),z="IE"==X?String(z[1].toFixed(1)):z[0]);J=J&&c(J)}z&&(E=/(?:[ab]|dp|pre|[ab]\d+pre)(?:\d+\+?)?$/i.exec(z)||/(?:alpha|beta)(?: ?\d)?/i.exec(e+";"+(q&&C.appMinorVersion))||/\bMinefield\b/i.test(e)&&"a")&&(Y=/b/i.test(E)?"beta":"alpha",z=z.replace(RegExp(E+"\\+?$"),"")+("beta"==Y?V:P)+(/\d+\+?/.exec(E)||"")),"Fennec"==X||"Firefox"==X&&/\b(?:Android|Firefox OS)\b/.test(J)?X="Firefox Mobile":"Maxthon"==X&&z?z=z.replace(/\.[\d.]+/,".x"):/\bXbox\b/i.test(Q)?(J=null,"Xbox 360"==Q&&/\bIEMobile\b/.test(e)&&H.unshift("mobile mode")):!/^(?:Chrome|IE|Opera)$/.test(X)&&(!X||Q||/Browser|Mobi/.test(X))||"Windows CE"!=J&&!/Mobi/i.test(e)?"IE"==X&&q&&null===y.external?H.unshift("platform preview"):(/\bBlackBerry\b/.test(Q)||/\bBB10\b/.test(e))&&(E=(RegExp(Q.replace(/ +/g," *")+"/([.\\d]+)","i").exec(e)||0)[1]||z)?(E=[E,/BB10/.test(e)],J=(E[1]?(Q=null,$="BlackBerry"):"Device Software")+" "+E[0],z=null):this!=u&&"Wii"!=Q&&(q&&F||/Opera/.test(X)&&/\b(?:MSIE|Firefox)\b/i.test(e)||"Firefox"==X&&/\bOS X (?:\d+\.){2,}/.test(J)||"IE"==X&&(J&&!/^Win/.test(J)&&z>5.5||/\bWindows XP\b/.test(J)&&z>8||8==z&&!/\bTrident\b/.test(e)))&&!T.test(E=m.call(u,e.replace(T,"")+";"))&&E.name&&(E="ing as "+E.name+((E=E.version)?" "+E:""),T.test(X)?(/\bIE\b/.test(E)&&"Mac OS"==J&&(J=null),E="identify"+E):(E="mask"+E,X=B?c(B.replace(/([a-z])([A-Z])/g,"$1 $2")):"Opera",/\bIE\b/.test(E)&&(J=null),q||(z=null)),G=["Presto"],H.push(E)):X+=" Mobile",(E=(/\bAppleWebKit\/([\d.]+\+?)/i.exec(e)||0)[1])&&(E=[parseFloat(E.replace(/\.(\d)$/,".0$1")),E],"Safari"==X&&"+"==E[1].slice(-1)?(X="WebKit Nightly",Y="alpha",z=E[1].slice(0,-1)):z!=E[1]&&z!=(E[2]=(/\bSafari\/([\d.]+\+?)/i.exec(e)||0)[1])||(z=null),E[1]=(/\bChrome\/([\d.]+)/i.exec(e)||0)[1],537.36==E[0]&&537.36==E[2]&&parseFloat(E[1])>=28&&"WebKit"==G&&(G=["Blink"]),q&&(x||E[1])?(G&&(G[1]="like Chrome"),E=E[1]||(E=E[0],E<530?1:E<532?2:E<532.05?3:E<533?4:E<534.03?5:E<534.07?6:E<534.1?7:E<534.13?8:E<534.16?9:E<534.24?10:E<534.3?11:E<535.01?12:E<535.02?"13+":E<535.07?15:E<535.11?16:E<535.19?17:E<536.05?18:E<536.1?19:E<537.01?20:E<537.11?"21+":E<537.13?23:E<537.18?24:E<537.24?25:E<537.36?26:"Blink"!=G?"27":"28")):(G&&(G[1]="like Safari"),E=E[0],E=E<400?1:E<500?2:E<526?3:E<533?4:E<534?"4+":E<535?5:E<537?6:E<538?7:E<601?8:"8"),G&&(G[1]+=" "+(E+="number"==typeof E?".x":/[.+]/.test(E)?"":"+")),"Safari"==X&&(!z||parseInt(z)>45)&&(z=E)),"Opera"==X&&(E=/\bzbov|zvav$/.exec(J))?(X+=" ",H.unshift("desktop mode"),"zvav"==E?(X+="Mini",z=null):X+="Mobile",J=J.replace(RegExp(" *"+E+"$"),"")):"Safari"==X&&/\bChrome\b/.exec(G&&G[1])&&(H.unshift("desktop mode"),X="Chrome Mobile",z=null,/\bOS X\b/.test(J)?($="Apple",J="iOS 4.3+"):J=null),z&&0==z.indexOf(E=/[\d.]+$/.exec(J))&&e.indexOf("/"+E+"-")>-1&&(J=f(J.replace(E,""))),G&&!/\b(?:Avant|Nook)\b/.test(X)&&(/Browser|Lunascape|Maxthon/.test(X)||"Safari"!=X&&/^iOS/.test(J)&&/\bSafari\b/.test(G[1])||/^(?:Adobe|Arora|Breach|Midori|Opera|Phantom|Rekonq|Rock|Sleipnir|Web)/.test(X)&&G[1])&&(E=G[G.length-1])&&H.push(E),H.length&&(H=["("+H.join("; ")+")"]),$&&Q&&Q.indexOf($)<0&&H.push("on "+$),Q&&H.push((/^on /.test(H[H.length-1])?"":"on ")+Q),J&&(E=/ ([\d.+]+)$/.exec(J),I=E&&"/"==J.charAt(J.length-E[0].length-1),J={architecture:32,family:E&&!I?J.replace(E[0],""):J,version:E?E[1]:null,toString:function(){var e=this.version;return this.family+(e&&!I?" "+e:"")+(64==this.architecture?" 64-bit":"")}}),(E=/\b(?:AMD|IA|Win|WOW|x86_|x)64\b/i.exec(W))&&!/\bi686\b/i.test(W)?(J&&(J.architecture=64,J.family=J.family.replace(RegExp(" *"+E),"")),X&&(/\bWOW64\b/i.test(e)||q&&/\w(?:86|32)$/.test(C.cpuClass||C.platform)&&!/\bWin64; x64\b/i.test(e))&&H.unshift("32-bit")):J&&/^OS X/.test(J.family)&&"Chrome"==X&&parseFloat(z)>=39&&(J.architecture=64),e||(e=null);var K={};return K.description=e,K.layout=G&&G[0],K.manufacturer=$,K.name=X,K.prerelease=Y,K.product=Q,K.ua=e,K.version=X&&z,K.os=J||{architecture:null,family:null,version:null,toString:function(){return"null"}},K.parse=m,K.toString=v,K.version&&H.unshift(z),K.name&&H.unshift(X),J&&X&&(J!=String(J).split(" ")[0]||J!=X.split(" ")[0]&&!Q)&&H.push(Q?"("+J+")":"on "+J),H.length&&(K.description=H.join(" ")),K}var v={"function":!0,object:!0},g=v[typeof window]&&window||this,_=g,y=v[typeof t]&&t,b=v[typeof e]&&e&&!e.nodeType&&e,C=y&&b&&"object"==typeof o&&o;!C||C.global!==C&&C.window!==C&&C.self!==C||(g=C);var A=Math.pow(2,53)-1,T=/\bOpera/,S=this,E=Object.prototype,I=E.hasOwnProperty,w=E.toString,O=m();g.platform=O,i=function(){return O}.call(t,n,t,e),!(void 0!==i&&(e.exports=i))}).call(this)}).call(t,n(14)(e),function(){return this}())},14:function(e,t){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children=[],e.webpackPolyfill=1),e}},33:function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}t.__esModule=!0,t["default"]=function(e){if(!e.url||!e.data)return Promise.reject("参数不完整，无法发起请求");var t={method:e.type||"get",url:e.url,responseType:e.dataType||"json"};return/^get$/gi.test(t.method)&&(t.params=e.data),/^post$/gi.test(t.method)&&(t.data=e.data),(0,r["default"])(t)};var o=n(72),r=i(o);e.exports=t["default"]},55:function(e,t){"use strict";function n(e){i(e.enable)&&(this.enable=e.enable?1:0),i(e.needBadge)&&(this.needBadge=e.needBadge?1:0),i(e.needPushNick)&&(this.needPushNick=e.needPushNick?1:0),i(e.pushContent)&&(this.pushContent=""+e.pushContent),i(e.custom)&&(this.custom=""+e.custom),i(e.pushPayload)&&(this.pushPayload=""+e.pushPayload),i(e.sound)&&(this.sound=""+e.sound),i(e.webrtcEnable)&&(this.webrtcEnable=e.webrtcEnable?1:0)}t.__esModule=!0,t["default"]=function(e){var t=e.util;return i=t.notundef,n};var i=void 0;e.exports=t["default"]},67:function(e,t){"use strict";var n={};n.html2node=function(e){var t=document.createElement("div");t.innerHTML=e;var n,i,o=[];if(t.children)for(n=0,i=t.children.length;n<i;n++)o.push(t.children[n]);else for(n=0,i=t.childNodes.length;n<i;n++){var r=t.childNodes[n];1===r.nodeType&&o.push(r)}return o.length>1?t:o[0]},n.n2node=function(e){return e?/HTML.+Element/gi.test(e)?e:e[0]&&/HTML.+Element/gi.test(e[0])?e[0]:null:null},e.exports=n},72:function(e,t,n){(function(t){!function(t,n){e.exports=n()}(this,function(){return function(e){function t(i){if(n[i])return n[i].exports;var o=n[i]={exports:{},id:i,loaded:!1};return e[i].call(o.exports,o,o.exports,t),o.loaded=!0,o.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(e,t,n){e.exports=n(1)},function(e,t,n){"use strict";function i(e){var t=new a(e),n=r(a.prototype.request,t);return o.extend(n,a.prototype,t),o.extend(n,t),n}var o=n(2),r=n(3),a=n(4),s=n(5),c=i(s);c.Axios=a,c.create=function(e){return i(o.merge(s,e))},c.Cancel=n(22),c.CancelToken=n(23),c.isCancel=n(19),c.all=function(e){return Promise.all(e)},c.spread=n(24),e.exports=c,e.exports["default"]=c},function(e,t,n){"use strict";function i(e){return"[object Array]"===T.call(e)}function o(e){return"[object ArrayBuffer]"===T.call(e)}function r(e){return"undefined"!=typeof FormData&&e instanceof FormData}function a(e){var t;return t="undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(e):e&&e.buffer&&e.buffer instanceof ArrayBuffer}function s(e){return"string"==typeof e}function c(e){return"number"==typeof e}function u(e){return"undefined"==typeof e}function l(e){return null!==e&&"object"==typeof e}function d(e){return"[object Date]"===T.call(e)}function h(e){return"[object File]"===T.call(e)}function p(e){return"[object Blob]"===T.call(e)}function f(e){return"[object Function]"===T.call(e)}function m(e){return l(e)&&f(e.pipe)}function v(e){return"undefined"!=typeof URLSearchParams&&e instanceof URLSearchParams}function g(e){return e.replace(/^\s*/,"").replace(/\s*$/,"")}function _(){return"undefined"!=typeof window&&"undefined"!=typeof document&&"function"==typeof document.createElement}function y(e,t){if(null!==e&&"undefined"!=typeof e)if("object"==typeof e||i(e)||(e=[e]),i(e))for(var n=0,o=e.length;n<o;n++)t.call(null,e[n],n,e);else for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.call(null,e[r],r,e)}function b(){function e(e,n){"object"==typeof t[n]&&"object"==typeof e?t[n]=b(t[n],e):t[n]=e}for(var t={},n=0,i=arguments.length;n<i;n++)y(arguments[n],e);return t}function C(e,t,n){return y(t,function(t,i){n&&"function"==typeof t?e[i]=A(t,n):e[i]=t}),e}var A=n(3),T=Object.prototype.toString;e.exports={isArray:i,isArrayBuffer:o,isFormData:r,isArrayBufferView:a,isString:s,isNumber:c,isObject:l,isUndefined:u,isDate:d,isFile:h,isBlob:p,isFunction:f,isStream:m,isURLSearchParams:v,isStandardBrowserEnv:_,forEach:y,merge:b,extend:C,trim:g}},function(e,t){"use strict";e.exports=function(e,t){return function(){for(var n=new Array(arguments.length),i=0;i<n.length;i++)n[i]=arguments[i];return e.apply(t,n)}}},function(e,t,n){"use strict";function i(e){this.defaults=e,this.interceptors={request:new a,response:new a}}var o=n(5),r=n(2),a=n(16),s=n(17),c=n(20),u=n(21);i.prototype.request=function(e){"string"==typeof e&&(e=r.merge({url:arguments[0]},arguments[1])),e=r.merge(o,this.defaults,{method:"get"},e),e.baseURL&&!c(e.url)&&(e.url=u(e.baseURL,e.url));var t=[s,void 0],n=Promise.resolve(e);for(this.interceptors.request.forEach(function(e){t.unshift(e.fulfilled,e.rejected)}),this.interceptors.response.forEach(function(e){t.push(e.fulfilled,e.rejected)});t.length;)n=n.then(t.shift(),t.shift());return n},r.forEach(["delete","get","head"],function(e){i.prototype[e]=function(t,n){return this.request(r.merge(n||{},{method:e,url:t}))}}),r.forEach(["post","put","patch"],function(e){i.prototype[e]=function(t,n,i){return this.request(r.merge(i||{},{method:e,url:t,data:n}))}}),e.exports=i},function(e,n,i){"use strict";function o(e,t){!a.isUndefined(e)&&a.isUndefined(e["Content-Type"])&&(e["Content-Type"]=t)}function r(){var e;return"undefined"!=typeof XMLHttpRequest?e=i(7):"undefined"!=typeof t&&(e=i(7)),e}var a=i(2),s=i(6),c=/^\)\]\}',?\n/,u={"Content-Type":"application/x-www-form-urlencoded"},l={adapter:r(),transformRequest:[function(e,t){return s(t,"Content-Type"),a.isFormData(e)||a.isArrayBuffer(e)||a.isStream(e)||a.isFile(e)||a.isBlob(e)?e:a.isArrayBufferView(e)?e.buffer:a.isURLSearchParams(e)?(o(t,"application/x-www-form-urlencoded;charset=utf-8"),e.toString()):a.isObject(e)?(o(t,"application/json;charset=utf-8"),JSON.stringify(e)):e}],transformResponse:[function(e){if("string"==typeof e){e=e.replace(c,"");try{e=JSON.parse(e)}catch(e){}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,validateStatus:function(e){return e>=200&&e<300}};l.headers={common:{Accept:"application/json, text/plain, */*"}},a.forEach(["delete","get","head"],function(e){l.headers[e]={}}),a.forEach(["post","put","patch"],function(e){l.headers[e]=a.merge(u)}),e.exports=l},function(e,t,n){"use strict";var i=n(2);e.exports=function(e,t){i.forEach(e,function(n,i){i!==t&&i.toUpperCase()===t.toUpperCase()&&(e[t]=n,delete e[i])})}},function(e,t,n){"use strict";var i=n(2),o=n(8),r=n(11),a=n(12),s=n(13),c=n(9),u="undefined"!=typeof window&&window.btoa&&window.btoa.bind(window)||n(14);e.exports=function(e){return new Promise(function(t,l){var d=e.data,h=e.headers;i.isFormData(d)&&delete h["Content-Type"];var p=new XMLHttpRequest,f="onreadystatechange",m=!1;if("undefined"==typeof window||!window.XDomainRequest||"withCredentials"in p||s(e.url)||(p=new window.XDomainRequest,f="onload",m=!0,p.onprogress=function(){},p.ontimeout=function(){}),e.auth){var v=e.auth.username||"",g=e.auth.password||"";h.Authorization="Basic "+u(v+":"+g)}if(p.open(e.method.toUpperCase(),r(e.url,e.params,e.paramsSerializer),!0),p.timeout=e.timeout,p[f]=function(){if(p&&(4===p.readyState||m)&&(0!==p.status||p.responseURL&&0===p.responseURL.indexOf("file:"))){var n="getAllResponseHeaders"in p?a(p.getAllResponseHeaders()):null,i=e.responseType&&"text"!==e.responseType?p.response:p.responseText,r={data:i,status:1223===p.status?204:p.status,statusText:1223===p.status?"No Content":p.statusText,headers:n,config:e,request:p};o(t,l,r),p=null}},p.onerror=function(){l(c("Network Error",e)),p=null},p.ontimeout=function(){l(c("timeout of "+e.timeout+"ms exceeded",e,"ECONNABORTED")),p=null},i.isStandardBrowserEnv()){var _=n(15),y=(e.withCredentials||s(e.url))&&e.xsrfCookieName?_.read(e.xsrfCookieName):void 0;y&&(h[e.xsrfHeaderName]=y)}if("setRequestHeader"in p&&i.forEach(h,function(e,t){"undefined"==typeof d&&"content-type"===t.toLowerCase()?delete h[t]:p.setRequestHeader(t,e)}),e.withCredentials&&(p.withCredentials=!0),e.responseType)try{p.responseType=e.responseType}catch(e){if("json"!==p.responseType)throw e}"function"==typeof e.onDownloadProgress&&p.addEventListener("progress",e.onDownloadProgress),"function"==typeof e.onUploadProgress&&p.upload&&p.upload.addEventListener("progress",e.onUploadProgress),e.cancelToken&&e.cancelToken.promise.then(function(e){p&&(p.abort(),l(e),p=null)}),void 0===d&&(d=null),p.send(d)})}},function(e,t,n){"use strict";var i=n(9);e.exports=function(e,t,n){var o=n.config.validateStatus;n.status&&o&&!o(n.status)?t(i("Request failed with status code "+n.status,n.config,null,n)):e(n)}},function(e,t,n){"use strict";var i=n(10);e.exports=function(e,t,n,o){var r=new Error(e);return i(r,t,n,o)}},function(e,t){"use strict";e.exports=function(e,t,n,i){return e.config=t,n&&(e.code=n),e.response=i,e}},function(e,t,n){"use strict";function i(e){return encodeURIComponent(e).replace(/%40/gi,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}var o=n(2);e.exports=function(e,t,n){if(!t)return e;var r;if(n)r=n(t);else if(o.isURLSearchParams(t))r=t.toString();else{var a=[];o.forEach(t,function(e,t){null!==e&&"undefined"!=typeof e&&(o.isArray(e)&&(t+="[]"),o.isArray(e)||(e=[e]),o.forEach(e,function(e){o.isDate(e)?e=e.toISOString():o.isObject(e)&&(e=JSON.stringify(e)),a.push(i(t)+"="+i(e))}))}),r=a.join("&")}return r&&(e+=(e.indexOf("?")===-1?"?":"&")+r),e}},function(e,t,n){"use strict";var i=n(2);e.exports=function(e){var t,n,o,r={};return e?(i.forEach(e.split("\n"),function(e){o=e.indexOf(":"),t=i.trim(e.substr(0,o)).toLowerCase(),n=i.trim(e.substr(o+1)),t&&(r[t]=r[t]?r[t]+", "+n:n)}),r):r}},function(e,t,n){"use strict";var i=n(2);e.exports=i.isStandardBrowserEnv()?function(){function e(e){var t=e;return n&&(o.setAttribute("href",t),t=o.href),o.setAttribute("href",t),{href:o.href,protocol:o.protocol?o.protocol.replace(/:$/,""):"",host:o.host,search:o.search?o.search.replace(/^\?/,""):"",hash:o.hash?o.hash.replace(/^#/,""):"",hostname:o.hostname,port:o.port,pathname:"/"===o.pathname.charAt(0)?o.pathname:"/"+o.pathname}}var t,n=/(msie|trident)/i.test(navigator.userAgent),o=document.createElement("a");return t=e(window.location.href),function(n){var o=i.isString(n)?e(n):n;return o.protocol===t.protocol&&o.host===t.host}}():function(){return function(){return!0}}()},function(e,t){"use strict";function n(){this.message="String contains an invalid character"}function i(e){for(var t,i,r=String(e),a="",s=0,c=o;r.charAt(0|s)||(c="=",s%1);a+=c.charAt(63&t>>8-s%1*8)){if(i=r.charCodeAt(s+=.75),i>255)throw new n;t=t<<8|i}return a}var o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";n.prototype=new Error,n.prototype.code=5,n.prototype.name="InvalidCharacterError",e.exports=i},function(e,t,n){"use strict";var i=n(2);e.exports=i.isStandardBrowserEnv()?function(){return{write:function(e,t,n,o,r,a){var s=[];s.push(e+"="+encodeURIComponent(t)),i.isNumber(n)&&s.push("expires="+new Date(n).toGMTString()),i.isString(o)&&s.push("path="+o),i.isString(r)&&s.push("domain="+r),a===!0&&s.push("secure"),document.cookie=s.join("; ")},read:function(e){var t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove:function(e){this.write(e,"",Date.now()-864e5)}}}():function(){return{write:function(){},read:function(){return null},remove:function(){}}}()},function(e,t,n){"use strict";function i(){this.handlers=[]}var o=n(2);i.prototype.use=function(e,t){return this.handlers.push({fulfilled:e,rejected:t}),this.handlers.length-1},i.prototype.eject=function(e){this.handlers[e]&&(this.handlers[e]=null)},i.prototype.forEach=function(e){o.forEach(this.handlers,function(t){null!==t&&e(t)})},e.exports=i},function(e,t,n){"use strict";function i(e){e.cancelToken&&e.cancelToken.throwIfRequested()}var o=n(2),r=n(18),a=n(19),s=n(5);e.exports=function(e){i(e),e.headers=e.headers||{},e.data=r(e.data,e.headers,e.transformRequest),e.headers=o.merge(e.headers.common||{},e.headers[e.method]||{},e.headers||{}),o.forEach(["delete","get","head","post","put","patch","common"],function(t){delete e.headers[t]});var t=e.adapter||s.adapter;return t(e).then(function(t){return i(e),t.data=r(t.data,t.headers,e.transformResponse),t},function(t){return a(t)||(i(e),t&&t.response&&(t.response.data=r(t.response.data,t.response.headers,e.transformResponse))),Promise.reject(t)})}},function(e,t,n){"use strict";var i=n(2);e.exports=function(e,t,n){return i.forEach(n,function(n){e=n(e,t)}),e}},function(e,t){"use strict";e.exports=function(e){return!(!e||!e.__CANCEL__)}},function(e,t){"use strict";e.exports=function(e){return/^([a-z][a-z\d\+\-\.]*:)?\/\//i.test(e)}},function(e,t){"use strict";e.exports=function(e,t){
return e.replace(/\/+$/,"")+"/"+t.replace(/^\/+/,"")}},function(e,t){"use strict";function n(e){this.message=e}n.prototype.toString=function(){return"Cancel"+(this.message?": "+this.message:"")},n.prototype.__CANCEL__=!0,e.exports=n},function(e,t,n){"use strict";function i(e){if("function"!=typeof e)throw new TypeError("executor must be a function.");var t;this.promise=new Promise(function(e){t=e});var n=this;e(function(e){n.reason||(n.reason=new o(e),t(n.reason))})}var o=n(22);i.prototype.throwIfRequested=function(){if(this.reason)throw this.reason},i.source=function(){var e,t=new i(function(t){e=t});return{token:t,cancel:e}},e.exports=i},function(e,t){"use strict";e.exports=function(e){return function(t){return e.apply(null,t)}}}])})}).call(t,n(7))},86:function(e,t,n){"use strict";var i=n(146),o=n(147),r={};r.install=function(e){i.install(e),o.install(e)},r.init=function(e,t){this.dataApi=new i(e,t),this.dataRtc=new o(e)},e.exports=r},87:function(e,t){"use strict";t.__esModule=!0;var n,i,o={NETCALL_TYPE_AUDIO:1,NETCALL_TYPE_VIDEO:2,NETCALL_CONTROL_COMMAND_NOTIFY_AUDIO_ON:1,NETCALL_CONTROL_COMMAND_NOTIFY_AUDIO_OFF:2,NETCALL_CONTROL_COMMAND_NOTIFY_VIDEO_ON:3,NETCALL_CONTROL_COMMAND_NOTIFY_VIDEO_OFF:4,NETCALL_CONTROL_COMMAND_SWITCH_AUDIO_TO_VIDEO:5,NETCALL_CONTROL_COMMAND_SWITCH_AUDIO_TO_VIDEO_AGREE:6,NETCALL_CONTROL_COMMAND_SWITCH_AUDIO_TO_VIDEO_REJECT:7,NETCALL_CONTROL_COMMAND_SWITCH_VIDEO_TO_AUDIO:8,NETCALL_CONTROL_COMMAND_BUSY:9,NETCALL_CONTROL_COMMAND_SELF_CAMERA_INVALID:10,NETCALL_CONTROL_COMMAND_SELF_AUDIO_INVALID:11,NETCALL_CONTROL_COMMAND_SELF_ON_BACKGROUND:12,NETCALL_CONTROL_COMMAND_START_NOTIFY_RECEIVED:13,NETCALL_CONTROL_COMMAND_NOTIFY_RECORD_START:14,NETCALL_CONTROL_COMMAND_NOTIFY_RECORD_STOP:15,DEVICE_TYPE_AUDIO_IN:0,DEVICE_TYPE_AUDIO_OUT_LOCAL:1,DEVICE_TYPE_AUDIO_OUT_CHAT:2,DEVICE_TYPE_VIDEO:3,DEVICE_STATUS_NO_CHANGE:0,DEVICE_STATUS_CHANGE:1,DEVICE_STATUS_WORK_REMOVE:2,DEVICE_STATUS_RESET:4,DEVICE_STATUS_START:8,DEVICE_STATUS_END:16,CHAT_VIDEO_QUALITY_NORMAL:0,CHAT_VIDEO_QUALITY_LOW:1,CHAT_VIDEO_QUALITY_MEDIUM:2,CHAT_VIDEO_QUALITY_HIGH:3,CHAT_VIDEO_QUALITY_480P:4,CHAT_VIDEO_QUALITY_720P:5,CHAT_VIDEO_QUALITY_540P:6,CHAT_VIDEO_ENCODEMODE_NORMAL:0,CHAT_VIDEO_ENCODEMODE_SMOOTH:1,CHAT_VIDEO_ENCODEMODE_QUALITY:2,CHAT_VIDEO_FRAME_RATE_NORMAL:0,CHAT_VIDEO_FRAME_RATE_5:1,CHAT_VIDEO_FRAME_RATE_10:2,CHAT_VIDEO_FRAME_RATE_15:3,CHAT_VIDEO_FRAME_RATE_20:4,CHAT_VIDEO_FRAME_RATE_25:5,CHAT_VIDEO_SCALE_None:0,CHAT_VIDEO_SCALE_1x1:1,CHAT_VIDEO_SCALE_4x3:2,CHAT_VIDEO_SCALE_16x9:3,CHAT_USER_LEFT_TIMEOUT:-1,CHAT_USER_LEFT_NORMAL:0,CHAT_NET_STATUS_VERY_GOOD:0,CHAT_NET_STATUS_GOOD:1,CHAT_NET_STATUS_POOR:2,CHAT_NET_STATUS_BAD:3,CHAT_NET_STATUS_VERY_BAD:4,CLIENT_TYPE_AOS:1,CLIENT_TYPE_IOS:2,CLIENT_TYPE_PC:4,CLIENT_TYPE_WINPHONE:8,CLIENT_TYPE_WEB:16,CLIENT_TYPE_REST:32,LAYOUT_SPLITBOTTOMHORFLOATING:0,LAYOUT_SPLITTOPHORFLOATING:1,LAYOUT_SPLITLATTICETILE:2,LAYOUT_SPLITLATTICECUTTINGTILE:3,LAYOUT_SPLITCUSTOMLAYOUT:4,LAYOUT_SPLITAUDIOLAYOUT:5,NETDETECT_AUDIO:0,NETDETECT_VIDEO:1};o.deviceTypeMap=(n={},n[o.DEVICE_TYPE_AUDIO_IN]="audioIn",n[o.DEVICE_TYPE_AUDIO_OUT_CHAT]="audioOut",n[o.DEVICE_TYPE_VIDEO]="video",n),o.getDeviceTypeStr=function(e){return o.deviceTypeMap[e]},o.deviceStatusMap=(i={},i[o.DEVICE_STATUS_NO_CHANGE]="noChange",i[o.DEVICE_STATUS_CHANGE]="change",i[o.DEVICE_STATUS_WORK_REMOVE]="workRemove",i[o.DEVICE_STATUS_RESET]="reset",i[o.DEVICE_STATUS_START]="start",i[o.DEVICE_STATUS_END]="end",i),o.getDeviceStatusStr=function(e){return o.deviceStatusMap[e]},t["default"]=o,e.exports=t["default"]},99:function(e,t,n){"use strict";var i=n(55),o={};o.install=function(e){var t=e.fn,n=e.util,o=i({util:n});t.initNetcall=function(e){return n.verifyOptions(e,"type accounts"),e.pushContent="",e.custom="",e.pushConfig||(e.pushConfig={}),e.pushConfig.webrtcEnable=e.webrtcEnable,e.pushConfig=new o(e.pushConfig),this.cbAndSendCmd("initNetcall",e)},t.keepCalling=function(e){return n.verifyOptions(e,"type accounts channelId"),this.cbAndSendCmd("keepCalling",e)},t.calleeAck=function(e){return n.verifyOptions(e,"account channelId type accepted"),this.cbAndSendCmd("calleeAck",e)},t.hangup=function(e){return n.verifyOptions(e,"channelId"),this.cbAndSendCmd("hangup",e)},t.netcallControl=function(e){return n.verifyOptions(e,"channelId type"),this.cbAndSendCmd("netcallControl",e)},t.createChannel=function(e){return this.cbAndSendCmd("createChannel",e)},t.joinChannel=function(e){return n.verifyOptions(e,"channelName"),n.verifyBooleanWithDefault(e,"liveEnable",!1),n.verifyBooleanWithDefault(e,"webrtcEnable",!1),this.cbAndSendCmd("joinChannel",{channelName:e.channelName,liveOption:{liveEnable:e.liveEnable?1:0,webrtcEnable:e.webrtcEnable?1:0}})},t.queryAccountUidMap=function(e,t){return this.cbAndSendCmd("queryAccountUidMap",{channelName:e,uids:t})}},e.exports=o},146:function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var r=n(33),a=i(r),s=n(3),c=s.info.nrtcVersion,u="https://statistic.live.126.net/statistic/realtime/sdkFunctioninfo",l=void 0,d=void 0,h=function f(e,t){o(this,f),this.apis={},this.isRtc=/WebRTC/.test(t),this.init(e,t),this.resetStatus()};h.install=function(e){l=l||e.Promise,d=e.util};var p=h.prototype;p.init=function(e,t){d.merge(this.apis,{ver:1,platform:t,sdk_ver:c||"v4.4.0",uid:null,appkey:e,time:null})},p.startInfo=function(e){d.merge(this.apis,e)},p.resetStatus=function(){this.calling=!1,d.merge(this.apis,{p2p:{value:0},meeting:{value:0},bypass:{value:0},call_control_type:{value:0},self_mute:{value:-1},self_mic_mute:{value:-1},switch_p2p_type:{value:0},set_speaker:{value:-1},net_detect:{value:this.isRtc?-1:0},beautify:{value:-1},water_mark:{value:-1},audio_samples:{value:-1},video_samples:{value:-1},pre_view_mirror:{value:-1},code_mirror:{value:-1},custom_audio:{value:-1},custom_video:{value:-1},audio_mix:{value:-1},snap_shot:{value:-1},record:{value:0},audio_record:{value:0},display:{value:0},android_compatibility:{value:-1},hd_audio:{value:0},video_quality:{value:0},fps:{value:0},prefered_video_encoder:{value:-1},prefered_video_decoder:{value:-1},video_max_encode_bitrate:{value:this.isRtc?-1:0},audio_scene:{value:-1},video_adaptive_strategy:{value:this.isRtc?-1:0},ans:{value:this.isRtc?-1:0},agc:{value:this.isRtc?-1:0},dtx:{value:this.isRtc?-1:0},aec:{value:this.isRtc?-1:0},awc:{value:this.isRtc?-1:0}})},p.updateApi=function(e,t){this.apis[e]&&(this.apis[e].value=1,void 0!==t&&(this.apis[e].ext=t),/(p2p|meeting)/.test(e)&&(this.calling=!0))},p.sendApi=function(){var e=this;this.calling&&(this.calling=!1,this.apis.time=Date.now(),console.log("----- send apiData ------",this.apis),(0,a["default"])({type:"post",url:u,data:this.apis}).then(function(t){e.resetStatus()})["catch"](function(t){console.log("err",t),e.resetStatus()}))},e.exports=h},147:function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var r=n(33),a=i(r),s=n(9),c=n(3),u=c.info.nrtcVersion,l="https://statistic.live.126.net/statistic/realtime/sdkinfo",d=void 0,h=void 0,p=function v(e){o(this,v),this.infos={},this.userlist=[],this.localVolumn=0,this.local={},this.remote={},this.init(e),this.resetStatus()};p.install=function(e){d=d||e.Promise,h=e.util};var f=p.prototype;f.init=function(e){h.merge(this.infos,{ver:1,device:-1,isp:-1,platform:m.convertPlatform(s.os.family)+"-"+s.os.version,browser:s.name+"-"+s.version,sdk_ver:u||"v4.2.0",appkey:e,interval:60,samples:30,time:null,qos_algorithm:-1,fec_algorithm:-1,qos_scene:-1,qos_strategy:-1})},f.resetStatus=function(){h.merge(this.infos,{uid:null,cid:null,push_url:null,turn_ip:null,proxy_ip:null,meeting:!1,live:!1}),this.clearInfoData(),this.uidSsrcMap={},this.userlist=[]},f.initInfoData=function(e){var t={uid:e,cid:this.imInfo&&this.imInfo.channelId||-1,push_url:this.sessionConfig&&this.sessionConfig.rtmpUrl||-1,turn_ip:this.imInfo&&this.imInfo.turnMap||-1,proxy_ip:this.imInfo&&this.imInfo.turnMap||-1,meeting:/^meeting$/gi.test(this.imInfo.sessionMode),live:this.sessionConfig&&this.sessionConfig.liveEnable||!1,p2p:!1,isp:-1,net:-1,connect_state:this.imInfo&&this.imInfo.code||200,signalling_time:(this.sessionConfig&&this.sessionConfig.signalEndTime||0)-(this.sessionConfig&&this.sessionConfig.signalStartTime||0),connect_time:(this.sessionConfig&&this.sessionConfig.rtcEndTime||0)-(this.sessionConfig&&this.sessionConfig.rtcStartTime||0)};h.merge(this.infos,t)},f.clearInfoData=function(){this.localVolumn=0,h.merge(this.infos,{rx:{audio:[],video:[]},tx:{a_lost:[],v_lost:[],rtt:[],rtt_mdev:[],set_v_fps:[],qos_v_fps:[],v_fps:[],set_v_quality:[],real_v_res:[],real_v_kbps:[],real_v_kbps_n:[],real_a_kbps:[],real_a_kbps_n:[],set_v_kbps:[],qos_v_kbps:[],tx_bw_kbps:[],a_volume:[]}})},f.startInfo=function(e){var t=this,n=e.imInfo,i=e.remoteUidMsidMap,o=e.sessionConfig,r=e.rtcConnection,a=e.uid;n&&i&&r&&(this.imInfo=n||{},this.remoteUidMsidMap=i||{},this.sessionConfig=o||{},this.rtcConnection=r,this.videoConfig=e.videoConfig||{},this.sdkInfoTimer||(this.getTurnMap(),this.initInfoData(a),this.format(),this.sdkInfoTimer=setInterval(function(){t.sendInfo()},1e3*this.infos.interval)))},f.stopInfo=function(){this.sdkInfoTimer&&this.resetStatus()},f.updateInfo=function(e){this.rtcStats=e,this.format(),this.updateRxMediaInfo(),this.updateTxMediaInfo()},f.updateInfoOnce=function(e){var t=e.imInfo,n=e.remoteUidMsidMap,i=e.sessionConfig,o=e.rtcConnection;t&&(this.imInfo=t||{},this.remoteUidMsidMap=n||{},this.sessionConfig=i||{},this.rtcConnection=o||{},this.videoConfig=e.videoConfig||{},this.getTurnMap(),this.initInfoData(),this.sendInfo())},f.updateLocalVolumn=function(e){this.localVolumn=e},f.updateRxMediaInfo=function(){var e=this,t={u:[],g:[],c:[],bn:[],bc:[]},n={u:[],i:[],bn:[],bc:[],r:[],f:[]};this.userlist.map(function(i){var o=e.getMediaStats(i);t.u.push(o.audio.u),t.g.push(-1),t.c.push(-1),t.bn.push(o.audio.bn),t.bc.push(o.audio.bc),n.u.push(o.video.u),n.i.push(o.video.i),n.bn.push(o.video.bn),n.bc.push(o.video.bc),n.r.push(o.video.r),n.f.push(o.video.f)}),this.infos.rx.audio.push(t),this.infos.rx.video.push(n)},f.getMediaStats=function(e){var t=this.rtcStats,n={audio:{u:+e,g:-1,c:-1,bn:0,bc:0},video:{u:+e,i:-1,bn:0,bc:0,r:-1,f:0}},i={},o=this.uidSsrcMap[e];if(!o)return n;o=o.join("|");var r=new RegExp("("+o+")");return t.results.filter(function(e){return r.test(e.ssrc)&&(i[e.mediaType]=e),r.test(e)}),i.audio&&(n.audio.bn=(i.audio.availableBandwidth||0)-0,n.audio.bc=-1),i.video&&(n.video.bn=(i.video.availableBandwidth||0)-0,n.video.bc=i.video.googFrameWidthReceived+"x"+i.video.googFrameHeightReceived,n.video.f=(i.video.googFrameRateDecoded||0)-0),n},f.getLocalMediaStats=function(){var e=this.rtcStats,t={a_lost:-1,v_lost:-1,rtt:0,rtt_mdev:-1,set_v_fps:this.videoConfig.frameRate||0,qos_v_fps:0,v_fps:0,set_v_quality:this.sessionConfig.videoQuality,real_v_res:0,real_v_kbps:0,real_v_kbps_n:0,real_a_kbps:-1,real_a_kbps_n:0,set_v_kbps:-1,qos_v_kbps:0,tx_bw_kbps:0,a_volume:0},n={},i=this.imInfo.uid,o=this.uidSsrcMap[i];if(!o)return t;o=o.join("|");var r=new RegExp("("+o+")");return e.results.filter(function(e){return e.localCandidateId?void(n.rtt=e):(r.test(e.ssrc)&&(n[e.mediaType]=e),r.test(e))}),n.audio&&(t.real_a_kbps_n=(n.audio.availableBandwidth||e.audio.send.availableBandwidth)-0,t.a_volume=this.localVolumn-0),n.video&&(t.qos_v_fps=n.video.googFrameRateInput-0,t.v_fps=n.video.googFrameRateSent-0,t.real_v_res=n.video.googFrameWidthSent+"x"+n.video.googFrameHeightSent,t.real_v_kbps=n.video.googEncodeUsagePercent-0,t.real_v_kbps_n=n.video.availableBandwidth-0),t.rtt=n.rtt.googRtt-0,t.tx_bw_kbps=(e.connectionType.bitsSentPerSecond||0)-0,t},f.updateTxMediaInfo=function(){var e=this.getLocalMediaStats(),t=this.infos.tx;for(var n in e)t[n].push(e[n]);this.infos.net=m.convertNetwork(this.rtcStats.connectionType.local.networkType[0])},f.getTurnMap=function(){var e=this.imInfo;e.serverMap&&(e.turnMap=JSON.parse(e.serverMap||null),e.turnMap=e.turnMap&&e.turnMap.turnaddrs,e.turnMap=e.turnMap&&e.turnMap[0],e.turnMap=e.turnMap.constructor===Array?e.turnMap[0]:e.turnMap,e.turnMap=e.turnMap&&e.turnMap.match(/\d+\.\d+.\d+\.\d+/),e.turnMap=e.turnMap[0])},f.getSsrc=function(e,t){var n=[],i={audio:this.getTypeSsrc("audio",e,t),video:this.getTypeSsrc("video",e,t)};return i.audio&&n.push(i.audio),i.video&&n.push(i.video),n},f.getTypeSsrc=function(e,t,n){var i=void 0,o="";if(i=new RegExp(e+"[.\\r\\n\\s\\S]*ssrc:(\\d+)\\smsid:"+t),o=n.match(i),o=o&&o[0])return i=new RegExp("ssrc:\\d+\\smsid:"+t),o=o.match(i),o=o.map(function(e){return i=new RegExp("ssrc:(\\d+)\\s"),e=e.match(i),e[1]})},f.format=function(){this.formatLocal(),this.formatRemote()},f.formatLocal=function(){this.localSdp=this.rtcConnection.localDescription,this.localStream=this.rtcConnection.getLocalStreams()[0],this.localStream&&(this.uidSsrcMap[this.imInfo.uid]=this.getSsrc(this.localStream.id,this.localSdp.sdp),this.local.ssrc=this.uidSsrcMap[this.imInfo.uid])},f.formatRemote=function(){this.remoteSdp=this.rtcConnection.remoteDescription,this.userlist=[];var e=this.remoteUidMsidMap;for(var t in e)this.userlist.push(t),this.remote[t]={},this.uidSsrcMap[t]=this.getSsrc(e[t],this.remoteSdp.sdp),this.remote[t].ssrc=this.uidSsrcMap[t]},f.sendInfo=function(){var e=this;this.infos.uid&&this.infos.cid&&(this.infos.time=Date.now(),this.infos.samples=this.infos.rx.audio.length,(0,a["default"])({type:"post",url:l,data:this.infos}).then(function(t){e.clearInfoData()})["catch"](function(t){e.clearInfoData()}))};var m={convertNetwork:function(e){var t={wlan:"wifi",lan:"ethernet"};return t[e]||"unknown"},convertPlatform:function(e){var t=/Windows/i,n=/OS X/i,i=void 0;return i=t.test(e)&&"Win"||e,i=n.test(i)&&"Mac"||i}};e.exports=p},161:function(e,t){"use strict";var n={};n.install=function(e){var t=e.Protocol.fn;t.processNetcall=function(e){switch(e.cmd){case"initNetcall":this.onInitNetcall(e);break;case"beCalled":this.onBeCalled(e);break;case"keepCalling":this.onKeepCalling(e);break;case"calleeAck":break;case"notifyCalleeAck":this.onNotifyCalleeAck(e);break;case"hangup":break;case"notifyHangup":this.onNotifyHangup(e);break;case"notifyNetcallControl":this.onNetcallControl(e);break;case"notifyCalleeAckSync":this.onNotifyCalleeAckSync(e);break;case"notifyNetcallRecord":this.onMsg(e);break;case"createChannel":break;case"joinChannel":this.joinChannel(e);break;case"notifyJoin":this.notifyJoin(e)}},t.onInitNetcall=function(e){if(!e.error){var t=e.obj.type;e.obj=e.content,e.obj.type=t,e.obj.accounts=e.obj.keepCallingAccounts,this.setCurrentNetcall(e.obj.channelId),this.keepCalling(e)}},t.setCurrentNetcall=function(e){this.currentNetcallChannelId=e},t.onKeepCalling=function(e){e.error||e.content.accounts.length&&this.keepCalling(e)},t.keepCalling=function(e){var t=this,n=e.obj,i=n.type,o=n.accounts,r=n.channelId;o&&o.length&&setTimeout(function(){t.currentNetcallChannelId&&t.currentNetcallChannelId===r&&t.api.keepCalling({type:i,accounts:o,channelId:r})["catch"](function(){})},3e3)},t.onBeCalled=function(e){e.error||this.emitAPI({type:"beCalled",obj:e.content})},t.onNotifyCalleeAck=function(e){e.error||this.emitAPI({type:"notifyCalleeAck",obj:e.content})},t.onNotifyHangup=function(e){e.error||this.emitAPI({type:"notifyHangup",obj:e.content})},t.onNetcallControl=function(e){e.error||this.emitAPI({type:"netcallControl",obj:e.content})},t.onNotifyCalleeAckSync=function(e){e.error||this.emitAPI({type:"notifyCalleeAckSync",obj:e.content})},t.notifyJoin=function(e){e.error||this.emitAPI({type:"notifyJoin",obj:e.content})},t.joinChannel=function(e){e.obj=e.content}},e.exports=n},170:function(e,t){"use strict";var n=9,i={netcall:{id:n,initNetcall:1,keepCalling:3,calleeAck:4,notifyCalleeAck:5,hangup:6,notifyHangup:7,netcallControl:8,notifyNetcallControl:9,verifyChannelId:10,createChannel:13,joinChannel:14,queryAccountUidMap:16}},o={initNetcall:{sid:n,cid:i.netcall.initNetcall,params:[{type:"byte",name:"type"},{type:"StrArray",name:"accounts"},{type:"String",name:"pushContent"},{type:"String",name:"custom"},{type:"Property",name:"pushConfig"}]},keepCalling:{sid:n,cid:i.netcall.keepCalling,params:[{type:"byte",name:"type"},{type:"StrArray",name:"accounts"},{type:"long",name:"channelId"}]},calleeAck:{sid:n,cid:i.netcall.calleeAck,params:[{type:"string",name:"account"},{type:"long",name:"channelId"},{type:"byte",name:"type"},{type:"bool",name:"accepted"}]},hangup:{sid:n,cid:i.netcall.hangup,params:[{type:"long",name:"channelId"}]},netcallControl:{sid:n,cid:i.netcall.netcallControl,params:[{type:"long",name:"channelId"},{type:"byte",name:"type"}]},verifyChannelId:{sid:n,cid:i.netcall.verifyChannelId,params:[{type:"long",name:"channelId"},{type:"String",name:"account"}]},createChannel:{sid:n,cid:i.netcall.createChannel,params:[{type:"String",name:"channelName"},{type:"String",name:"custom"},{type:"String",name:"webrtcEnable"}]},joinChannel:{sid:n,cid:i.netcall.joinChannel,params:[{type:"String",name:"channelName"},{type:"Property",name:"liveOption"}]},queryAccountUidMap:{sid:n,cid:i.netcall.queryAccountUidMap,params:[{type:"String",name:"channelName"},{type:"LongArray",name:"uids"}]}},r="netcall",a={"9_1":{service:r,cmd:"initNetcall",response:[{type:"Number",name:"timetag"},{type:"Number",name:"uid"},{type:"Number",name:"channelId"},{type:"StrArray",name:"turnServerList"},{type:"StrArray",name:"sturnServerList"},{type:"StrArray",name:"proxyServerList"},{type:"StrArray",name:"keepCallingAccounts"},{type:"StrLongMap",name:"accountUidMap"},{type:"String",name:"clientConfig"},{type:"String",name:"serverMap"}]},"9_2":{service:r,cmd:"beCalled",response:[{type:"Number",name:"timetag"},{type:"Number",name:"type"},{type:"Number",name:"channelId"},{type:"String",name:"account"},{type:"Number",name:"uid"},{type:"StrArray",name:"turnServerList"},{type:"StrArray",name:"sturnServerList"},{type:"StrArray",name:"proxyServerList"},{type:"StrLongMap",name:"accountUidMap"},{type:"String",name:"clientConfig"},{type:"String",name:"custom"},{type:"Property",name:"pushConfig"},{type:"String",name:"serverMap"}]},"9_3":{service:r,cmd:"keepCalling",response:[{type:"StrArr",name:"accounts"}]},"9_4":{service:r,cmd:"calleeAck",response:[]},"9_5":{service:r,cmd:"notifyCalleeAck",response:[{type:"String",name:"account"},{type:"long",name:"channelId"},{type:"byte",name:"type"},{type:"bool",name:"accepted"}]},"9_6":{service:r,cmd:"hangup",response:[]},"9_7":{service:r,cmd:"notifyHangup",response:[{type:"long",name:"channelId"},{type:"String",name:"account"},{type:"long",name:"timetag"}]},"9_8":{service:r,cmd:"netcallControl",response:[]},"9_9":{service:r,cmd:"notifyNetcallControl",response:[{type:"String",name:"account"},{type:"byte",name:"type"},{type:"long",name:"channelId"}]},"9_10":{service:r,cmd:"verifyChannelId",response:[]},"9_11":{service:r,cmd:"notifyNetcallRecord",response:[{type:"Property",name:"msg"}]},"9_12":{service:r,cmd:"notifyCalleeAckSync",response:[{type:"String",name:"timetag"},{type:"long",name:"channelId"},{type:"byte",name:"type"},{type:"bool",name:"accepted"},{type:"byte",name:"fromClientType"}]},"9_13":{service:r,cmd:"createChannel",response:[{type:"long",name:"timetag"}]},"9_14":{service:r,cmd:"joinChannel",response:[{type:"long",name:"timetag"},{type:"long",name:"channelId"},{type:"StrLongMap",name:"accountUidMap"},{type:"String",name:"serverMap"},{type:"String",name:"clientConfig"},{type:"String",name:"custom"}]},"9_15":{service:r,cmd:"notifyJoin",response:[{type:"Long",name:"channelId"},{type:"StrLongMap",name:"accountUidMap"}]},"9_16":{service:r,cmd:"queryAccountUidMap",response:[]}};e.exports={idMap:i,cmdConfig:o,packetConfig:a}},171:function(e,t){"use strict";e.exports={pushConfig:{enable:1,needBadge:2,needPushNick:3,pushContent:4,custom:5,pushPayload:6,sound:7,webrtcEnable:10},liveOption:{liveEnable:1,webrtcEnable:2}}},173:function(e,t){"use strict";e.exports={pushConfig:{1:"enable",2:"needBadge",3:"needPushNick",4:"pushContent",5:"custom",6:"pushPayload",7:"sound",10:"webrtcEnable"},liveOption:{1:"liveEnable",2:"webrtcEnable"}}},177:function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},s=void 0,c=void 0,u=n(67),l=n(8),d=n(201),h=n(3),p=n(202),f=n(203),m=n(178),v=n(87),g=n(86),_=h.agentVersion,y=function(e){function t(n){i(this,t);var r=o(this,e.call(this));return n.container=u.n2node(n.container),n.remoteContainer=u.n2node(n.remoteContainer),r.setUtil(s),s.undef(n.heartbeat)&&(n.heartbeat=!0),s.merge(r,n),r.init(),r}return r(t,e),t}(l);y.install=function(e){s=e.util,c=e.Promise,p.install(e),f.install(e),m.install(e),g.install(e)};var b=y.prototype;b.init=function(){this.signal=null,this.signalInited=!1,this.localStreamInfo=null,this.resetStatus(),this.initProtocol(),g.init(this.nim.options.appKey,"PC-Agent"),this.sdkData=g},b.resetStatus=function(){this.channelId=null,this.channelName=null,this.type=null,this.target=null,this.sessionMode=null,this.sessionConfig=null,this.isCaller=!1,this.callee=null,this.remoteStreamInfo={},this.calling=!1,this.callAccepted=!1,this.callerInfo=null,this.nim.protocol.setCurrentNetcall(),this.needQueryAccountMap={}},b.initProtocol=function(){var e=this.nim;this.account=this.nim.account,e.on("beCalled",this.onBeCalled.bind(this)),e.on("notifyCalleeAck",this.onCalleeAck.bind(this)),e.on("notifyHangup",this.onHangup.bind(this)),e.on("notifyUploadLog",this.uploadLog.bind(this)),e.on("netcallControl",this.onNetcallControl.bind(this)),e.on("notifyCalleeAckSync",this.onCalleeAckSync.bind(this)),e.on("notifyJoin",this.onNotifyJoin.bind(this))},b.getAccount=function(){return this.nim.account},b.getUid=function(){return this.accountUidMap?this.accountUidMap[this.nim.account]||"-1":"-1"},b.isCurrentChannelId=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.channelId&&this.channelId===e.channelId},b.notCurrentChannelId=function(e){return!this.isCurrentChannelId(e)},b.rejectWithNoSignal=function(){return this.resetWhenHangup(),c.reject({code:"noConnection"})},b.initSignal=function(){var e=this;this.signal&&this.stopSignal();var t=new c(function(e,t){setTimeout(e,500)});return t.then(function(){return e._initSignal()})},b._initSignal=function(){var e=this;return new c(function(t,n){var i=e.signal=new p({url:d.signalUrl,client:e,kickLast:e.kickLast,account:e.getAccount(),heartbeat:e.heartbeat,appkey:e.nim.options.appKey});i.on("init",function(i){return e.log(i),e.checkAgentVersion(i.version)?(e.localStreamInfo=i,e.signalInited=!0,void t()):(e.log("插件版本有更新，请下载最新的插件再使用音视频功能"),e.stopSignal(),i.error="请安装最新版插件，方可使用视频功能",i.errorType="agent_update",void n(i))}),i.on("initError",function(t){e.log(t),t=t||{},417===t.code&&(t.error="设备被别的程序占用中, 请检查重试",t.errorType="device_busy"),"noPC"===t.code&&(t.error="请安装插件PC Agent，方可使用音视频功能",t.errorType="agent_empty"),n(t),e.rejectWithNoSignal()}),i.on("close",function(){e.emit("signalClosed"),e.stopSignal()}),i.on("devices",function(t){e.emit("devices",t)}),i.on("login",function(t){e.emit("sessionStarted",t)}),i.on("deviceStatus",function(t){e.emit("deviceStatus",t)}),i.on("userJoined",e.onUserJoin.bind(e)),i.on("userLeft",e.onUserLeft.bind(e)),i.on("logUploaded",e.onLogUploaded.bind(e)),i.on("netStatus",function(t){var n=t.id,i=t.status;e.emit("netStatus",{account:e.getAccountWithUid(n),status:i})}),i.on("statistics",function(t){e.emit("statistics",t)}),i.on("audioVolume",function(t){var n=t.self,i=t.receiver,o={self:n};i&&i.forEach(function(t){var n=t.id,i=t.status;o[e.getAccountWithUid(n)]={status:i}}),e.emit("audioVolume",o)}),i.on("error",e.onError.bind(e)),i.on("recordMp4",e.onRecordMp4.bind(e)),i.on("heartBeatError",e.onError.bind(e))})},b.checkAgentVersion=function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"0.0.0.0",t=e.split("."),n=_.split("."),i=0;i<t.length;i++)if(+t[i]<+n[i])return!1;return!0},b.stopSignal=function(){this.signal&&(this.signal.stopSession(),this.signal.destroy(),this.signal=null,this.signalInited=!1,this.stopLocalStream(),this.stopRemoteStream())},b.initNetcall=function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.type,i=t.pushConfig;return this.type=n,this.sessionMode="p2p",this.nim.initNetcall({type:n,accounts:[this.callee],webrtcEnable:t.webrtcEnable||!1,pushConfig:i}).then(function(t){return e.callerInfo=t,e.channelId=t.channelId,c.resolve(t)},function(t){throw e.resetWhenHangup(),t})},b.initSession=function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(this.signalInited){var n=this.isCaller?this.callerInfo:t.beCalledInfo;this.parseAccountUidMap(n.accountUidMap);var i=this.sessionConfig||{};return this.signal.startSession(a({},n,i)).then(function(){return{channelId:e.channelId}})}return this.rejectWithNoSignal()},b.call=function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.sdkData.dataApi.updateApi("p2p"),new c(function(n,i){if(!e.signalInited||e.calling)return e.resetStatus(),i({type:"statusNotMatch",error:"呼叫失败: 当前正在通话中或者Agent唤起失败，请排查"});var o=t.account,r=t.type,a=t.pushConfig,s=t.sessionConfig,c=void 0===s?{}:s,u=t.webrtcEnable;if(e.calling=!0,e.isCaller=!0,e.callee=e.target=o,e.sessionConfig=c,c.highAudio&&e.sdkData.dataApi.updateApi("hd_audio"),void 0!==c.videoFrameRate&&e.sdkData.dataApi.updateApi("fps",0===+c.videoFrameRate?0:+c.videoFrameRate+1),void 0!==c.videoEncodeMode&&e.sdkData.dataApi.updateApi("video_adaptive_strategy",c.videoEncodeMode||0),void 0!==c.videoBitrate&&e.sdkData.dataApi.updateApi("video_max_encode_bitrate",c.videoBitrate||""),void 0!==c.videoQuality){var l=c.videoQuality;l===v.CHAT_VIDEO_QUALITY_540P?l=v.CHAT_VIDEO_QUALITY_720P:l===v.CHAT_VIDEO_QUALITY_720P&&(l=v.CHAT_VIDEO_QUALITY_540P),e.sdkData.dataApi.updateApi("video_quality",l||0)}return o?e.initNetcall({type:r,pushConfig:a,webrtcEnable:u}).then(function(e){n(e)})["catch"](function(e){i(e)}):(e.resetStatus(),void i({code:"noCalleeAccount"}))})},b.onBeCalled=function(e){this.log("beCalling",e),this.emit("beCalling",e)},b.response=function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.sdkData.dataApi.updateApi("p2p");var n=t.beCalledInfo;if(!n)return c.resolve();var i=n.accepted=t.accepted!==!1,o=this.sessionConfig=t.sessionConfig||{};if(o.highAudio&&this.sdkData.dataApi.updateApi("hd_audio"),void 0!==o.videoFrameRate&&this.sdkData.dataApi.updateApi("fps",0===+o.videoFrameRate?0:+o.videoFrameRate+1),void 0!==o.videoEncodeMode&&this.sdkData.dataApi.updateApi("video_adaptive_strategy",o.videoEncodeMode||0),void 0!==o.videoBitrate&&this.sdkData.dataApi.updateApi("video_max_encode_bitrate",o.videoBitrate||""),void 0!==o.videoQuality){var r=o.videoQuality;r===v.CHAT_VIDEO_QUALITY_540P?r=v.CHAT_VIDEO_QUALITY_720P:r===v.CHAT_VIDEO_QUALITY_720P&&(r=v.CHAT_VIDEO_QUALITY_540P),this.sdkData.dataApi.updateApi("video_quality",r||0)}return i?(this.type=n.type,this.channelId=n.channelId,this.target=n.account,this.calling=!0):(this.log("rejectNetcall",n),this.packNetcallRecord({type:n.type,channelId:n.channelId,isCaller:!1,target:n.account,recordType:"rejectNetcall"})),this.sessionMode="p2p",this.nim.calleeAck(n).then(function(){if(i)return e.initSession({beCalledInfo:n})},function(t){throw e.log(t),t})},b.onCalleeAck=function(e){if(!this.notCurrentChannelId(e))return e.accepted?this.initSession({type:e.type}):(this.log("netcallRejected",e),this.packNetcallRecord({type:e.type,channelId:e.channelId,isCaller:!0,target:e.account,recordType:"netcallRejected"}),this.resetWhenHangup(),this.emit("callRejected",e),void 0)},b.onUserJoin=function(e){this.log("onUserJoin ",e);var t=e.account,n=e.uid;return!t&&n&&(e.account=t=this.getAccountWithUid(n)),t?void this.emitUserJoin(e):(this.needQueryAccountMap[n]=e,void this.nim.queryAccountUidMap(this.channelName,[n]))},b.emitUserJoin=function(e){var t=e.uid,n=e.isMeeting;this.remoteStreamInfo[t]=e,g.dataApi.startInfo({uid:this.getUid()}),n?this.emit("joinChannel",{type:e.type,uid:e.uid,account:e.account}):(this.callAccepted||(this.callAccepted=!0),this.emit("callAccepted",{type:e.type,account:e.account,uid:e.uid}))},b.onUserLeft=function(e){var t=this,n=e.account,i=e.uid,o=e.isMeeting;this.channelId&&(console.log("leave channel from signal"),!n&&i&&(e.account=this.getAccountWithUid(i)),o?this.emit("leaveChannel",e):setTimeout(function(){console.log("超时处理 onUserLeft"),e.account=t.getAccountWithUid(e.uid),t.onHangup(e)},1e3))},b.onNetcallControl=function(e){this.emit("control",e)},b.onCalleeAckSync=function(e){this.emit("callerAckSync",e),this.isCurrentChannelId(e)&&this.resetWhenHangup()},b.onNotifyJoin=function(e){var t=e.accountUidMap,n=this.needQueryAccountMap;this.parseAccountUidMap(t);for(var i in t){var o=i,r=t[i];if(r in n){var a=n[r];a.account=o,this.emitUserJoin(a),delete n[r]}}},b.onHangup=function(e){this.channelId&&(this.sdkData.dataApi.sendApi(),e.type=0,this.emit("hangup",e),this.isCurrentChannelId(e)&&this.resetWhenHangup())},b.hangup=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.channelId;!t&&this.calling&&this.channelId&&(t=this.channelId),t&&(this.sdkData.dataApi.sendApi(),this.nim.hangup({channelId:t})),t===this.channelId&&(this.isCaller&&!this.callAccepted&&(this.log("cancelNetcallBeforeAccept",{channelId:t}),this.packNetcallRecord({recordType:"cancelNetcallBeforeAccept"})),this.resetWhenHangup())},b.packNetcallRecord=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.recordType,n=s.exist(e.type)?e.type:this.type,i=s.exist(e.channelId)?e.channelId:this.channelId,o=s.exist(e.duration)?e.duration:0,r=s.exist(e.isCaller)?e.isCaller:this.isCaller,a=s.exist(e.target)?e.target:this.target,c=this.getAccount(),u=r?c:a,l=r?a:c,d=+new Date;this.nim.protocol.onMsg({content:{msg:{attach:JSON.stringify({data:{calltype:n,channel:i,duration:o,ids:[c,a],time:d},id:t}),from:u,fromClientType:r?16:0,fromDeviceId:"",fromNick:"",idClient:s.guid(),idServer:s.guid(),scene:0,time:d,to:l,type:5}}})},b.resetWhenHangup=function(){this.resetStatus(),this.signalInited&&this.signal.stopSession()},b.control=function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.command,i=t.channelId;if(i||(i=this.channelId),n&&i)return this.sdkData.dataApi.updateApi("call_control_type"),this.nim.netcallControl({channelId:i,type:n})["catch"](function(t){throw e.log(t),t})},b.setVideoViewSize=function(e){return this.signalInited?this.signal.setVideoViewSize(e):this.rejectWithNoSignal()},b.setVideoViewRemoteSize=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.signalInited?(e.account&&(e.id=this.getUidWithAccount(e.account)),this.signal.setVideoViewRemoteSize(e)):this.rejectWithNoSignal()},b.setVideoScale=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.signalInited?(e.account&&(e.id=this.getUidWithAccount(e.account)),this.signal.setVideoScale(e)):this.rejectWithNoSignal()},b.startLocalStream=function(e){var t=this;if(this.sdkData.dataApi.updateApi("display"),this.signalInited&&!this.stream&&this.localStreamInfo){var n=e||this.container,i=this.localStreamInfo.port;this.stream=new f({client:this,url:d.genStreamUrl(i),container:n,mirror:this.mirror}),this.stream.on("resize",function(e){
t.emit("streamResize",e)}),this.stream.on("error",function(e){t.emit("error",e)})}},b.stopLocalStream=function(){this.stream&&(this.stream.destroy(),this.stream=null)},b.startRemoteStream=function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};"p2p"===this.sessionMode?(e=this.getUidWithAccount(this.target),this.remoteContainer||this.target||this.nim.logger.error("不传参数且点对点模式实例化Netcall必须设置remoteContainer与target；传参数必须包含account，node"),!this.getRemoteStream(e)&&this.remoteStreamInfo[e]&&this.addRemoteStream(this.remoteStreamInfo[e])):(e=t.uid||this.getUidWithAccount(t.account),t.node=u.n2node(t.node),e&&t.node?this.addRemoteStream(this.remoteStreamInfo[e],t.node):this.nim.logger.error("不传参数且点对点模式实例化Netcall必须设置remoteContainer与target；传参数必须包含account，node"))},b.stopRemoteStream=function(e){return e?this.removeRemoteStream(e):this.removeRemoteStreams()},b.addRemoteStream=function(e,t){var n=this,i=e.uid,o=e.port;this.remoteStreams||(this.remoteStreams={});var r=this.remoteStreams[i];r&&r.destroy(),r=this.remoteStreams[i]=new f({client:this,isRemote:!0,url:d.genStreamUrl(o),container:t||this.remoteContainer,mirror:this.mirrorRemote}),r.on("resize",function(e){n.emit("remoteStreamResize",e)}),r.on("error",function(e){n.emit("error",e)})},b.removeRemoteStreams=function(){var e=this;this.remoteStreams&&Object.keys(this.remoteStreams).forEach(function(t){e.remoteStreams[t].destroy()}),this.remoteStreams={}},b.removeRemoteStream=function(e){var t=this.getUidWithAccount(e);if(!this.remoteStreams[t]){var n={code:"accountNotMatch"};throw n}this.remoteStreams[t].destroy()},b.getRemoteStream=function(e){var t=this.getUidWithAccount(e);return this.remoteStreams&&this.remoteStreams[t]},b.suspendLocalStream=function(){this.stream&&this.stream.suspend()},b.resumeLocalStream=function(){this.stream&&this.stream.resume()},b.suspendRemoteStream=function(e){var t=this.getRemoteStream(e||this.target);t&&t.suspend()},b.resumeRemoteStream=function(e){var t=this.getRemoteStream(e||this.target);t&&t.resume()},b.switchVideoToAudio=function(){var e=this;return this.signalInited?(this.sdkData.dataApi.updateApi("switch_p2p_type"),this.signal.switchVideoToAudio().then(function(){e.type=v.NETCALL_TYPE_AUDIO})):this.rejectWithNoSignal()},b.switchAudioToVideo=function(){var e=this;return this.signalInited?(this.sdkData.dataApi.updateApi("switch_p2p_type"),this.signal.switchAudioToVideo().then(function(){e.type=v.NETCALL_TYPE_VIDEO})):this.rejectWithNoSignal()},b.getDevicesOfType=function(e){return this.signalInited?this.signal.getDevicesOfType(e):this.rejectWithNoSignal()},b.getStoredDevicesOfType=function(e){return this.signalInited?(e=+e,e===v.DEVICE_TYPE_AUDIO_OUT_LOCAL&&(e=v.DEVICE_TYPE_AUDIO_OUT_CHAT),this.signal.devicesMap[e]):void this.rejectWithNoSignal()},b.hasDevicesOfType=function(e){return this.getStoredDevicesOfType(e)},b.getStartedDeviceOfType=function(e){return this.signalInited?this.signal.deviceMap[e]:this.rejectWithNoSignal()},b.hasStartedDeviceOfType=function(e){return this.getStartedDeviceOfType(e)},b.stopDevice=function(e){return this.signalInited?this.hasStartedDeviceOfType(e)?this.signal.stopDevice(e):c.resolve():this.rejectWithNoSignal()},b.startDevice=function(e){var t=e.type,n=e.device;if(this.signalInited){if(s.exist(t)&&!n){if(this.hasStartedDeviceOfType(t))return c.resolve();this.hasDevicesOfType(t)&&(n=e.device=this.getStoredDevicesOfType(t)[0])}return n?this.signal.startDevice(e):c.reject(a({type:"noDevice"},e))}return this.rejectWithNoSignal()},b.setSessionVideoQuality=function(e){if(this.signalInited){if(void 0!==e){var t=e;t===v.CHAT_VIDEO_QUALITY_540P?t=v.CHAT_VIDEO_QUALITY_720P:t===v.CHAT_VIDEO_QUALITY_720P&&(t=v.CHAT_VIDEO_QUALITY_540P),this.sdkData.dataApi.updateApi("video_quality",t||0)}return this.signal.setVideoQuality(e)}return this.rejectWithNoSignal()},b.setSessionVideoFrameRate=function(e){return this.signalInited?(this.sdkData.dataApi.updateApi("fps",void 0!==e?+e+1:0),this.signal.setVideoFrameRate(e)):this.rejectWithNoSignal()},b.setSessionVideoBitrate=function(e){return this.signalInited?(this.sdkData.dataApi.updateApi("video_max_encode_bitrate",e||""),this.signal.setVideoBitrate(e)):this.rejectWithNoSignal()},b.setCaptureVolume=function(e){return e=void 0===e?255:e,e.constructor===String&&(e=+e||255),this.signalInited?this.signal.setCaptureVolume(e):this.rejectWithNoSignal()},b.setPlayVolume=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};/(Number|String)/.test(e.constructor)&&(e={volume:e});var t=e,n=t.volume;return n=void 0===n?255:n,this.signalInited?this.signal.setPlayVolume(n):this.rejectWithNoSignal()},b.netDetect=function(e){return this.sdkData.dataApi.updateApi("net_detect"),e=void 0===e?v.NETDETECT_AUDIO:e,this.signalInited?this.signal.netDetect(this.nim.options.appKey,e):this.rejectWithNoSignal()},b.uploadLog=function(){var e=this;this.signalInited&&this.nim.getSimpleNosToken().then(function(t){e.signal.uploadLog(t)},function(t){e.log(t)})},b.onLogUploaded=function(e){this.nim.uploadSdkLogUrl(e)},b.log=function(){var e=this.nim.logger;e.log.apply(e,arguments)},b.info=function(){var e=this.nim.logger;e.info.apply(e,arguments)},b.parseAccountUidMap=function(e){var t=this;Object.keys(e).forEach(function(n){t.addAccountUidMap({account:n,uid:e[n]})})},b.addAccountUidMap=function(e){var t=e.account,n=e.uid;this.uidAccountMap||(this.uidAccountMap={}),this.uidAccountMap[n]=t,this.accountUidMap||(this.accountUidMap={}),this.accountUidMap[t]=n},b.getAccountWithUid=function(e){if(this.uidAccountMap)return this.uidAccountMap[e]},b.getUidWithAccount=function(e){if(this.accountUidMap)return this.accountUidMap[e]},b.onError=function(e){this.emit("error",e)},b.setAudioBlack=function(e){var t=this.getUidWithAccount(e);if(t)return this.signal.setAudioBlack(this.getUidWithAccount(e),1);var n={code:"accountNotMatch"};return c.reject(n)},b.setAudioStart=function(e){var t=this.getUidWithAccount(e);if(t)return this.signal.setAudioBlack(this.getUidWithAccount(e),0);var n={code:"accountNotMatch"};return c.reject(n)},b.setVideoBlack=function(e){return this.signal.setVideoBlack(this.getUidWithAccount(e),1)},b.setVideoShow=function(e){return this.signal.setVideoBlack(this.getUidWithAccount(e),0)},b.startRecordMp4=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.sdkData.dataApi.updateApi("record"),s.verifyOptions(e,"path"),e.account&&(e.id=this.getUidWithAccount(e.account)),this.signal.startRecordMp4(e)},b.stopRecordMp4=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.signal.stopRecordMp4(e)},b.startRecordAac=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.sdkData.dataApi.updateApi("audio_record"),s.verifyOptions(e,"path"),this.signal.startRecordAac(e)},b.stopRecordAac=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.signal.stopRecordAac(e)},b.onRecordMp4=function(e,t){e.type=t,this.emit("recordMp4",e)},b.destroy=function(){},b.setNetcallSession=function(e){return this.calling?c.reject({type:"statusNotMatch",error:"开启会话失败: 当前正在通话中"}):(this.calling=!0,this.channelId=e.channelId,this.type=+e.netcallType,this.imInfo=e,this.imInfo.rtcUrls=e.rtcServerMap,this.beCalledInfo=this.imInfo,this.target=e.target.account,this.parseAccountUidMap(e.accountUidMap),this.signal.startSession(a({},this.imInfo,{type:this.type},this.imInfo.sessionConfig),!1))},e.exports=y,n(200)},178:function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a=void 0,s=n(8),c=n(180),u=n(218),l=n(217),d=function(e){function t(n){i(this,t);var r=o(this,e.call(this));return a.merge(r,n),r.init(),r}return r(t,e),t}(s);d.install=function(e){a=e.util};var h=d.prototype;h.init=function(){this.reset()},h.reset=function(){this.width=0,this.height=0},h.initCanvas=function(e){a.merge(this,e);var t=this.container||document.body,n=this.canvas;n||(n=this.canvas=document.createElement("canvas"),t.appendChild(n)),n.width=this.width,n.height=this.height;var i=this.gl;if(i||(i=this.gl=c.getWebGLContext(n)),i)i.viewport(0,0,this.width,this.height),i.clearColor(0,0,0,1),i.clear(i.COLOR_BUFFER_BIT),c.initShaders(i,u,l),this.initBuffer(i),this.initTextures(i);else{var o={code:"notSupportWebGl"};this.emit("error",o)}},h.initBuffer=function(e){this.positionLocation=e.getAttribLocation(e.program,"a_position"),this.texCoordLocation=e.getAttribLocation(e.program,"a_texCoord"),this.texCoordBuffer=e.createBuffer()},h.initTextures=function(e){this.yTexture=this.createTexture(e.TEXTURE0),this.uTexture=this.createTexture(e.TEXTURE1),this.vTexture=this.createTexture(e.TEXTURE2);var t=e.getUniformLocation(e.program,"Ytex");e.uniform1i(t,0);var n=e.getUniformLocation(e.program,"Utex");e.uniform1i(n,1);var i=e.getUniformLocation(e.program,"Vtex");e.uniform1i(i,2)},h.createTexture=function(e){var t=this.gl,n=t.createTexture();return t.activeTexture(e),t.bindTexture(t.TEXTURE_2D,n),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.NEAREST),n},h.destroyTextures=function(){var e=this.gl;e&&(e.deleteTexture(this.yTexture),e.deleteTexture(this.uTexture),e.deleteTexture(this.vTexture)),this.yTexture=null,this.uTexture=null,this.vTexture=null},h.destroyBuffer=function(){var e=this.gl;e&&this.texCoordBuffer&&e.deleteBuffer(this.texCoordBuffer),this.texCoordBuffer=null},h.updateShaders=function(){var e=this.gl,t=void 0;t=this.mirror?new Float32Array([-1,1,1,0,-1,-1,1,1,1,1,0,0,1,-1,0,1]):new Float32Array([-1,1,0,0,-1,-1,0,1,1,1,1,0,1,-1,1,1]),e.bindBuffer(e.ARRAY_BUFFER,this.texCoordBuffer),e.bufferData(e.ARRAY_BUFFER,t,e.STATIC_DRAW);var n=t.BYTES_PER_ELEMENT;e.vertexAttribPointer(this.positionLocation,2,e.FLOAT,!1,4*n,0),e.vertexAttribPointer(this.texCoordLocation,2,e.FLOAT,!1,4*n,2*n),e.enableVertexAttribArray(this.positionLocation),e.enableVertexAttribArray(this.texCoordLocation)},h.updateTextures=function(e){var t=e.y,n=e.u,i=e.v,o=this.gl,r=this.width,a=this.height;this.updateTexture(o.TEXTURE0,this.yTexture,t,r,a),this.updateTexture(o.TEXTURE1,this.uTexture,n,r/2,a/2),this.updateTexture(o.TEXTURE2,this.vTexture,i,r/2,a/2),o.finish()},h.updateTexture=function(e,t,n,i,o){var r=this.gl;r.activeTexture(e),r.bindTexture(r.TEXTURE_2D,t),r.texImage2D(r.TEXTURE_2D,0,r.LUMINANCE,i,o,0,r.LUMINANCE,r.UNSIGNED_BYTE,n)},h.drawImage=function(e){if(!this.destroyed){var t=e.width,n=e.height,i=e.y,o=e.u,r=e.v;t===this.width&&n===this.height||(this.width=t,this.height=n,this.clean(),this.initCanvas({width:t,height:n}),this.emit("resize",{width:t,height:n,isRemote:this.isRemote,container:this.container})),this.updateShaders(),this.updateTextures({y:i,u:o,v:r});var a=this.gl;a.drawArrays(a.TRIANGLE_STRIP,0,4)}},h.destroy=function(){this.destroyed||(this.destroyed=!0,this.clean(),this.reset())},h.clean=function(){this.destroyTextures(),this.destroyBuffer(),this.removeGl()},h.removeGl=function(){this.canvas&&this.canvas.parentNode&&this.canvas.parentNode.removeChild(this.canvas),this.canvas=null,this.canvasInited=!1,this.gl=null},e.exports=d},180:function(e,t){"use strict";var n={},i=n.create3DContext=function(e,t){for(var n=["webgl","experimental-webgl","webkit-3d","moz-webgl"],i=null,o=0;o<n.length;++o){try{i=e.getContext(n[o],t)}catch(e){}if(i){console.log("use",n[o]);break}}return i};n.initShaders=function(e,t,n){var i=o(e,t,n);return i?(e.useProgram(i),e.program=i,!0):(console.log("Failed to create program"),!1)};var o=n.createProgram=function(e,t,n){var i=r(e,e.VERTEX_SHADER,t),o=r(e,e.FRAGMENT_SHADER,n);if(!i||!o)return null;var a=e.createProgram();if(!a)return null;e.attachShader(a,i),e.attachShader(a,o),e.linkProgram(a);var s=e.getProgramParameter(a,e.LINK_STATUS);if(!s){var c=e.getProgramInfoLog(a);return console.log("Failed to link program: "+c),e.deleteProgram(a),e.deleteShader(o),e.deleteShader(i),null}return a},r=n.loadShader=function(e,t,n){var i=e.createShader(t);return null==i?(console.log("unable to create shader"),null):(e.shaderSource(i,n),e.compileShader(i),i)};n.getWebGLContext=function(e,t){var n=i(e);return n?n:null},window.requestAnimationFrame||(window.requestAnimationFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(e){window.setTimeout(e,1e3/60)}}()),window.cancelAnimationFrame||(window.cancelAnimationFrame=window.cancelRequestAnimationFrame||window.webkitCancelAnimationFrame||window.webkitCancelRequestAnimationFrame||window.mozCancelAnimationFrame||window.mozCancelRequestAnimationFrame||window.msCancelAnimationFrame||window.msCancelRequestAnimationFrame||window.oCancelAnimationFrame||window.oCancelRequestAnimationFrame||window.clearTimeout),e.exports=n},200:function(e,t,n){"use strict";var i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},o=n(87),r=n(177),a=r.prototype,s=void 0;a.setUtil=function(e){s=e},a.createChannel=function(e){return s.verifyOptions(e,"channelName"),e.custom=e.custom||"",this.sdkData.dataApi.updateApi("meeting"),e.webrtcEnable||delete e.webrtcEnable,this.nim.createChannel(e)},a.joinChannel=function(e){var t=this;this.sdkData.dataApi.updateApi("meeting"),s.verifyOptions(e,"channelName type");var n=e.type,r=e.sessionConfig,a=void 0===r?{}:r;if(a.bypassRtmp=e.liveEnable,a.customLayout=e.layout||e.customLayout,e.liveEnable&&this.sdkData.dataApi.updateApi("bypass",void 0!==a.splitMode?+a.splitMode+1:0),a.highAudio&&this.sdkData.dataApi.updateApi("hd_audio"),void 0!==a.videoFrameRate&&this.sdkData.dataApi.updateApi("fps",0===+a.videoFrameRate?0:+a.videoFrameRate+1),void 0!==a.videoEncodeMode&&this.sdkData.dataApi.updateApi("video_adaptive_strategy",a.videoEncodeMode||0),void 0!==a.videoBitrate&&this.sdkData.dataApi.updateApi("video_max_encode_bitrate",a.videoBitrate||""),void 0!==a.videoQuality){var c=a.videoQuality;c===o.CHAT_VIDEO_QUALITY_540P?c=o.CHAT_VIDEO_QUALITY_720P:c===o.CHAT_VIDEO_QUALITY_720P&&(c=o.CHAT_VIDEO_QUALITY_540P),this.sdkData.dataApi.updateApi("video_quality",c||0)}if(this.signalInited)return this.nim.joinChannel({channelName:e.channelName,liveEnable:e.liveEnable,webrtcEnable:e.webrtcEnable}).then(function(o){return console.log("joinchannel obj",o),console.log("joinchannel options",e),t.callerInfo=o,t.channelId=o.channelId,t.channelName=e.channelName,t.sessionMode="meeting",t.parseAccountUidMap(o.accountUidMap),o.uid=t.getUidWithAccount(t.account),t.sdkData.dataApi.startInfo({uid:o.uid}),t.signal.startSession(i({},o,{type:n},e.sessionConfig),!0)});var u={code:"noConnection"};return Promise.reject(u)},a.leaveChannel=function(){if(this.signalInited)return this.sdkData.dataApi.sendApi(),this.signal.stopSession();var e={code:"noConnection"};return Promise.reject(e)},a.changeRoleToPlayer=function(){return this.signal.setRole(0)},a.changeRoleToAudience=function(){return this.signal.setRole(1)},a.updateRtmpUrl=function(e){return this.signal.updateRtmpUrl(e)}},201:function(e,t){"use strict";var n="wss://localhost.netease.im:",i={baseUrl:n,signalUrl:n+"30000",streamUrl:n+"40000",genStreamUrl:function(e){return""+n+e}};e.exports=i},202:function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},s=void 0,c=n(8),u=n(87),l=n(204),d=n(219),h=function(e){function t(n){i(this,t);var r=o(this,e.call(this));return s.merge(r,n),r.reset(),window.addEventListener("beforeunload",function(){r.destroy()}),r}return r(t,e),t}(c);h.install=function(e){s=e.util};var p=h.prototype;p.reset=function(){this.inited=!1,this.isMeeting=!1,this.hasInvokePC=!1,this.cmdId=1,this.cmdTasksMap={},this.sessionStopped=!1,this.devicesMap={},this.deviceMap={},this.initSocket()},p.initSocket=function(){var e=this.socket=new WebSocket(this.url);e.onopen=this.onOpen.bind(this),e.onmessage=this.onMessage.bind(this),e.onerror=this.onError.bind(this),e.onclose=this.onClose.bind(this)},p.onOpen=function(e){var t=this,n=this.heartbeat?1:0,i=this.getName()+" open -> signal.js";this.inited=!0,this.logToConsole(i),this.log(i),this.emit("open"),this.sendCmd({type:"on_init",info:{account:this.account,type:this.kickLast?1:0,heartbeat:n,app_key:this.appkey}}).then(this.onInit.bind(this))["catch"](function(e){t.logToConsole("init error -> signal.js",e),t.emit("initError",e)})},p.onError=function(e){if(!this.destroyed&&this.inited){var t=this.getName()+" error -> signal.js";this.logToConsole(t)}},p.onClose=function(e){var t=this;if(!this.destroyed)if(this.inited){var n=this.getName()+" close -> signal.js : "+e.code;this.logToConsole(n),this.inited=!1,this.emit("close")}else{this.hasInvokePC||(this.hasInvokePC=!0,this.invokePC());var i=this.backoff;i||(i=this.backoff=new d({min:1e3,max:2e3})),3===i.attempts?this.emit("initError",{code:"noPC"}):setTimeout(function(){t.initSocket()},i.duration())}},p.invokePC=function(){var e="NIMWebAgent:invokePC",t=document.createElement("iframe");t.src=e,document.body.appendChild(t),setTimeout(function(){t.parentNode&&t.parentNode.removeChild(t)},0)},p.onMessage=function(e){if(!this.destroyed){var t=JSON.parse(e.data),n=t.cmd_id,i=t.cmd_type,o=t.cmd_info;this.shouldPrintMsg({cmdType:i,cmdInfo:o})&&"on_heartbeat_notify"!==i&&this.client.info("signal socket msg",t);var r=this.cmdTasksMap[n];if(r)delete this.cmdTasksMap[n],200===o.code?r.resolve(o):r.reject(o);else switch(i){case"device_status_notify":this.onDeviceStatus(o);break;case"session_notify":this.onSessionNotify(o);break;case"upload_log_notify":this.onUploadLogNotify(o)}}},p.shouldPrintMsg=function(e){var t=e.cmdType,n=e.cmdInfo;return"session_notify"!==t||!n.audio_volume&&!n.net&&!n.static_info},p.sendCmd=function(e){var t=this;return new Promise(function(n,i){var o="on_heartbeat"===e.type?0:t.cmdId++,r=a({cmd_id:o,cmd_type:e.type,cmd_info:e.info||{}},e.extra);t.socket&&t.socket.readyState===WebSocket.OPEN?("on_heartbeat"!==e.type&&t.logToConsole("send signal cmd",r),t.cmdTasksMap[o]={resolve:n,reject:i},t.socket.send(JSON.stringify(r))):i({code:"noConnection"})})},p.onInit=function(e){var t=e.code,n=e.version,i=e.port,o=e.device_list_notify;200===t&&(o.forEach(this.onDevices,this),this.emit("init",{port:i,version:n,code:t}),this.startHeartBeat())},p.startHeartBeat=function(){var e=this;this.heartBeatTimer&&this.stopHeartBeat(),this.heartBeatTimer=setInterval(function(){e.sendCmd({type:"on_heartbeat",info:{}})["catch"](function(){e.emit("heartBeatError",{type:"heartbeatError"})})},15e3)},p.stopHeartBeat=function(){clearInterval(this.heartBeatTimer),this.heartBeatTimer=null},p.setVideoViewSize=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=parseInt(e.width)||0,n=parseInt(e.height)||0,i=void 0===e.cut?1:~~e.cut;return this.sendCmd({type:"on_capture_video_size",info:{width:t,height:n,cut:i}})},p.setVideoViewRemoteSize=function(e){var t=parseInt(e.width)||0,n=parseInt(e.height)||0,i=e.id||0,o=void 0===e.cut?1:~~e.cut;return this.sendCmd({type:"on_rec_video_size",info:{id:i,width:t,height:n,cut:o}})},p.setVideoScale=function(e){var t=e.type,n=void 0===t?u.CHAT_VIDEO_SCALE_None:t,i=e.id;return this.sendCmd({type:"on_send_video_Scale",info:{id:i,type:n}})},p.getDevicesOfType=function(e){var t=this;return this.sendCmd({type:"on_get_devices",info:{type:e}}).then(function(e){return e.devices=e.devices||[],t.onDevices(e),e})["catch"](function(e){throw e})},p.onDevices=function(e){var t=e.type,n=e.devices;if(n&&n.length){l.sortDevices(n);var i=u.getDeviceTypeStr(t);i&&(this.devicesMap[t]=n,this.emit("devices",{type:t,typeStr:i,devices:n}))}},p.startAllDevices=function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.videoQuality,i=t.audioOutType;Object.keys(this.devicesMap).forEach(function(t){t=+t,t===u.DEVICE_TYPE_AUDIO_OUT_CHAT&&i===u.DEVICE_TYPE_AUDIO_OUT_LOCAL&&(t=i);var o=e.devicesMap[t];e.startDevice({device:o[0],type:t,videoQuality:n})})},p.startDevice=function(e){var t=this,n=e.device,i=e.type,o=e.width,r=e.height;if(n){i=+i;var a={type:i,path:n.path};return i===u.DEVICE_TYPE_VIDEO&&(a.width=parseInt(o)||0,a.height=parseInt(r)||0),this.deviceMap[i]=n,this.sendCmd({type:"on_start_device",info:a})["catch"](function(){throw delete t.deviceMap[i],a})}},p.stopDevice=function(e){var t=this,n=this.deviceMap[e];return delete this.deviceMap[e],this.sendCmd({type:"on_stop_device",info:{type:e}})["catch"](function(){t.deviceMap[e]=n})},p.onDeviceStatus=function(e){var t=e.type,n=e.status,i=1===(1&n),o=4===(4&n),r=8===(8&n),s=16===(16&n);r&&(this.deviceMap[t]=e,this.emit("deviceStatus",a({},e,{status:"started"}))),s&&(delete this.deviceMap[t],this.emit("deviceStatus",a({},e,{status:"stopped"}))),o&&(this.deviceMap[t]=e,this.emit("deviceStatus",a({},e,{status:"reset"}))),i&&this.emit("deviceStatus",a({},e,{status:"change"}))},p.startSession=function(e,t){var n=this;this.sessionStopped=!1;var i=s.guid();this.sessionId=i;var o=e.type;this.type=o;var r={id:e.uid,cid:e.channelId,type:o,p2p_connect:1,dispatch:e.serverMap,config:e.clientConfig,v_encode_mode:this.normalizeVideoEncodeMode(e.videoEncodeMode),video_quality:this.normalizeVideoQuality(e.videoQuality),video_record:e.recordVideo?1:0,record:e.recordAudio?1:0,high_rate:e.highAudio?1:0,frame_rate:this.normalizeVideoFrameRate(e.videoFrameRate),max_video_rate:this.normalizeVideoBitrate(e.videoBitrate),custom_layout:e.customLayout};return t&&(r.meeting_mode=1,r.bypass_rtmp=e.bypassRtmp?1:0,r.rtmp_url=e.rtmpUrl||"",r.rtmp_record=e.rtmpRecord?1:0,r.split_mode=e.splitMode||0),this.sendCmd({type:"on_start_chat",info:r,extra:{session_id:i}}).then(function(e){var i=e.login,o=e.error;if(o)throw o;return n.isMeeting=t,{login:i}})},p.stopSession=function(){return this.sessionStopped?Promise.resolve():(this.sessionStopped=!0,this.isMeeting=!1,this.sendCmd({type:"on_stop_chat"}))},p.clear=function(){this.sendCmd({type:"on_clear"})},p.switchVideoToAudio=function(){return this.sendCmd({type:"on_set_chat_mode",info:{type:u.NETCALL_TYPE_AUDIO}})},p.switchAudioToVideo=function(){return this.sendCmd({type:"on_set_chat_mode",info:{type:u.NETCALL_TYPE_VIDEO}})},p.logToConsole=function(){var e=this.client;e&&e.log.apply(e,arguments)},p.log=function(e){e&&this.doLog({msg:e,level:3})},p.warn=function(e){e&&this.doLog({msg:e,level:2})},p.err=function(e){e&&this.doLog({msg:e,level:1})},p.doLog=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.msg,n=e.level;return this.sendCmd({type:"on_log",info:{type:n,content:""+t}})["catch"](function(){})},p.uploadLog=function(e){var t=e.bucket,n=e.objectName,i=e.token;return this.sendCmd({type:"on_upload_log",info:{nos_bucket:t,nos_object:n,nos_header_token:i}})["catch"](function(){})},p.normalizeVideoEncodeMode=function(e){return parseInt(e)||u.CHAT_VIDEO_ENCODEMODE_NORMAL},p.normalizeVideoQuality=function(e){return parseInt(e)||u.CHAT_VIDEO_QUALITY_480P},p.setVideoQuality=function(e){return this.sendCmd({type:"on_set_video_quality",info:{type:this.normalizeVideoQuality(e)}})},p.normalizeVideoFrameRate=function(e){return parseInt(e)||u.CHAT_VIDEO_FRAME_RATE_NORMAL},p.setVideoFrameRate=function(e){return this.sendCmd({type:"on_set_video_frame_rate",info:{type:this.normalizeVideoFrameRate(e)}})},p.normalizeVideoBitrate=function(e){return parseInt(e)||0},p.setVideoBitrate=function(e){return this.sendCmd({type:"on_set_video_bitrate",info:{code:this.normalizeVideoBitrate(e)}})},p.netDetect=function(e,t){return this.sendCmd({type:"on_net_detect",info:{app_key:e,type:t}})},p.normalizeVolumn=function(e){return e=+e,s.isNumber(e)&&!isNaN(e)||(e=255),e<0&&(e=0),e>255&&(e=255),e},p.setCaptureVolume=function(e){return e=this.normalizeVolumn(e),this.sendCmd({type:"on_capture_volume",info:{status:e}})},p.setPlayVolume=function(e){return e=this.normalizeVolumn(e),this.sendCmd({type:"on_play_volume",info:{status:e}})},p.setRole=function(e){return this.sendCmd({type:"on_set_viewer",info:{status:e}})},p.setAudioBlack=function(e,t){return this.sendCmd({type:"on_set_audio_black",info:{id:e,status:t}})},p.setVideoBlack=function(e,t){return this.sendCmd({type:"on_set_video_black",info:{id:e,status:t}})},p.updateRtmpUrl=function(e){return this.sendCmd({type:"on_update_rtmp_url",info:{content:e}})},p.startRecordMp4=function(e){var t=e.path,n=e.id,i=void 0===n?"":n;return this.sendCmd({type:"on_record_mp4",info:{path:t,id:i}})},p.stopRecordMp4=function(e){var t=e.id,n=void 0===t?0:t;return this.sendCmd({type:"on_stop_record_mp4",info:{id:n}})},p.startRecordAac=function(e){var t=e.path;return this.sendCmd({type:"on_record_aac",info:{path:t}})},p.stopRecordAac=function(){return this.sendCmd({type:"on_stop_record_aac",info:{}})},p.onSessionNotify=function(e){e&&(e.user_joined?(console.log("onSessionNotify ",e),this.emit("userJoined",{uid:e.user_joined.id,port:e.user_joined.port,type:this.type,isMeeting:this.isMeeting})):e.user_left?this.emit("userLeft",{uid:e.user_left.id,type:e.user_left.status,isMeeting:this.isMeeting}):e.net?this.emit("netStatus",e.net):e.static_info?this.emit("statistics",e.static_info):e.audio_volume?this.emit("audioVolume",e.audio_volume):e.error?this.emit("error",e.error):e.mp4_start?this.emit("recordMp4",e.mp4_start,"start"):e.mp4_close&&this.emit("recordMp4",e.mp4_close,"close"))},p.onUploadLogNotify=function(e){var t=e.code,n=e.url;200===t&&this.emit("logUploaded",{url:n})},p.getName=function(){return"signal socket "+this.url},p.destroy=function(){this.destroyed=!0,this.stopHeartBeat();var e="signal close -> signal.js";this.logToConsole(e),this.socket&&(this.socket.onopen=null,this.socket.onmessage=null,this.socket.onerror=null,this.socket.onclose=null,this.socket.readyState===WebSocket.OPEN&&(this.clear(),this.socket.close()),this.socket=null)},e.exports=h},203:function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a=void 0,s=n(8),c=n(178),u=n(216),l=function(e){function t(n){i(this,t);var r=o(this,e.call(this));return a.merge(r,n),r.init(),r}return r(t,e),t}(s);l.install=function(e){a=e.util};var d=l.prototype;d.init=function(){this.reset(),this.initRender(),this.initWorker(),window.addEventListener("beforeunload",this.destroy.bind(this))},d.initRender=function(){var e=this;this.render=new c({client:this.client,stream:this,isRemote:this.isRemote,container:this.container,mirror:this.mirror}),this.render.on("resize",function(t){e.emit("resize",t)}),this.render.on("error",function(t){e.emit("error",t)})},d.reset=function(){this.currFrameCount=0,this.width=0,this.height=0,this.timetag=0,this.worker=null,this.render=null},d.initWorker=function(){var e=this,t=new Blob([u],{type:"application/javascript"}),n=this.worker=new Worker(URL.createObjectURL(t));n.addEventListener("message",function(t){var n=t.data;switch(n.cmd){case"open":e.onOpen();break;case"error":e.onError();break;case"close":e.onClose();break;case"message":e.onMessage(n)}}),this.sendWorkerCmd({cmd:"init",info:{url:this.url}})},d.destroyWorker=function(){this.worker&&this.worker.terminate()},d.sendWorkerCmd=function(e){this.worker&&this.worker.postMessage(e)},d.getName=function(){return(this.isRemote?"remote ":"")+"stream socket "+this.url},d.onOpen=function(e){var t=this.getName()+" open -> stream.js";this.logToConsole(t),this.logToPC(t)},d.startStatisticsTimer=function(){var e=this;this.statisticsTimer=setInterval(function(){var t=e.currFrameCount-e.lastFrameCount;e.sendWorkerCmd({cmd:"msg",info:{cmd:"statistics",info:{lastFrameCount:e.lastFrameCount,fps:t,latency:e.latency}}}),e.lastFrameCount=e.currFrameCount,e.latency=0},1e3)},d.onError=function(e){if(!this.destroyed){var t=this.getName()+" error -> stream.js";this.logToConsole(t),this.logToPC(t),this.destroy()}},d.onClose=function(e){this.destroy(e)},d.onMessage=function(e){var t=e.data;if(!this.destroyed&&t instanceof ArrayBuffer){var n=t.byteLength;this.render&&!this.suspended&&this.renderFrame(t,n)}},d.renderFrame=function(e,t){var n=16,i=new DataView(e),o=this.width=i.getUint32(0),r=this.height=i.getUint32(4),a=i.getUint32(8),s=i.getUint32(12);this.timetag=1e3*a+s;var c=o*r,u=c/4,l=c/4;if(n+c+u+l!==t){var d="yuv数据长度不匹配: total "+t+", meta "+n+", width "+o+", height "+r+", yLength "+c+" uLength "+u+" vLength "+l;return this.logToConsole(d),void this.logToPC(d)}this.currFrameCount++,this.scheduleRender({id:this.currFrameCount,width:o,height:r,y:new Uint8Array(e,n,c),u:new Uint8Array(e,n+c,u),v:new Uint8Array(e,n+c+u)})},d.scheduleRender=function(e){this.render&&!this.suspended&&this.render.drawImage(e)},d.suspend=function(){this.suspended=!0},d.resume=function(){this.suspended=!1},d.destroy=function(e){this.sendWorkerCmd({cmd:"close",info:{cmd_type:"on_clear_media"}}),this.destroyed=!0,this.render&&this.render.destroy(),this.reset();var t=e&&e.constructor===Object?e.code:"",n=this.getName()+" destroy: code - "+t+" -> stream.js";this.logToConsole(n),this.logToPC(n)},d.logToConsole=function(){var e=this.client;e&&e.log.apply(e,arguments)},d.logToPC=function(){var e=this.client;if(e){var t=e.signal;t&&t.log.apply(t,arguments)}},e.exports=l},204:function(e,t){"use strict";var n={};n.sortDevices=function(e){e&&e.length>1&&e.sort(function(e,t){var n=e.name.toLowerCase().indexOf("virtual")!==-1,i=e.path.toLowerCase().indexOf("virtual")!==-1,o=t.name.toLowerCase().indexOf("virtual")!==-1,r=t.path.toLowerCase().indexOf("virtual")!==-1;return i?1:r?-1:n&&o?0:n?1:o?-1:0})},e.exports=n},216:function(e,t){e.exports="'use strict';\n\n/* 该web worker 职能为向 websocket 发送指令及数据*/\n\nvar that = {};\n\nthat.init = function (data) {\n  if (!that.socket) {\n    var url = that.url = data.info.url;\n    var socket = that.socket = new WebSocket(url);\n    socket.onopen = function (event) {\n      postMessage({\n        cmd: 'open'\n      });\n    };\n    socket.onmessage = function (event) {\n      postMessage({\n        cmd: 'message',\n        data: event.data\n      });\n    };\n    socket.onerror = function (event) {\n      postMessage({\n        cmd: 'error'\n      });\n    };\n    socket.onclose = function (event) {\n      postMessage({ // web 端被动结束\n        cmd: 'close'\n      });\n    };\n    socket.binaryType = 'arraybuffer';\n  }\n};\n\nthat.close = function () {\n  if (that.socket) {\n    that.socket.onopen = null;\n    that.socket.onmessage = null;\n    that.socket.onerror = null;\n    that.socket.onclose = null;\n    that.socket.close(); // 结束socket\n    that.socket = null;\n  }\n  self.close(); // 结束worker，web端主动\n};\n\nthat.send = function (obj) {\n  if (that.socket && that.socket.readyState === WebSocket.OPEN) {\n    that.socket.send(JSON.stringify(obj));\n  }\n};\n// 侦听主线程的worker消息\nself.addEventListener('message', function (event) {\n  var data = event.data;\n  switch (data.cmd) {\n    case 'init':\n      // worker第一步2\n      that.init(data);\n      break;\n    case 'close':\n      // web发起，结束worker及相应socket\n      that.send(data.info);\n      that.close(data);\n      break;\n    case 'msg':\n      that.send(data.info);\n      break;\n  }\n});";
},217:function(e,t){e.exports="precision mediump float;\r\nuniform sampler2D Ytex, Utex, Vtex;\r\nvarying vec2 v_texCoord;\r\nvoid main(void) {\r\n  float r, g, b, y, u, v;\r\n  vec4 yuv, rgb;\r\n  y = texture2D(Ytex, v_texCoord).r;\r\n  u = texture2D(Utex, v_texCoord).r;\r\n  v = texture2D(Vtex, v_texCoord).r;\r\n  yuv = vec4(y, u, v, 1.0);\r\n  yuv = yuv - vec4(0.0625, 0.5, 0.5, 0.0);\r\n  yuv = mat4(\r\n    1.1643, 0.0, 0.0, 0.0,\r\n    0.0, 1.0, 0.0, 0.0,\r\n    0.0, 0.0, 1.0, 0.0,\r\n    0.0, 0.0, 0.0, 1.0\r\n  ) * yuv;\r\n  rgb = mat4(\r\n    1.0, 1.0, 1.0, 0.0,\r\n    0.0, -0.3917, 2.017, 0.0,\r\n    1.5958, -0.8129, 0.0, 0.0,\r\n    0.0, 0.0, 0.0, 1.0\r\n  ) * yuv;\r\n  gl_FragColor = rgb;\r\n  // y = 1.1643 * (y - 0.0625);\r\n  // u = u - 0.5;\r\n  // v = v - 0.5;\r\n  // r = y + 1.5958 * v;\r\n  // g = y - 0.39173 * u - 0.81290 * v;\r\n  // b = y + 2.017 * u;\r\n  // gl_FragColor = vec4(r, g, b, 1.0);\r\n}\r\n"},218:function(e,t){e.exports="attribute vec4 a_position;\r\nattribute vec2 a_texCoord;\r\nvarying vec2 v_texCoord;\r\nvoid main () {\r\n  gl_Position = a_position;\r\n  v_texCoord = a_texCoord;\r\n}\r\n"},219:function(e,t){function n(e){e=e||{},this.ms=e.min||100,this.max=e.max||1e4,this.factor=e.factor||2,this.jitter=e.jitter>0&&e.jitter<=1?e.jitter:0,this.attempts=0}e.exports=n,n.prototype.duration=function(){var e=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var t=Math.random(),n=Math.floor(t*this.jitter*e);e=0==(1&Math.floor(10*t))?e-n:e+n}return 0|Math.min(e,this.max)},n.prototype.reset=function(){this.attempts=0}}})});