{"version":3,"sources":["webpack:///./src/pages/SearchUser.vue?062e","webpack:///./src/pages/SearchUser.vue","webpack:///./src/pages/SearchUser.vue?c544"],"names":["mounted","$nextTick","searchType","parseInt","$route","params","$store","dispatch","setTimeout","$refs","searchInput","input","focus","data","searchText","searchList","errMsg","firstEntry","watch","searchResult","val","oldVal","length","computed","result","state","searchedTeams","map","item","avatar","config","defaultUserIcon","link","teamId","searchedUsers","nick","account","methods","searchUser","$toast","test","userUID","accounts"],"mappings":"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CA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA,GAAG;AACH;AACA,GAAG;AACH;AACA,GAAG;AACH;AACA;AACA,KAAK;AACL;AACA,GAAG;AACH;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA,GAAG;AACH;AACA;AACA,KAAK;AACL;AACA,GAAG;AACH;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA,OAAO;AACP,KAAK;AACL,GAAG;AACH;AACA,GAAG;AACH,CAAC;AACD;AACA,IAAI,KAAU;AACd;AACA;AACA;AACA;AACA,C","file":"17.js","sourcesContent":["var Component = require(\"!../../node_modules/vue-loader/lib/component-normalizer\")(\n  /* script */\n  require(\"!!babel-loader!../../node_modules/vux-loader/src/script-loader.js!../../node_modules/vue-loader/lib/selector?type=script&index=0!./SearchUser.vue\"),\n  /* template */\n  require(\"!!../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-3df14b96\\\"}!../../node_modules/vux-loader/src/before-template-compiler-loader.js!../../node_modules/vux-loader/src/template-loader.js!../../node_modules/vue-loader/lib/selector?type=template&index=0!./SearchUser.vue\"),\n  /* scopeId */\n  null,\n  /* cssModules */\n  null\n)\nComponent.options.__file = \"D:\\\\Project\\\\javascript\\\\NIM_Web_Demo_H5\\\\src\\\\pages\\\\SearchUser.vue\"\nif (Component.esModule && Object.keys(Component.esModule).some(function (key) {return key !== \"default\" && key !== \"__esModule\"})) {console.error(\"named exports are not supported in *.vue files.\")}\nif (Component.options.functional) {console.error(\"[vue-loader] SearchUser.vue: functional components are not supported with templates, they should use render functions.\")}\n\n/* hot reload */\nif (module.hot) {(function () {\n  var hotAPI = require(\"vue-hot-reload-api\")\n  hotAPI.install(require(\"vue\"), false)\n  if (!hotAPI.compatible) return\n  module.hot.accept()\n  if (!module.hot.data) {\n    hotAPI.createRecord(\"data-v-3df14b96\", Component.options)\n  } else {\n    hotAPI.reload(\"data-v-3df14b96\", Component.options)\n  }\n})()}\n\nmodule.exports = Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/pages/SearchUser.vue\n// module id = 326\n// module chunks = 17","//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\r\nimport config from '../configs'\r\n\r\nexport default {\r\n  mounted () {\r\n    this.$nextTick(() => {\r\n      this.searchType = parseInt(this.$route.params.searchType)\r\n      this.$store.dispatch('resetSearchResult')\r\n    })\r\n\r\n    setTimeout(() => {\r\n      // 立即focus会引起切页时白屏，故增加timeout\r\n      this.$refs.searchInput.$refs.input.focus()\r\n    }, 500);\r\n  },\r\n  data () {\r\n    return {\r\n      searchType: 0, // 用户 0 群 1\r\n      searchText: '',\r\n      searchList: [],\r\n      errMsg: '',\r\n      // 首次加载标志，因为mount和watch会有时序问题，首次加载不显示errMsg\r\n      firstEntry: true,\r\n    }\r\n  },\r\n  watch: {\r\n    searchResult (val, oldVal) {\r\n      if ((val.length === 0) && (!this.firstEntry)) {\r\n        this.errMsg = '无记录'\r\n      } else {\r\n        this.errMsg = ''\r\n      }\r\n      this.searchList = val\r\n    },\r\n    searchType() {\r\n      this.$refs.searchInput.$refs.input.focus()\r\n    }\r\n  },\r\n  computed: {\r\n    searchResult () {\r\n      let result = []\r\n      if (this.searchType === 1) {\r\n        result = this.$store.state.searchedTeams.map(item => {\r\n         item.avatar = item.avatar || config.defaultUserIcon\r\n          item.link = `/teamcard/${item.teamId}`\r\n          return item\r\n        })\r\n      } else if (this.searchType === 0) {\r\n        result = this.$store.state.searchedUsers.map(item => {\r\n          item.nick = item.nick || item.account\r\n          item.link = `/namecard/${item.account}`\r\n          item.avatar = item.avatar || config.defaultUserIcon\r\n          return item\r\n        })\r\n      }\r\n      return result\r\n    }\r\n  },\r\n  methods: {\r\n    searchUser () {\r\n      if (!this.searchText) {\r\n        this.$toast('未输入内容')\r\n        return\r\n      }\r\n      this.firstEntry = false\r\n      if (this.searchType === 1) {\r\n        if(!/^(\\d){4,9}$/.test(this.searchText)){\r\n          this.$toast('输入的群号非法')\r\n          return\r\n        }\r\n        this.$store.dispatch('searchTeam', {\r\n          teamId: this.searchText\r\n        })\r\n      } else if (this.searchType === 0) {\r\n        if (this.searchText === this.$store.state.userUID) {\r\n          this.searchList = []\r\n          this.errMsg = '别看了，就是你自己！'\r\n        } else {\r\n          this.$store.dispatch('searchUsers', {\r\n            accounts: [this.searchText]\r\n          })\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/SearchUser.vue","module.exports={render:function (){var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;\n  return _c('div', {\n    staticClass: \"g-inherit m-article p-search-user\"\n  }, [_c('x-header', {\n    staticClass: \"m-tab\",\n    attrs: {\n      \"left-options\": {\n        backText: ' '\n      }\n    }\n  }, [_c('button-tab', {\n    staticClass: \"m-tab-top\",\n    model: {\n      value: (_vm.searchType),\n      callback: function($$v) {\n        _vm.searchType = $$v\n      },\n      expression: \"searchType\"\n    }\n  }, [_c('button-tab-item', {\n    staticClass: \"u-tab-top\"\n  }, [_vm._v(\"搜索用户\")]), _vm._v(\" \"), _c('button-tab-item', {\n    staticClass: \"u-tab-top\"\n  }, [_vm._v(\"搜索群\")])], 1), _vm._v(\" \"), _c('a', {\n    attrs: {\n      \"slot\": \"left\"\n    },\n    slot: \"left\"\n  })], 1), _vm._v(\" \"), _c('group', {\n    staticClass: \"u-search\"\n  }, [_c('search', {\n    ref: \"searchInput\",\n    staticClass: \"u-ipt-default\",\n    attrs: {\n      \"type\": \"text\",\n      \"required\": false,\n      \"auto-fixed\": false,\n      \"placeholder\": _vm.searchType === 0 ? '请输入搜索内容' : '请输入群号'\n    },\n    model: {\n      value: (_vm.searchText),\n      callback: function($$v) {\n        _vm.searchText = $$v\n      },\n      expression: \"searchText\"\n    }\n  }, [_c('span', {\n    attrs: {\n      \"slot\": \"label\"\n    },\n    slot: \"label\"\n  }, [_vm._v(\"搜索：\")])])], 1), _vm._v(\" \"), _c('div', [_c('x-button', {\n    attrs: {\n      \"type\": \"primary\",\n      \"action-type\": \"button\"\n    },\n    nativeOn: {\n      \"click\": function($event) {\n        return _vm.searchUser($event)\n      }\n    }\n  }, [_vm._v(\"搜索\")])], 1), _vm._v(\" \"), _c('group', {\n    staticClass: \"u-card u-list\"\n  }, _vm._l((_vm.searchList), function(user, index) {\n    return (_vm.searchType === 0) ? _c('cell', {\n      key: user.account,\n      staticClass: \"u-list-item\",\n      attrs: {\n        \"title\": user.nick,\n        \"inline-desc\": user.account,\n        \"userId\": index,\n        \"is-link\": \"\",\n        \"link\": user.link\n      }\n    }, [_c('img', {\n      staticClass: \"icon\",\n      attrs: {\n        \"slot\": \"icon\",\n        \"width\": \"20\",\n        \"src\": user.avatar\n      },\n      slot: \"icon\"\n    })]) : _vm._l((_vm.searchList), function(team) {\n      return _c('cell', {\n        key: team.teamId,\n        staticClass: \"u-list-item\",\n        attrs: {\n          \"title\": team.name,\n          \"is-link\": \"\",\n          \"link\": team.link\n        }\n      }, [_c('img', {\n        staticClass: \"icon\",\n        attrs: {\n          \"slot\": \"icon\",\n          \"width\": \"20\",\n          \"src\": team.avatar\n        },\n        slot: \"icon\"\n      })])\n    })\n  })), _vm._v(\" \"), _c('div', {\n    staticClass: \"u-card\"\n  }, [_c('h3', [_vm._v(_vm._s(_vm.errMsg))])])], 1)\n},staticRenderFns: []}\nmodule.exports.render._withStripped = true\nif (module.hot) {\n  module.hot.accept()\n  if (module.hot.data) {\n     require(\"vue-hot-reload-api\").rerender(\"data-v-3df14b96\", module.exports)\n  }\n}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/vue-loader/lib/template-compiler?{\"id\":\"data-v-3df14b96\"}!./~/vux-loader/src/before-template-compiler-loader.js!./~/vux-loader/src/template-loader.js!./~/vue-loader/lib/selector.js?type=template&index=0!./src/pages/SearchUser.vue\n// module id = 483\n// module chunks = 17"],"sourceRoot":""}